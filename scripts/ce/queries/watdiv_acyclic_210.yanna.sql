\set queryname watdiv_acyclic_210_00
-- Result size: 459462053
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052657 [label="watdiv1052657|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052649:d;watdiv1052649:s -> watdiv1052644:s;watdiv1052644:d -> watdiv1052642:s;watdiv1052642:d -> watdiv1052586:d;watdiv1052586:d -> watdiv1052657:s;}
--                                                                                     +--------------------+
--                                                                                     |                    |
--                                                             +---------------+----+----+---------------+----+---+
--                                                             | watdiv1052586 |  s |  d | watdiv1052657 |  s | d |
--                                                             +---------------+----+----+---------------+----+---+
--                                                                                     |
--                                                                                     |
--                                                                                     |
-- +---------------+----+----+                                 +---------------+----+----+
-- | watdiv1052644 |  s |  d | -----------------+              | watdiv1052642 |  s |  d |
-- +---------------+----+----+                  |              +---------------+----+----+
--                    |                         |                                 |
--                    |                         +---------------------------------+
--                    |
-- +---------------+----+----+---------------+----------------+----------------+
-- | watdiv1052649 |  s |  d | watdiv1052638 |        s       |        d       |
-- +---------------+----+----+---------------+----------------+----------------+
--                         |                                     |
--                         |                                     |
--                         |                                     |
--                         |                  +---------------+----------------+----+
--                         |                  | watdiv1052650 |        s       |  d |
--                         |                  +---------------+----------------+----+
--                         |                                                      |
--                         +------------------------------------------------------+
with dummy as (select) /* stage1 */, watdiv1052649_s1_2df5480661fe70e as (select watdiv1052649.d as v2,watdiv1052649.s as v4 from watdiv1052649), watdiv1052644_s1_2df5480661fe70e as (select watdiv1052644.d as v6,watdiv1052644.s as v4 from watdiv1052644), watdiv1052642_s1_2df5480661fe70e as (select watdiv1052642.d as v8,watdiv1052642.s as v6 from watdiv1052642), watdiv1052657_s2_2df5480661fe70e as (select watdiv1052657.s as v8 from watdiv1052657), watdiv1052586_s2_2df5480661fe70e as (select watdiv1052586.d as v8 from watdiv1052586), watdiv1052650_s1_2df5480661fe70e as (select watdiv1052650.d as v2,watdiv1052650.s as v0 from watdiv1052650), watdiv1052638_s2_2df5480661fe70e as (select watdiv1052638.d as v0 from watdiv1052638) /* stage2 */, watdiv1052650_s2_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052650_s1_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052638_s2_2df5480661fe70e)) where watdiv1052650_s1_2df5480661fe70e.v0 = watdiv1052638_s2_2df5480661fe70e.v0)), watdiv1052642_s2_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052642_s1_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052586_s2_2df5480661fe70e)) where watdiv1052642_s1_2df5480661fe70e.v8 = watdiv1052586_s2_2df5480661fe70e.v8) AND exists (select from umbra.identity(table(watdiv1052657_s2_2df5480661fe70e)) where watdiv1052642_s1_2df5480661fe70e.v8 = watdiv1052657_s2_2df5480661fe70e.v8)), watdiv1052644_s2_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052644_s1_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052642_s2_2df5480661fe70e)) where watdiv1052644_s1_2df5480661fe70e.v6 = watdiv1052642_s2_2df5480661fe70e.v6)), watdiv1052649_s2_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052649_s1_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052650_s2_2df5480661fe70e)) where watdiv1052649_s1_2df5480661fe70e.v2 = watdiv1052650_s2_2df5480661fe70e.v2) AND exists (select from umbra.identity(table(watdiv1052644_s2_2df5480661fe70e)) where watdiv1052649_s1_2df5480661fe70e.v4 = watdiv1052644_s2_2df5480661fe70e.v4)) /* stage3 */, watdiv1052644_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052644_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052649_s2_2df5480661fe70e)) where watdiv1052644_s2_2df5480661fe70e.v4 = watdiv1052649_s2_2df5480661fe70e.v4)), watdiv1052642_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052642_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052644_s2_2df5480661fe70e)) where watdiv1052642_s2_2df5480661fe70e.v6 = watdiv1052644_s2_2df5480661fe70e.v6)), watdiv1052657_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052657_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052642_s2_2df5480661fe70e)) where watdiv1052657_s2_2df5480661fe70e.v8 = watdiv1052642_s2_2df5480661fe70e.v8)), watdiv1052586_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052586_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052642_s2_2df5480661fe70e)) where watdiv1052586_s2_2df5480661fe70e.v8 = watdiv1052642_s2_2df5480661fe70e.v8)), watdiv1052650_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052650_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052649_s2_2df5480661fe70e)) where watdiv1052650_s2_2df5480661fe70e.v2 = watdiv1052649_s2_2df5480661fe70e.v2)), watdiv1052638_s3_2df5480661fe70e as (select * from umbra.identity(table(watdiv1052638_s2_2df5480661fe70e)) where exists (select from umbra.identity(table(watdiv1052650_s2_2df5480661fe70e)) where watdiv1052638_s2_2df5480661fe70e.v0 = watdiv1052650_s2_2df5480661fe70e.v0)) /* stage4 */, s4_group_FE93D92EBE16CDF as  (select * from umbra.identity(table(watdiv1052649_s2_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_2df5480661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052657_s3_2df5480661fe70e)))select count(*) from umbra.identity(table(s4_group_FE93D92EBE16CDF));
\set queryname watdiv_acyclic_210_01
-- Result size: 13081196
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052583 [label="watdiv1052583|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052649:s;watdiv1052649:d -> watdiv1052650:d;watdiv1052650:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052573:d;watdiv1052573:d -> watdiv1052583:s;}
--                                                           +--------------------+
--                                                           |                    |
--                                   +---------------+----+----+---------------+----+---+
--                                   | watdiv1052573 |  s |  d | watdiv1052583 |  s | d |
--                                   +---------------+----+----+---------------+----+---+
--                                                           |
--                                                           |
--                                                           |
--                                   +---------------+----+----+
--                                   | watdiv1052624 |  s |  d |
--                                   +---------------+----+----+
--                                                      |
--                                                      +---------+
--                                                                |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052649 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052650 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052655_s1_b4ea100661fe70e as (select watdiv1052655.s as v4,watdiv1052655.d as v6 from watdiv1052655), watdiv1052650_s1_b4ea100661fe70e as (select watdiv1052650.s as v4,watdiv1052650.d as v2 from watdiv1052650), watdiv1052649_s1_b4ea100661fe70e as (select watdiv1052649.s as v0,watdiv1052649.d as v2 from watdiv1052649), watdiv1052638_s2_b4ea100661fe70e as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_b4ea100661fe70e as (select watdiv1052624.d as v8,watdiv1052624.s as v6 from watdiv1052624), watdiv1052583_s1_b4ea100661fe70e as (select watdiv1052583.s as v8 from watdiv1052583), watdiv1052573_s2_b4ea100661fe70e as (select watdiv1052573.d as v8 from watdiv1052573) /* stage2 */, watdiv1052583_s2_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052583_s1_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052573_s2_b4ea100661fe70e)) where watdiv1052583_s1_b4ea100661fe70e.v8 = watdiv1052573_s2_b4ea100661fe70e.v8)), watdiv1052624_s2_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052624_s1_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052583_s2_b4ea100661fe70e)) where watdiv1052624_s1_b4ea100661fe70e.v8 = watdiv1052583_s2_b4ea100661fe70e.v8)), watdiv1052649_s2_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052649_s1_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052638_s2_b4ea100661fe70e)) where watdiv1052649_s1_b4ea100661fe70e.v0 = watdiv1052638_s2_b4ea100661fe70e.v0)), watdiv1052650_s2_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052650_s1_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052649_s2_b4ea100661fe70e)) where watdiv1052650_s1_b4ea100661fe70e.v2 = watdiv1052649_s2_b4ea100661fe70e.v2)), watdiv1052655_s2_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052655_s1_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052624_s2_b4ea100661fe70e)) where watdiv1052655_s1_b4ea100661fe70e.v6 = watdiv1052624_s2_b4ea100661fe70e.v6) AND exists (select from umbra.identity(table(watdiv1052650_s2_b4ea100661fe70e)) where watdiv1052655_s1_b4ea100661fe70e.v4 = watdiv1052650_s2_b4ea100661fe70e.v4)) /* stage3 */, watdiv1052650_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052650_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052655_s2_b4ea100661fe70e)) where watdiv1052650_s2_b4ea100661fe70e.v4 = watdiv1052655_s2_b4ea100661fe70e.v4)), watdiv1052649_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052649_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052650_s2_b4ea100661fe70e)) where watdiv1052649_s2_b4ea100661fe70e.v2 = watdiv1052650_s2_b4ea100661fe70e.v2)), watdiv1052638_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052638_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052649_s2_b4ea100661fe70e)) where watdiv1052638_s2_b4ea100661fe70e.v0 = watdiv1052649_s2_b4ea100661fe70e.v0)), watdiv1052624_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052624_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052655_s2_b4ea100661fe70e)) where watdiv1052624_s2_b4ea100661fe70e.v6 = watdiv1052655_s2_b4ea100661fe70e.v6)), watdiv1052583_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052583_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052624_s2_b4ea100661fe70e)) where watdiv1052583_s2_b4ea100661fe70e.v8 = watdiv1052624_s2_b4ea100661fe70e.v8)), watdiv1052573_s3_b4ea100661fe70e as (select * from umbra.identity(table(watdiv1052573_s2_b4ea100661fe70e)) where exists (select from umbra.identity(table(watdiv1052583_s2_b4ea100661fe70e)) where watdiv1052573_s2_b4ea100661fe70e.v8 = watdiv1052583_s2_b4ea100661fe70e.v8)) /* stage4 */, s4_group_193AC7F6372B2885 as  (select * from umbra.identity(table(watdiv1052655_s2_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052583_s3_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_b4ea100661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_b4ea100661fe70e)))select count(*) from umbra.identity(table(s4_group_193AC7F6372B2885));
\set queryname watdiv_acyclic_210_02
-- Result size: 676255312
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052628 [label="watdiv1052628|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052647:d;watdiv1052647:s -> watdiv1052651:s;watdiv1052651:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052628:d;watdiv1052628:d -> watdiv1052649:s;}
--                                                             +---------------+----+----+
--                                                             | watdiv1052651 |  s |  d |
--                                                             +---------------+----+----+
--                                                                                |    |
--                                                                                |    +----+
--                                                                                |         |
--                                                             +---------------+----+----+  |
--                                                             | watdiv1052647 |  s |  d |  |
--                                                             +---------------+----+----+  |
--                                                                                     |    |
--                                                                                     |    |
--                                                                                     |    |
-- +---------------+----+---+                                  +---------------+----+----+  |
-- | watdiv1052646 |  s | d | ------------------+              | watdiv1052572 |  s |  d |  |
-- +---------------+----+---+                   |              +---------------+----+----+  |
--                                              |                                 |         |
--                                              +---------------------------------+         |
--                                                                                          |
--                           +---------------+----------------+----------------+            |
--                           | watdiv1052644 |        s       |        d       |            |
--                           +---------------+----------------+----------------+            |
--                                              |                |                          |
--                    +-------------------------+                |                          |
--                    |                                          |                          |
--                    |      +---------------+----------------+----------------+            |
--                    |      | watdiv1052628 |        s       |        d       |            |
--                    |      +---------------+----------------+----------------+            |
--                    |                                          |                          |
--                    |                                          |                          |
--                    |                                          |                          |
--                    |                       +---------------+----------------+----+       |
--                    |                       | watdiv1052649 |        s       |  d |       |
--                    |                       +---------------+----------------+----+       |
--                    |                                                                     |
--                    +---------------------------------------------------------------------+
with dummy as (select) /* stage1 */, watdiv1052651_s1_13e69700661fe70e as (select watdiv1052651.s as v4,watdiv1052651.d as v6 from watdiv1052651), watdiv1052647_s1_13e69700661fe70e as (select watdiv1052647.s as v4,watdiv1052647.d as v2 from watdiv1052647), watdiv1052572_s1_13e69700661fe70e as (select watdiv1052572.d as v2,watdiv1052572.s as v0 from watdiv1052572), watdiv1052646_s2_13e69700661fe70e as (select watdiv1052646.d as v0 from watdiv1052646), watdiv1052644_s1_13e69700661fe70e as (select watdiv1052644.d as v8,watdiv1052644.s as v6 from watdiv1052644), watdiv1052649_s2_13e69700661fe70e as (select watdiv1052649.s as v8 from watdiv1052649), watdiv1052628_s2_13e69700661fe70e as (select watdiv1052628.d as v8 from watdiv1052628) /* stage2 */, watdiv1052644_s2_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052644_s1_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052628_s2_13e69700661fe70e)) where watdiv1052644_s1_13e69700661fe70e.v8 = watdiv1052628_s2_13e69700661fe70e.v8) AND exists (select from umbra.identity(table(watdiv1052649_s2_13e69700661fe70e)) where watdiv1052644_s1_13e69700661fe70e.v8 = watdiv1052649_s2_13e69700661fe70e.v8)), watdiv1052572_s2_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052572_s1_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052646_s2_13e69700661fe70e)) where watdiv1052572_s1_13e69700661fe70e.v0 = watdiv1052646_s2_13e69700661fe70e.v0)), watdiv1052647_s2_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052647_s1_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052572_s2_13e69700661fe70e)) where watdiv1052647_s1_13e69700661fe70e.v2 = watdiv1052572_s2_13e69700661fe70e.v2)), watdiv1052651_s2_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052651_s1_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052644_s2_13e69700661fe70e)) where watdiv1052651_s1_13e69700661fe70e.v6 = watdiv1052644_s2_13e69700661fe70e.v6) AND exists (select from umbra.identity(table(watdiv1052647_s2_13e69700661fe70e)) where watdiv1052651_s1_13e69700661fe70e.v4 = watdiv1052647_s2_13e69700661fe70e.v4)) /* stage3 */, watdiv1052647_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052647_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052651_s2_13e69700661fe70e)) where watdiv1052647_s2_13e69700661fe70e.v4 = watdiv1052651_s2_13e69700661fe70e.v4)), watdiv1052572_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052572_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052647_s2_13e69700661fe70e)) where watdiv1052572_s2_13e69700661fe70e.v2 = watdiv1052647_s2_13e69700661fe70e.v2)), watdiv1052646_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052646_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052572_s2_13e69700661fe70e)) where watdiv1052646_s2_13e69700661fe70e.v0 = watdiv1052572_s2_13e69700661fe70e.v0)), watdiv1052644_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052644_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052651_s2_13e69700661fe70e)) where watdiv1052644_s2_13e69700661fe70e.v6 = watdiv1052651_s2_13e69700661fe70e.v6)), watdiv1052649_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052649_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052644_s2_13e69700661fe70e)) where watdiv1052649_s2_13e69700661fe70e.v8 = watdiv1052644_s2_13e69700661fe70e.v8)), watdiv1052628_s3_13e69700661fe70e as (select * from umbra.identity(table(watdiv1052628_s2_13e69700661fe70e)) where exists (select from umbra.identity(table(watdiv1052644_s2_13e69700661fe70e)) where watdiv1052628_s2_13e69700661fe70e.v8 = watdiv1052644_s2_13e69700661fe70e.v8)) /* stage4 */, s4_group_FA69D9048F467AD as  (select * from umbra.identity(table(watdiv1052651_s2_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052628_s3_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_13e69700661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052646_s3_13e69700661fe70e)))select count(*) from umbra.identity(table(s4_group_FA69D9048F467AD));
\set queryname watdiv_acyclic_210_03
-- Result size: 397686985
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052581 [label="watdiv1052581|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052586:s;watdiv1052586:d -> watdiv1052642:d;watdiv1052642:s -> watdiv1052651:s;watdiv1052651:d -> watdiv1052652:s;watdiv1052652:d -> watdiv1052573:d;watdiv1052573:d -> watdiv1052581:s;}
--                                                                          +--------------------+
--                                                                          |                    |
--                                                  +---------------+----+----+---------------+----+---+
--                                                  | watdiv1052573 |  s |  d | watdiv1052581 |  s | d |
--                                                  +---------------+----+----+---------------+----+---+
--                                                                          |
--                                               +---------------------+    |
--                                               |                     |    |
--                                               |  +---------------+----+----+
--   +-------------------------------------------+  | watdiv1052652 |  s |  d |
--   |                                              +---------------+----+----+
--   |
--   |                                           +---------------------+
--   |                                           |                     |
--   |                        +---------------+----+----------------+  |
--   |                        | watdiv1052586 |  s |        d       |  |
--   |                        +---------------+----+----------------+  |
--   |                                                |                |
--   |                                                |                |
--   |                                                |                |
--   |                        +---------------+----+----------------+  |
--   |                        | watdiv1052642 |  s |        d       |  |
--   |                        +---------------+----+----------------+  |
--   |                                           |                     |
--   |    +--------------------------------------+                     |
--   |    |                                                            |
--   |    |  +---------------+----------------+----+                   |
--   |    |  | watdiv1052624 |        s       |  d | ------------------+
--   |    |  +---------------+----------------+----+
--   |    |
--   |    +--------------------------------------+
--   |                                           |
--   |                        +---------------+----+----------------+
--   |                        | watdiv1052651 |  s |        d       |
--   |                        +---------------+----+----------------+
--   |                                                |
--   +------------------------------------------------+
with dummy as (select) /* stage1 */, watdiv1052651_s1_1c4cf300661fe70e as (select watdiv1052651.s as v4,watdiv1052651.d as v6 from watdiv1052651), watdiv1052642_s1_1c4cf300661fe70e as (select watdiv1052642.s as v4,watdiv1052642.d as v2 from watdiv1052642), watdiv1052586_s1_1c4cf300661fe70e as (select watdiv1052586.s as v0,watdiv1052586.d as v2 from watdiv1052586), watdiv1052624_s2_1c4cf300661fe70e as (select watdiv1052624.d as v0 from watdiv1052624), watdiv1052652_s1_1c4cf300661fe70e as (select watdiv1052652.d as v8,watdiv1052652.s as v6 from watdiv1052652), watdiv1052581_s1_1c4cf300661fe70e as (select watdiv1052581.s as v8 from watdiv1052581), watdiv1052573_s2_1c4cf300661fe70e as (select watdiv1052573.d as v8 from watdiv1052573) /* stage2 */, watdiv1052581_s2_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052581_s1_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052573_s2_1c4cf300661fe70e)) where watdiv1052581_s1_1c4cf300661fe70e.v8 = watdiv1052573_s2_1c4cf300661fe70e.v8)), watdiv1052652_s2_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052652_s1_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052581_s2_1c4cf300661fe70e)) where watdiv1052652_s1_1c4cf300661fe70e.v8 = watdiv1052581_s2_1c4cf300661fe70e.v8)), watdiv1052586_s2_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052586_s1_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052624_s2_1c4cf300661fe70e)) where watdiv1052586_s1_1c4cf300661fe70e.v0 = watdiv1052624_s2_1c4cf300661fe70e.v0)), watdiv1052642_s2_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052642_s1_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052586_s2_1c4cf300661fe70e)) where watdiv1052642_s1_1c4cf300661fe70e.v2 = watdiv1052586_s2_1c4cf300661fe70e.v2)), watdiv1052651_s2_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052651_s1_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052652_s2_1c4cf300661fe70e)) where watdiv1052651_s1_1c4cf300661fe70e.v6 = watdiv1052652_s2_1c4cf300661fe70e.v6) AND exists (select from umbra.identity(table(watdiv1052642_s2_1c4cf300661fe70e)) where watdiv1052651_s1_1c4cf300661fe70e.v4 = watdiv1052642_s2_1c4cf300661fe70e.v4)) /* stage3 */, watdiv1052642_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052642_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052651_s2_1c4cf300661fe70e)) where watdiv1052642_s2_1c4cf300661fe70e.v4 = watdiv1052651_s2_1c4cf300661fe70e.v4)), watdiv1052586_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052586_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052642_s2_1c4cf300661fe70e)) where watdiv1052586_s2_1c4cf300661fe70e.v2 = watdiv1052642_s2_1c4cf300661fe70e.v2)), watdiv1052624_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052624_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052586_s2_1c4cf300661fe70e)) where watdiv1052624_s2_1c4cf300661fe70e.v0 = watdiv1052586_s2_1c4cf300661fe70e.v0)), watdiv1052652_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052652_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052651_s2_1c4cf300661fe70e)) where watdiv1052652_s2_1c4cf300661fe70e.v6 = watdiv1052651_s2_1c4cf300661fe70e.v6)), watdiv1052581_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052581_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052652_s2_1c4cf300661fe70e)) where watdiv1052581_s2_1c4cf300661fe70e.v8 = watdiv1052652_s2_1c4cf300661fe70e.v8)), watdiv1052573_s3_1c4cf300661fe70e as (select * from umbra.identity(table(watdiv1052573_s2_1c4cf300661fe70e)) where exists (select from umbra.identity(table(watdiv1052581_s2_1c4cf300661fe70e)) where watdiv1052573_s2_1c4cf300661fe70e.v8 = watdiv1052581_s2_1c4cf300661fe70e.v8)) /* stage4 */, s4_group_5F26896E50F35397 as  (select * from umbra.identity(table(watdiv1052651_s2_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052581_s3_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_1c4cf300661fe70e)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1c4cf300661fe70e)))select count(*) from umbra.identity(table(s4_group_5F26896E50F35397));
--\set queryname watdiv_acyclic_210_04
-- Result size: 14713832951
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052608 [label="watdiv1052608|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052651:s;watdiv1052651:d -> watdiv1052644:d;watdiv1052644:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052608:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052608 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052651 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052644 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052655_s1_4c9a280661fe70f as (select watdiv1052655.d as v6,watdiv1052655.s as v4 from watdiv1052655), watdiv1052644_s1_4c9a280661fe70f as (select watdiv1052644.s as v4,watdiv1052644.d as v2 from watdiv1052644), watdiv1052651_s1_4c9a280661fe70f as (select watdiv1052651.s as v0,watdiv1052651.d as v2 from watdiv1052651), watdiv1052638_s2_4c9a280661fe70f as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_4c9a280661fe70f as (select watdiv1052624.s as v6,watdiv1052624.d as v8 from watdiv1052624), watdiv1052652_s2_4c9a280661fe70f as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052608_s2_4c9a280661fe70f as (select watdiv1052608.s as v8 from watdiv1052608) /* stage2 */, watdiv1052624_s2_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052624_s1_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052608_s2_4c9a280661fe70f)) where watdiv1052624_s1_4c9a280661fe70f.v8 = watdiv1052608_s2_4c9a280661fe70f.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_4c9a280661fe70f)) where watdiv1052624_s1_4c9a280661fe70f.v8 = watdiv1052652_s2_4c9a280661fe70f.v8)), watdiv1052651_s2_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052651_s1_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052638_s2_4c9a280661fe70f)) where watdiv1052651_s1_4c9a280661fe70f.v0 = watdiv1052638_s2_4c9a280661fe70f.v0)), watdiv1052644_s2_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052644_s1_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052651_s2_4c9a280661fe70f)) where watdiv1052644_s1_4c9a280661fe70f.v2 = watdiv1052651_s2_4c9a280661fe70f.v2)), watdiv1052655_s2_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052655_s1_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052624_s2_4c9a280661fe70f)) where watdiv1052655_s1_4c9a280661fe70f.v6 = watdiv1052624_s2_4c9a280661fe70f.v6) AND exists (select from umbra.identity(table(watdiv1052644_s2_4c9a280661fe70f)) where watdiv1052655_s1_4c9a280661fe70f.v4 = watdiv1052644_s2_4c9a280661fe70f.v4)) /* stage3 */, watdiv1052644_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052644_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052655_s2_4c9a280661fe70f)) where watdiv1052644_s2_4c9a280661fe70f.v4 = watdiv1052655_s2_4c9a280661fe70f.v4)), watdiv1052651_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052651_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052644_s2_4c9a280661fe70f)) where watdiv1052651_s2_4c9a280661fe70f.v2 = watdiv1052644_s2_4c9a280661fe70f.v2)), watdiv1052638_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052638_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052651_s2_4c9a280661fe70f)) where watdiv1052638_s2_4c9a280661fe70f.v0 = watdiv1052651_s2_4c9a280661fe70f.v0)), watdiv1052624_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052624_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052655_s2_4c9a280661fe70f)) where watdiv1052624_s2_4c9a280661fe70f.v6 = watdiv1052655_s2_4c9a280661fe70f.v6)), watdiv1052652_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052652_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052624_s2_4c9a280661fe70f)) where watdiv1052652_s2_4c9a280661fe70f.v8 = watdiv1052624_s2_4c9a280661fe70f.v8)), watdiv1052608_s3_4c9a280661fe70f as (select * from umbra.identity(table(watdiv1052608_s2_4c9a280661fe70f)) where exists (select from umbra.identity(table(watdiv1052624_s2_4c9a280661fe70f)) where watdiv1052608_s2_4c9a280661fe70f.v8 = watdiv1052624_s2_4c9a280661fe70f.v8)) /* stage4 */, s4_group_12CD5C82FE89C0EF as  (select * from umbra.identity(table(watdiv1052655_s2_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052608_s3_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_4c9a280661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_4c9a280661fe70f)))select count(*) from umbra.identity(table(s4_group_12CD5C82FE89C0EF));
--\set queryname watdiv_acyclic_210_05
-- Result size: 1052739990
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052649:d;watdiv1052649:s -> watdiv1052644:s;watdiv1052644:d -> watdiv1052646:s;watdiv1052646:d -> watdiv1052613:d;watdiv1052613:d -> watdiv1052572:s;}
--                                                                        +---------------+----+---+
--                                                                        | watdiv1052572 |  s | d |
--                                                                        +---------------+----+---+
--                                                                                           |
--                                                                                           |
--                                                                                           |
-- +---------------+----+----+          +---------------+----------------+----------------+  |
-- | watdiv1052644 |  s |  d | ------+  | watdiv1052646 |        s       |        d       |  |
-- +---------------+----+----+       |  +---------------+----------------+----------------+  |
--                    |              |                     |                |                |
--                    |              +---------------------+                |                |
--                    |                                                     |                |
-- +---------------+----+----+          +---------------+----------------+----------------+  |
-- | watdiv1052649 |  s |  d |          | watdiv1052613 |        s       |        d       | -+
-- +---------------+----+----+          +---------------+----------------+----------------+
--                         |
--                         +-----------------------------------------------------------------+
--                                                                                           |
--                                      +---------------+----------------+----------------+  |
--                                      | watdiv1052638 |        s       |        d       |  |
--                                      +---------------+----------------+----------------+  |
--                                                                          |                |
--                                                                          |                |
--                                                                          |                |
--                                                       +---------------+----------------+----+
--                                                       | watdiv1052650 |        s       |  d |
--                                                       +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052649_s1_d52e200661fe70f as (select watdiv1052649.d as v2,watdiv1052649.s as v4 from watdiv1052649), watdiv1052644_s1_d52e200661fe70f as (select watdiv1052644.d as v6,watdiv1052644.s as v4 from watdiv1052644), watdiv1052646_s1_d52e200661fe70f as (select watdiv1052646.d as v8,watdiv1052646.s as v6 from watdiv1052646), watdiv1052613_s1_d52e200661fe70f as (select watdiv1052613.d as v8 from watdiv1052613), watdiv1052572_s2_d52e200661fe70f as (select watdiv1052572.s as v8 from watdiv1052572), watdiv1052650_s1_d52e200661fe70f as (select watdiv1052650.d as v2,watdiv1052650.s as v0 from watdiv1052650), watdiv1052638_s2_d52e200661fe70f as (select watdiv1052638.d as v0 from watdiv1052638) /* stage2 */, watdiv1052650_s2_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052650_s1_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052638_s2_d52e200661fe70f)) where watdiv1052650_s1_d52e200661fe70f.v0 = watdiv1052638_s2_d52e200661fe70f.v0)), watdiv1052613_s2_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052613_s1_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052572_s2_d52e200661fe70f)) where watdiv1052613_s1_d52e200661fe70f.v8 = watdiv1052572_s2_d52e200661fe70f.v8)), watdiv1052646_s2_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052646_s1_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052613_s2_d52e200661fe70f)) where watdiv1052646_s1_d52e200661fe70f.v8 = watdiv1052613_s2_d52e200661fe70f.v8)), watdiv1052644_s2_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052644_s1_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052646_s2_d52e200661fe70f)) where watdiv1052644_s1_d52e200661fe70f.v6 = watdiv1052646_s2_d52e200661fe70f.v6)), watdiv1052649_s2_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052649_s1_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052650_s2_d52e200661fe70f)) where watdiv1052649_s1_d52e200661fe70f.v2 = watdiv1052650_s2_d52e200661fe70f.v2) AND exists (select from umbra.identity(table(watdiv1052644_s2_d52e200661fe70f)) where watdiv1052649_s1_d52e200661fe70f.v4 = watdiv1052644_s2_d52e200661fe70f.v4)) /* stage3 */, watdiv1052644_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052644_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052649_s2_d52e200661fe70f)) where watdiv1052644_s2_d52e200661fe70f.v4 = watdiv1052649_s2_d52e200661fe70f.v4)), watdiv1052646_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052646_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052644_s2_d52e200661fe70f)) where watdiv1052646_s2_d52e200661fe70f.v6 = watdiv1052644_s2_d52e200661fe70f.v6)), watdiv1052613_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052613_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052646_s2_d52e200661fe70f)) where watdiv1052613_s2_d52e200661fe70f.v8 = watdiv1052646_s2_d52e200661fe70f.v8)), watdiv1052572_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052572_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052613_s2_d52e200661fe70f)) where watdiv1052572_s2_d52e200661fe70f.v8 = watdiv1052613_s2_d52e200661fe70f.v8)), watdiv1052650_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052650_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052649_s2_d52e200661fe70f)) where watdiv1052650_s2_d52e200661fe70f.v2 = watdiv1052649_s2_d52e200661fe70f.v2)), watdiv1052638_s3_d52e200661fe70f as (select * from umbra.identity(table(watdiv1052638_s2_d52e200661fe70f)) where exists (select from umbra.identity(table(watdiv1052650_s2_d52e200661fe70f)) where watdiv1052638_s2_d52e200661fe70f.v0 = watdiv1052650_s2_d52e200661fe70f.v0)) /* stage4 */, s4_group_A3B45EDE1B0A953 as  (select * from umbra.identity(table(watdiv1052649_s2_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052646_s3_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052613_s3_d52e200661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_d52e200661fe70f)))select count(*) from umbra.identity(table(s4_group_A3B45EDE1B0A953));
--\set queryname watdiv_acyclic_210_06
-- Result size: 4378444200
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052656 [label="watdiv1052656|<s> s|<d> d"]; watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052573:s;watdiv1052573:d -> watdiv1052586:s;watdiv1052586:d -> watdiv1052642:d;watdiv1052642:d -> watdiv1052656:s;}
--                                                                       +---------------+----+----+
--                                                                       | watdiv1052578 |  s |  d |
--                                                                       +---------------+----+----+
--                                                                                          |    |
--                    +---------------------------------------------------------------------+    |
--                    |                                                                          |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                  | watdiv1052572 |  s |  d | watdiv1052646 | s |  d |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                                     |                             |
--                    |                                                                     +-----------------------------+
--                    |
-- +---------------+----+---+          +---------------+----------------+----------------+
-- | watdiv1052573 |  s | d | ------+  | watdiv1052586 |        s       |        d       |
-- +---------------+----+---+       |  +---------------+----------------+----------------+
--                                  |                     |                |
--                                  +---------------------+                |
--                                                                         |
--                                     +---------------+----------------+----------------+
--                                     | watdiv1052642 |        s       |        d       |
--                                     +---------------+----------------+----------------+
--                                                                         |
--                                                                         |
--                                                                         |
--                                                      +---------------+----------------+----+
--                                                      | watdiv1052656 |        s       |  d |
--                                                      +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052578_s1_1604bc80661fe70f as (select watdiv1052578.s as v4,watdiv1052578.d as v2 from watdiv1052578), watdiv1052573_s1_1604bc80661fe70f as (select watdiv1052573.s as v4,watdiv1052573.d as v6 from watdiv1052573), watdiv1052586_s1_1604bc80661fe70f as (select watdiv1052586.d as v8,watdiv1052586.s as v6 from watdiv1052586), watdiv1052656_s2_1604bc80661fe70f as (select watdiv1052656.s as v8 from watdiv1052656), watdiv1052642_s2_1604bc80661fe70f as (select watdiv1052642.d as v8 from watdiv1052642), watdiv1052572_s1_1604bc80661fe70f as (select watdiv1052572.s as v0,watdiv1052572.d as v2 from watdiv1052572), watdiv1052646_s2_1604bc80661fe70f as (select watdiv1052646.d as v0 from watdiv1052646) /* stage2 */, watdiv1052572_s2_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052572_s1_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052646_s2_1604bc80661fe70f)) where watdiv1052572_s1_1604bc80661fe70f.v0 = watdiv1052646_s2_1604bc80661fe70f.v0)), watdiv1052586_s2_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052586_s1_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052642_s2_1604bc80661fe70f)) where watdiv1052586_s1_1604bc80661fe70f.v8 = watdiv1052642_s2_1604bc80661fe70f.v8) AND exists (select from umbra.identity(table(watdiv1052656_s2_1604bc80661fe70f)) where watdiv1052586_s1_1604bc80661fe70f.v8 = watdiv1052656_s2_1604bc80661fe70f.v8)), watdiv1052573_s2_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052573_s1_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052586_s2_1604bc80661fe70f)) where watdiv1052573_s1_1604bc80661fe70f.v6 = watdiv1052586_s2_1604bc80661fe70f.v6)), watdiv1052578_s2_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052578_s1_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052572_s2_1604bc80661fe70f)) where watdiv1052578_s1_1604bc80661fe70f.v2 = watdiv1052572_s2_1604bc80661fe70f.v2) AND exists (select from umbra.identity(table(watdiv1052573_s2_1604bc80661fe70f)) where watdiv1052578_s1_1604bc80661fe70f.v4 = watdiv1052573_s2_1604bc80661fe70f.v4)) /* stage3 */, watdiv1052573_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052573_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052578_s2_1604bc80661fe70f)) where watdiv1052573_s2_1604bc80661fe70f.v4 = watdiv1052578_s2_1604bc80661fe70f.v4)), watdiv1052586_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052586_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052573_s2_1604bc80661fe70f)) where watdiv1052586_s2_1604bc80661fe70f.v6 = watdiv1052573_s2_1604bc80661fe70f.v6)), watdiv1052656_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052656_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052586_s2_1604bc80661fe70f)) where watdiv1052656_s2_1604bc80661fe70f.v8 = watdiv1052586_s2_1604bc80661fe70f.v8)), watdiv1052642_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052642_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052586_s2_1604bc80661fe70f)) where watdiv1052642_s2_1604bc80661fe70f.v8 = watdiv1052586_s2_1604bc80661fe70f.v8)), watdiv1052572_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052572_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052578_s2_1604bc80661fe70f)) where watdiv1052572_s2_1604bc80661fe70f.v2 = watdiv1052578_s2_1604bc80661fe70f.v2)), watdiv1052646_s3_1604bc80661fe70f as (select * from umbra.identity(table(watdiv1052646_s2_1604bc80661fe70f)) where exists (select from umbra.identity(table(watdiv1052572_s2_1604bc80661fe70f)) where watdiv1052646_s2_1604bc80661fe70f.v0 = watdiv1052572_s2_1604bc80661fe70f.v0)) /* stage4 */, s4_group_332DA4F8702989E2 as  (select * from umbra.identity(table(watdiv1052578_s2_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052646_s3_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_1604bc80661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052656_s3_1604bc80661fe70f)))select count(*) from umbra.identity(table(s4_group_332DA4F8702989E2));
\set queryname watdiv_acyclic_210_07
-- Result size: 23996021
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052612 [label="watdiv1052612|<s> s|<d> d"]; watdiv1052594 [label="watdiv1052594|<s> s|<d> d"]; watdiv1052608 [label="watdiv1052608|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052584 [label="watdiv1052584|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052612:s;watdiv1052612:d -> watdiv1052594:d;watdiv1052594:s -> watdiv1052608:s;watdiv1052608:d -> watdiv1052651:s;watdiv1052651:d -> watdiv1052644:d;watdiv1052644:d -> watdiv1052584:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052584 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052651 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052644 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
--                  +---------------+----------------+----+       |
--                  | watdiv1052594 |        s       |  d | ------+----+
--                  +---------------+----------------+----+       |    |
--                                     |                          |    |
--                                     |                          |    |
--                                     |                          |    |
--                  +---------------+----------------+----+       |    |
--                  | watdiv1052608 |        s       |  d | ------+    |
--                  +---------------+----------------+----+            |
--                  +---------------+----------------+----+            |
--                  | watdiv1052612 |        s       |  d | -----------+
--                  +---------------+----------------+----+
--                                     |
--                                     |
--                                     |
-- +---------------+----------------+----------------+
-- | watdiv1052624 |        s       |        d       |
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052608_s1_1e834780661fe70f as (select watdiv1052608.d as v6,watdiv1052608.s as v4 from watdiv1052608), watdiv1052594_s1_1e834780661fe70f as (select watdiv1052594.d as v2,watdiv1052594.s as v4 from watdiv1052594), watdiv1052612_s1_1e834780661fe70f as (select watdiv1052612.s as v0,watdiv1052612.d as v2 from watdiv1052612), watdiv1052624_s2_1e834780661fe70f as (select watdiv1052624.d as v0 from watdiv1052624), watdiv1052651_s1_1e834780661fe70f as (select watdiv1052651.d as v8,watdiv1052651.s as v6 from watdiv1052651), watdiv1052644_s1_1e834780661fe70f as (select watdiv1052644.d as v8 from watdiv1052644), watdiv1052584_s2_1e834780661fe70f as (select watdiv1052584.s as v8 from watdiv1052584) /* stage2 */, watdiv1052644_s2_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052644_s1_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052584_s2_1e834780661fe70f)) where watdiv1052644_s1_1e834780661fe70f.v8 = watdiv1052584_s2_1e834780661fe70f.v8)), watdiv1052651_s2_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052651_s1_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052644_s2_1e834780661fe70f)) where watdiv1052651_s1_1e834780661fe70f.v8 = watdiv1052644_s2_1e834780661fe70f.v8)), watdiv1052612_s2_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052612_s1_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052624_s2_1e834780661fe70f)) where watdiv1052612_s1_1e834780661fe70f.v0 = watdiv1052624_s2_1e834780661fe70f.v0)), watdiv1052594_s2_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052594_s1_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052612_s2_1e834780661fe70f)) where watdiv1052594_s1_1e834780661fe70f.v2 = watdiv1052612_s2_1e834780661fe70f.v2)), watdiv1052608_s2_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052608_s1_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052651_s2_1e834780661fe70f)) where watdiv1052608_s1_1e834780661fe70f.v6 = watdiv1052651_s2_1e834780661fe70f.v6) AND exists (select from umbra.identity(table(watdiv1052594_s2_1e834780661fe70f)) where watdiv1052608_s1_1e834780661fe70f.v4 = watdiv1052594_s2_1e834780661fe70f.v4)) /* stage3 */, watdiv1052594_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052594_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052608_s2_1e834780661fe70f)) where watdiv1052594_s2_1e834780661fe70f.v4 = watdiv1052608_s2_1e834780661fe70f.v4)), watdiv1052612_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052612_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052594_s2_1e834780661fe70f)) where watdiv1052612_s2_1e834780661fe70f.v2 = watdiv1052594_s2_1e834780661fe70f.v2)), watdiv1052624_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052624_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052612_s2_1e834780661fe70f)) where watdiv1052624_s2_1e834780661fe70f.v0 = watdiv1052612_s2_1e834780661fe70f.v0)), watdiv1052651_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052651_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052608_s2_1e834780661fe70f)) where watdiv1052651_s2_1e834780661fe70f.v6 = watdiv1052608_s2_1e834780661fe70f.v6)), watdiv1052644_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052644_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052651_s2_1e834780661fe70f)) where watdiv1052644_s2_1e834780661fe70f.v8 = watdiv1052651_s2_1e834780661fe70f.v8)), watdiv1052584_s3_1e834780661fe70f as (select * from umbra.identity(table(watdiv1052584_s2_1e834780661fe70f)) where exists (select from umbra.identity(table(watdiv1052644_s2_1e834780661fe70f)) where watdiv1052584_s2_1e834780661fe70f.v8 = watdiv1052644_s2_1e834780661fe70f.v8)) /* stage4 */, s4_group_8D12EA5E937C022 as  (select * from umbra.identity(table(watdiv1052608_s2_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052584_s3_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052594_s3_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052612_s3_1e834780661fe70f)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1e834780661fe70f)))select count(*) from umbra.identity(table(s4_group_8D12EA5E937C022));
--\set queryname watdiv_acyclic_210_08
-- Result size: 2547015183
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052641 [label="watdiv1052641|<s> s|<d> d"]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052655:d -> watdiv1052574:s;watdiv1052574:d -> watdiv1052641:d;watdiv1052641:s -> watdiv1052638:s;watdiv1052638:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052651:d;watdiv1052651:d -> watdiv1052642:s;}
--                                                                       +---------------+----+----+
--                                                                       | watdiv1052641 |  s |  d |
--                                                                       +---------------+----+----+
--                                                                                          |    |
--                    +---------------------------------------------------------------------+    |
--                    |                                                                          |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                  | watdiv1052574 |  s |  d | watdiv1052655 | s |  d |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                                     |                             |
--                    |                                                                     +-----------------------------+
--                    |
-- +---------------+----+---+          +---------------+----------------+----------------+
-- | watdiv1052638 |  s | d | ------+  | watdiv1052644 |        s       |        d       |
-- +---------------+----+---+       |  +---------------+----------------+----------------+
--                                  |                     |                |
--                                  +---------------------+                |
--                                                                         |
--                                     +---------------+----------------+----------------+
--                                     | watdiv1052651 |        s       |        d       |
--                                     +---------------+----------------+----------------+
--                                                                         |
--                                                                         |
--                                                                         |
--                                                      +---------------+----------------+----+
--                                                      | watdiv1052642 |        s       |  d |
--                                                      +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052641_s1_6dd9f80661fe710 as (select watdiv1052641.s as v4,watdiv1052641.d as v2 from watdiv1052641), watdiv1052638_s1_6dd9f80661fe710 as (select watdiv1052638.s as v4,watdiv1052638.d as v6 from watdiv1052638), watdiv1052644_s1_6dd9f80661fe710 as (select watdiv1052644.d as v8,watdiv1052644.s as v6 from watdiv1052644), watdiv1052651_s2_6dd9f80661fe710 as (select watdiv1052651.d as v8 from watdiv1052651), watdiv1052642_s2_6dd9f80661fe710 as (select watdiv1052642.s as v8 from watdiv1052642), watdiv1052574_s1_6dd9f80661fe710 as (select watdiv1052574.s as v0,watdiv1052574.d as v2 from watdiv1052574), watdiv1052655_s2_6dd9f80661fe710 as (select watdiv1052655.d as v0 from watdiv1052655) /* stage2 */, watdiv1052574_s2_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052574_s1_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052655_s2_6dd9f80661fe710)) where watdiv1052574_s1_6dd9f80661fe710.v0 = watdiv1052655_s2_6dd9f80661fe710.v0)), watdiv1052644_s2_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052644_s1_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052642_s2_6dd9f80661fe710)) where watdiv1052644_s1_6dd9f80661fe710.v8 = watdiv1052642_s2_6dd9f80661fe710.v8) AND exists (select from umbra.identity(table(watdiv1052651_s2_6dd9f80661fe710)) where watdiv1052644_s1_6dd9f80661fe710.v8 = watdiv1052651_s2_6dd9f80661fe710.v8)), watdiv1052638_s2_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052638_s1_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052644_s2_6dd9f80661fe710)) where watdiv1052638_s1_6dd9f80661fe710.v6 = watdiv1052644_s2_6dd9f80661fe710.v6)), watdiv1052641_s2_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052641_s1_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052574_s2_6dd9f80661fe710)) where watdiv1052641_s1_6dd9f80661fe710.v2 = watdiv1052574_s2_6dd9f80661fe710.v2) AND exists (select from umbra.identity(table(watdiv1052638_s2_6dd9f80661fe710)) where watdiv1052641_s1_6dd9f80661fe710.v4 = watdiv1052638_s2_6dd9f80661fe710.v4)) /* stage3 */, watdiv1052638_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052638_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052641_s2_6dd9f80661fe710)) where watdiv1052638_s2_6dd9f80661fe710.v4 = watdiv1052641_s2_6dd9f80661fe710.v4)), watdiv1052644_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052644_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052638_s2_6dd9f80661fe710)) where watdiv1052644_s2_6dd9f80661fe710.v6 = watdiv1052638_s2_6dd9f80661fe710.v6)), watdiv1052651_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052651_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052644_s2_6dd9f80661fe710)) where watdiv1052651_s2_6dd9f80661fe710.v8 = watdiv1052644_s2_6dd9f80661fe710.v8)), watdiv1052642_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052642_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052644_s2_6dd9f80661fe710)) where watdiv1052642_s2_6dd9f80661fe710.v8 = watdiv1052644_s2_6dd9f80661fe710.v8)), watdiv1052574_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052574_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052641_s2_6dd9f80661fe710)) where watdiv1052574_s2_6dd9f80661fe710.v2 = watdiv1052641_s2_6dd9f80661fe710.v2)), watdiv1052655_s3_6dd9f80661fe710 as (select * from umbra.identity(table(watdiv1052655_s2_6dd9f80661fe710)) where exists (select from umbra.identity(table(watdiv1052574_s2_6dd9f80661fe710)) where watdiv1052655_s2_6dd9f80661fe710.v0 = watdiv1052574_s2_6dd9f80661fe710.v0)) /* stage4 */, s4_group_7C926EB7AC07982E as  (select * from umbra.identity(table(watdiv1052641_s2_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052655_s3_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_6dd9f80661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_6dd9f80661fe710)))select count(*) from umbra.identity(table(s4_group_7C926EB7AC07982E));
--\set queryname watdiv_acyclic_210_09
-- Result size: 13382913720
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052581 [label="watdiv1052581|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052649:s;watdiv1052649:d -> watdiv1052650:d;watdiv1052650:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052581:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052581 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052649 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052650 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052655_s1_f77ea00661fe710 as (select watdiv1052655.d as v6,watdiv1052655.s as v4 from watdiv1052655), watdiv1052650_s1_f77ea00661fe710 as (select watdiv1052650.d as v2,watdiv1052650.s as v4 from watdiv1052650), watdiv1052649_s1_f77ea00661fe710 as (select watdiv1052649.d as v2,watdiv1052649.s as v0 from watdiv1052649), watdiv1052638_s2_f77ea00661fe710 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_f77ea00661fe710 as (select watdiv1052624.s as v6,watdiv1052624.d as v8 from watdiv1052624), watdiv1052652_s2_f77ea00661fe710 as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052581_s2_f77ea00661fe710 as (select watdiv1052581.s as v8 from watdiv1052581) /* stage2 */, watdiv1052624_s2_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052624_s1_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052581_s2_f77ea00661fe710)) where watdiv1052624_s1_f77ea00661fe710.v8 = watdiv1052581_s2_f77ea00661fe710.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_f77ea00661fe710)) where watdiv1052624_s1_f77ea00661fe710.v8 = watdiv1052652_s2_f77ea00661fe710.v8)), watdiv1052649_s2_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052649_s1_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052638_s2_f77ea00661fe710)) where watdiv1052649_s1_f77ea00661fe710.v0 = watdiv1052638_s2_f77ea00661fe710.v0)), watdiv1052650_s2_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052650_s1_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052649_s2_f77ea00661fe710)) where watdiv1052650_s1_f77ea00661fe710.v2 = watdiv1052649_s2_f77ea00661fe710.v2)), watdiv1052655_s2_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052655_s1_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_f77ea00661fe710)) where watdiv1052655_s1_f77ea00661fe710.v6 = watdiv1052624_s2_f77ea00661fe710.v6) AND exists (select from umbra.identity(table(watdiv1052650_s2_f77ea00661fe710)) where watdiv1052655_s1_f77ea00661fe710.v4 = watdiv1052650_s2_f77ea00661fe710.v4)) /* stage3 */, watdiv1052650_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052650_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052655_s2_f77ea00661fe710)) where watdiv1052650_s2_f77ea00661fe710.v4 = watdiv1052655_s2_f77ea00661fe710.v4)), watdiv1052649_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052649_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052650_s2_f77ea00661fe710)) where watdiv1052649_s2_f77ea00661fe710.v2 = watdiv1052650_s2_f77ea00661fe710.v2)), watdiv1052638_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052638_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052649_s2_f77ea00661fe710)) where watdiv1052638_s2_f77ea00661fe710.v0 = watdiv1052649_s2_f77ea00661fe710.v0)), watdiv1052624_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052624_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052655_s2_f77ea00661fe710)) where watdiv1052624_s2_f77ea00661fe710.v6 = watdiv1052655_s2_f77ea00661fe710.v6)), watdiv1052652_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052652_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_f77ea00661fe710)) where watdiv1052652_s2_f77ea00661fe710.v8 = watdiv1052624_s2_f77ea00661fe710.v8)), watdiv1052581_s3_f77ea00661fe710 as (select * from umbra.identity(table(watdiv1052581_s2_f77ea00661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_f77ea00661fe710)) where watdiv1052581_s2_f77ea00661fe710.v8 = watdiv1052624_s2_f77ea00661fe710.v8)) /* stage4 */, s4_group_1A0908648799BA24 as  (select * from umbra.identity(table(watdiv1052655_s2_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052581_s3_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_f77ea00661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_f77ea00661fe710)))select count(*) from umbra.identity(table(s4_group_1A0908648799BA24));
--\set queryname watdiv_acyclic_210_10
-- Result size: 13381681631
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052581 [label="watdiv1052581|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052649:d;watdiv1052649:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052581:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052581 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052650 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052649 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052655_s1_181ce680661fe710 as (select watdiv1052655.s as v4,watdiv1052655.d as v6 from watdiv1052655), watdiv1052649_s1_181ce680661fe710 as (select watdiv1052649.s as v4,watdiv1052649.d as v2 from watdiv1052649), watdiv1052650_s1_181ce680661fe710 as (select watdiv1052650.s as v0,watdiv1052650.d as v2 from watdiv1052650), watdiv1052638_s2_181ce680661fe710 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_181ce680661fe710 as (select watdiv1052624.d as v8,watdiv1052624.s as v6 from watdiv1052624), watdiv1052652_s2_181ce680661fe710 as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052581_s2_181ce680661fe710 as (select watdiv1052581.s as v8 from watdiv1052581) /* stage2 */, watdiv1052624_s2_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052624_s1_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052581_s2_181ce680661fe710)) where watdiv1052624_s1_181ce680661fe710.v8 = watdiv1052581_s2_181ce680661fe710.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_181ce680661fe710)) where watdiv1052624_s1_181ce680661fe710.v8 = watdiv1052652_s2_181ce680661fe710.v8)), watdiv1052650_s2_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052650_s1_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052638_s2_181ce680661fe710)) where watdiv1052650_s1_181ce680661fe710.v0 = watdiv1052638_s2_181ce680661fe710.v0)), watdiv1052649_s2_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052649_s1_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052650_s2_181ce680661fe710)) where watdiv1052649_s1_181ce680661fe710.v2 = watdiv1052650_s2_181ce680661fe710.v2)), watdiv1052655_s2_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052655_s1_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_181ce680661fe710)) where watdiv1052655_s1_181ce680661fe710.v6 = watdiv1052624_s2_181ce680661fe710.v6) AND exists (select from umbra.identity(table(watdiv1052649_s2_181ce680661fe710)) where watdiv1052655_s1_181ce680661fe710.v4 = watdiv1052649_s2_181ce680661fe710.v4)) /* stage3 */, watdiv1052649_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052649_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052655_s2_181ce680661fe710)) where watdiv1052649_s2_181ce680661fe710.v4 = watdiv1052655_s2_181ce680661fe710.v4)), watdiv1052650_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052650_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052649_s2_181ce680661fe710)) where watdiv1052650_s2_181ce680661fe710.v2 = watdiv1052649_s2_181ce680661fe710.v2)), watdiv1052638_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052638_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052650_s2_181ce680661fe710)) where watdiv1052638_s2_181ce680661fe710.v0 = watdiv1052650_s2_181ce680661fe710.v0)), watdiv1052624_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052624_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052655_s2_181ce680661fe710)) where watdiv1052624_s2_181ce680661fe710.v6 = watdiv1052655_s2_181ce680661fe710.v6)), watdiv1052652_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052652_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_181ce680661fe710)) where watdiv1052652_s2_181ce680661fe710.v8 = watdiv1052624_s2_181ce680661fe710.v8)), watdiv1052581_s3_181ce680661fe710 as (select * from umbra.identity(table(watdiv1052581_s2_181ce680661fe710)) where exists (select from umbra.identity(table(watdiv1052624_s2_181ce680661fe710)) where watdiv1052581_s2_181ce680661fe710.v8 = watdiv1052624_s2_181ce680661fe710.v8)) /* stage4 */, s4_group_6D78F84D1EDB1B8 as  (select * from umbra.identity(table(watdiv1052655_s2_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052581_s3_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_181ce680661fe710)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_181ce680661fe710)))select count(*) from umbra.identity(table(s4_group_6D78F84D1EDB1B8));
\set queryname watdiv_acyclic_210_11
-- Result size: 32034103
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052600 [label="watdiv1052600|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052649:d;watdiv1052649:s -> watdiv1052652:s;watdiv1052652:d -> watdiv1052586:s;watdiv1052586:d -> watdiv1052642:d;watdiv1052642:d -> watdiv1052600:s;}
--                                                      +-------------------------+
--                                                      |                         |
--                                   +---------------+----------------+----+      |
--                                   | watdiv1052586 |        s       |  d |      |
--                                   +---------------+----------------+----+      |
--                                                                       |        |
--                                                                       |        |
--                                                                       |        |
--                                   +---------------+----------------+----+      |
--                                   | watdiv1052642 |        s       |  d |      |
--                                   +---------------+----------------+----+      |
--                                                                       |        |
--                                                                       |        |
--                                                                       |        |
--                                                    +---------------+----+---+  |
--                                                    | watdiv1052600 |  s | d |  |
--                                                    +---------------+----+---+  |
-- +---------------+----------------+----------------+                            |
-- | watdiv1052638 |        s       |        d       |                            |
-- +---------------+----------------+----------------+                            |
--                                     |                                          |
--                                     |                                          |
--                                     |                                          |
--                  +---------------+----------------+----------------+           |
--                  | watdiv1052650 |        s       |        d       |           |
--                  +---------------+----------------+----------------+           |
--                                                      |                         |
--                                                      |                         |
--                                                      |                         |
--                  +---------------+----------------+----------------+           |
--                  | watdiv1052649 |        s       |        d       |           |
--                  +---------------+----------------+----------------+           |
--                                     |                                          |
--                                     |                                          |
--                                     |                                          |
--                  +---------------+----------------+----------------+           |
--                  | watdiv1052652 |        s       |        d       | ----------+
--                  +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052652_s1_a33080661fe711 as (select watdiv1052652.d as v6,watdiv1052652.s as v4 from watdiv1052652), watdiv1052649_s1_a33080661fe711 as (select watdiv1052649.d as v2,watdiv1052649.s as v4 from watdiv1052649), watdiv1052650_s1_a33080661fe711 as (select watdiv1052650.d as v2,watdiv1052650.s as v0 from watdiv1052650), watdiv1052638_s2_a33080661fe711 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052586_s1_a33080661fe711 as (select watdiv1052586.s as v6,watdiv1052586.d as v8 from watdiv1052586), watdiv1052642_s2_a33080661fe711 as (select watdiv1052642.d as v8 from watdiv1052642), watdiv1052600_s2_a33080661fe711 as (select watdiv1052600.s as v8 from watdiv1052600) /* stage2 */, watdiv1052586_s2_a33080661fe711 as (select * from umbra.identity(table(watdiv1052586_s1_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052600_s2_a33080661fe711)) where watdiv1052586_s1_a33080661fe711.v8 = watdiv1052600_s2_a33080661fe711.v8) AND exists (select from umbra.identity(table(watdiv1052642_s2_a33080661fe711)) where watdiv1052586_s1_a33080661fe711.v8 = watdiv1052642_s2_a33080661fe711.v8)), watdiv1052650_s2_a33080661fe711 as (select * from umbra.identity(table(watdiv1052650_s1_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052638_s2_a33080661fe711)) where watdiv1052650_s1_a33080661fe711.v0 = watdiv1052638_s2_a33080661fe711.v0)), watdiv1052649_s2_a33080661fe711 as (select * from umbra.identity(table(watdiv1052649_s1_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052650_s2_a33080661fe711)) where watdiv1052649_s1_a33080661fe711.v2 = watdiv1052650_s2_a33080661fe711.v2)), watdiv1052652_s2_a33080661fe711 as (select * from umbra.identity(table(watdiv1052652_s1_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052586_s2_a33080661fe711)) where watdiv1052652_s1_a33080661fe711.v6 = watdiv1052586_s2_a33080661fe711.v6) AND exists (select from umbra.identity(table(watdiv1052649_s2_a33080661fe711)) where watdiv1052652_s1_a33080661fe711.v4 = watdiv1052649_s2_a33080661fe711.v4)) /* stage3 */, watdiv1052649_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052649_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052652_s2_a33080661fe711)) where watdiv1052649_s2_a33080661fe711.v4 = watdiv1052652_s2_a33080661fe711.v4)), watdiv1052650_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052650_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052649_s2_a33080661fe711)) where watdiv1052650_s2_a33080661fe711.v2 = watdiv1052649_s2_a33080661fe711.v2)), watdiv1052638_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052638_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052650_s2_a33080661fe711)) where watdiv1052638_s2_a33080661fe711.v0 = watdiv1052650_s2_a33080661fe711.v0)), watdiv1052586_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052586_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052652_s2_a33080661fe711)) where watdiv1052586_s2_a33080661fe711.v6 = watdiv1052652_s2_a33080661fe711.v6)), watdiv1052642_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052642_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052586_s2_a33080661fe711)) where watdiv1052642_s2_a33080661fe711.v8 = watdiv1052586_s2_a33080661fe711.v8)), watdiv1052600_s3_a33080661fe711 as (select * from umbra.identity(table(watdiv1052600_s2_a33080661fe711)) where exists (select from umbra.identity(table(watdiv1052586_s2_a33080661fe711)) where watdiv1052600_s2_a33080661fe711.v8 = watdiv1052586_s2_a33080661fe711.v8)) /* stage4 */, s4_group_591F73286ABD4730 as  (select * from umbra.identity(table(watdiv1052652_s2_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052600_s3_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_a33080661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_a33080661fe711)))select count(*) from umbra.identity(table(s4_group_591F73286ABD4730));
--\set queryname watdiv_acyclic_210_12
-- Result size: 1183348435
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052641 [label="watdiv1052641|<s> s|<d> d"]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052655:d -> watdiv1052574:s;watdiv1052574:d -> watdiv1052641:d;watdiv1052641:s -> watdiv1052638:s;watdiv1052638:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052651:d;watdiv1052651:d -> watdiv1052649:s;}
--                                                                       +---------------+----+----+
--                                                                       | watdiv1052641 |  s |  d |
--                                                                       +---------------+----+----+
--                                                                                          |    |
--                    +---------------------------------------------------------------------+    |
--                    |                                                                          |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                  | watdiv1052574 |  s |  d | watdiv1052655 | s |  d |
--                    |                                                  +---------------+----+----+---------------+---+----+
--                    |                                                                     |                             |
--                    |                                                                     +-----------------------------+
--                    |
-- +---------------+----+---+          +---------------+----------------+----------------+
-- | watdiv1052638 |  s | d | ------+  | watdiv1052644 |        s       |        d       |
-- +---------------+----+---+       |  +---------------+----------------+----------------+
--                                  |                     |                |
--                                  +---------------------+                |
--                                                                         |
--                                     +---------------+----------------+----------------+
--                                     | watdiv1052651 |        s       |        d       |
--                                     +---------------+----------------+----------------+
--                                                                         |
--                                                                         |
--                                                                         |
--                                                      +---------------+----------------+----+
--                                                      | watdiv1052649 |        s       |  d |
--                                                      +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052641_s1_9165a80661fe711 as (select watdiv1052641.s as v4,watdiv1052641.d as v2 from watdiv1052641), watdiv1052638_s1_9165a80661fe711 as (select watdiv1052638.s as v4,watdiv1052638.d as v6 from watdiv1052638), watdiv1052644_s1_9165a80661fe711 as (select watdiv1052644.d as v8,watdiv1052644.s as v6 from watdiv1052644), watdiv1052651_s2_9165a80661fe711 as (select watdiv1052651.d as v8 from watdiv1052651), watdiv1052649_s2_9165a80661fe711 as (select watdiv1052649.s as v8 from watdiv1052649), watdiv1052574_s1_9165a80661fe711 as (select watdiv1052574.s as v0,watdiv1052574.d as v2 from watdiv1052574), watdiv1052655_s2_9165a80661fe711 as (select watdiv1052655.d as v0 from watdiv1052655) /* stage2 */, watdiv1052574_s2_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052574_s1_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052655_s2_9165a80661fe711)) where watdiv1052574_s1_9165a80661fe711.v0 = watdiv1052655_s2_9165a80661fe711.v0)), watdiv1052644_s2_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052644_s1_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052649_s2_9165a80661fe711)) where watdiv1052644_s1_9165a80661fe711.v8 = watdiv1052649_s2_9165a80661fe711.v8) AND exists (select from umbra.identity(table(watdiv1052651_s2_9165a80661fe711)) where watdiv1052644_s1_9165a80661fe711.v8 = watdiv1052651_s2_9165a80661fe711.v8)), watdiv1052638_s2_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052638_s1_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052644_s2_9165a80661fe711)) where watdiv1052638_s1_9165a80661fe711.v6 = watdiv1052644_s2_9165a80661fe711.v6)), watdiv1052641_s2_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052641_s1_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052574_s2_9165a80661fe711)) where watdiv1052641_s1_9165a80661fe711.v2 = watdiv1052574_s2_9165a80661fe711.v2) AND exists (select from umbra.identity(table(watdiv1052638_s2_9165a80661fe711)) where watdiv1052641_s1_9165a80661fe711.v4 = watdiv1052638_s2_9165a80661fe711.v4)) /* stage3 */, watdiv1052638_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052638_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052641_s2_9165a80661fe711)) where watdiv1052638_s2_9165a80661fe711.v4 = watdiv1052641_s2_9165a80661fe711.v4)), watdiv1052644_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052644_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052638_s2_9165a80661fe711)) where watdiv1052644_s2_9165a80661fe711.v6 = watdiv1052638_s2_9165a80661fe711.v6)), watdiv1052651_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052651_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052644_s2_9165a80661fe711)) where watdiv1052651_s2_9165a80661fe711.v8 = watdiv1052644_s2_9165a80661fe711.v8)), watdiv1052649_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052649_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052644_s2_9165a80661fe711)) where watdiv1052649_s2_9165a80661fe711.v8 = watdiv1052644_s2_9165a80661fe711.v8)), watdiv1052574_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052574_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052641_s2_9165a80661fe711)) where watdiv1052574_s2_9165a80661fe711.v2 = watdiv1052641_s2_9165a80661fe711.v2)), watdiv1052655_s3_9165a80661fe711 as (select * from umbra.identity(table(watdiv1052655_s2_9165a80661fe711)) where exists (select from umbra.identity(table(watdiv1052574_s2_9165a80661fe711)) where watdiv1052655_s2_9165a80661fe711.v0 = watdiv1052574_s2_9165a80661fe711.v0)) /* stage4 */, s4_group_17FFBC3626A66ED7 as  (select * from umbra.identity(table(watdiv1052641_s2_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052655_s3_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_9165a80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_9165a80661fe711)))select count(*) from umbra.identity(table(s4_group_17FFBC3626A66ED7));
\set queryname watdiv_acyclic_210_13
-- Result size: 165842326
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052585 [label="watdiv1052585|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052649:s;watdiv1052649:d -> watdiv1052650:d;watdiv1052650:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052585:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052585 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052649 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052650 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052655_s1_1171f400661fe711 as (select watdiv1052655.s as v4,watdiv1052655.d as v6 from watdiv1052655), watdiv1052650_s1_1171f400661fe711 as (select watdiv1052650.d as v2,watdiv1052650.s as v4 from watdiv1052650), watdiv1052649_s1_1171f400661fe711 as (select watdiv1052649.d as v2,watdiv1052649.s as v0 from watdiv1052649), watdiv1052638_s2_1171f400661fe711 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_1171f400661fe711 as (select watdiv1052624.d as v8,watdiv1052624.s as v6 from watdiv1052624), watdiv1052652_s2_1171f400661fe711 as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052585_s2_1171f400661fe711 as (select watdiv1052585.s as v8 from watdiv1052585) /* stage2 */, watdiv1052624_s2_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052624_s1_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052585_s2_1171f400661fe711)) where watdiv1052624_s1_1171f400661fe711.v8 = watdiv1052585_s2_1171f400661fe711.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_1171f400661fe711)) where watdiv1052624_s1_1171f400661fe711.v8 = watdiv1052652_s2_1171f400661fe711.v8)), watdiv1052649_s2_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052649_s1_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052638_s2_1171f400661fe711)) where watdiv1052649_s1_1171f400661fe711.v0 = watdiv1052638_s2_1171f400661fe711.v0)), watdiv1052650_s2_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052650_s1_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052649_s2_1171f400661fe711)) where watdiv1052650_s1_1171f400661fe711.v2 = watdiv1052649_s2_1171f400661fe711.v2)), watdiv1052655_s2_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052655_s1_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1171f400661fe711)) where watdiv1052655_s1_1171f400661fe711.v6 = watdiv1052624_s2_1171f400661fe711.v6) AND exists (select from umbra.identity(table(watdiv1052650_s2_1171f400661fe711)) where watdiv1052655_s1_1171f400661fe711.v4 = watdiv1052650_s2_1171f400661fe711.v4)) /* stage3 */, watdiv1052650_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052650_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052655_s2_1171f400661fe711)) where watdiv1052650_s2_1171f400661fe711.v4 = watdiv1052655_s2_1171f400661fe711.v4)), watdiv1052649_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052649_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052650_s2_1171f400661fe711)) where watdiv1052649_s2_1171f400661fe711.v2 = watdiv1052650_s2_1171f400661fe711.v2)), watdiv1052638_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052638_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052649_s2_1171f400661fe711)) where watdiv1052638_s2_1171f400661fe711.v0 = watdiv1052649_s2_1171f400661fe711.v0)), watdiv1052624_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052624_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052655_s2_1171f400661fe711)) where watdiv1052624_s2_1171f400661fe711.v6 = watdiv1052655_s2_1171f400661fe711.v6)), watdiv1052652_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052652_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1171f400661fe711)) where watdiv1052652_s2_1171f400661fe711.v8 = watdiv1052624_s2_1171f400661fe711.v8)), watdiv1052585_s3_1171f400661fe711 as (select * from umbra.identity(table(watdiv1052585_s2_1171f400661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1171f400661fe711)) where watdiv1052585_s2_1171f400661fe711.v8 = watdiv1052624_s2_1171f400661fe711.v8)) /* stage4 */, s4_group_6D666CCDB1F7CCFB as  (select * from umbra.identity(table(watdiv1052655_s2_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052585_s3_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_1171f400661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_1171f400661fe711)))select count(*) from umbra.identity(table(s4_group_6D666CCDB1F7CCFB));
\set queryname watdiv_acyclic_210_14
-- Result size: 271342012
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052649:d;watdiv1052649:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052586:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052586 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052650 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052649 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052655_s1_1a169b80661fe711 as (select watdiv1052655.s as v4,watdiv1052655.d as v6 from watdiv1052655), watdiv1052649_s1_1a169b80661fe711 as (select watdiv1052649.s as v4,watdiv1052649.d as v2 from watdiv1052649), watdiv1052650_s1_1a169b80661fe711 as (select watdiv1052650.s as v0,watdiv1052650.d as v2 from watdiv1052650), watdiv1052638_s2_1a169b80661fe711 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_1a169b80661fe711 as (select watdiv1052624.d as v8,watdiv1052624.s as v6 from watdiv1052624), watdiv1052652_s2_1a169b80661fe711 as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052586_s2_1a169b80661fe711 as (select watdiv1052586.s as v8 from watdiv1052586) /* stage2 */, watdiv1052624_s2_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052624_s1_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052586_s2_1a169b80661fe711)) where watdiv1052624_s1_1a169b80661fe711.v8 = watdiv1052586_s2_1a169b80661fe711.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_1a169b80661fe711)) where watdiv1052624_s1_1a169b80661fe711.v8 = watdiv1052652_s2_1a169b80661fe711.v8)), watdiv1052650_s2_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052650_s1_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052638_s2_1a169b80661fe711)) where watdiv1052650_s1_1a169b80661fe711.v0 = watdiv1052638_s2_1a169b80661fe711.v0)), watdiv1052649_s2_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052649_s1_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052650_s2_1a169b80661fe711)) where watdiv1052649_s1_1a169b80661fe711.v2 = watdiv1052650_s2_1a169b80661fe711.v2)), watdiv1052655_s2_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052655_s1_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1a169b80661fe711)) where watdiv1052655_s1_1a169b80661fe711.v6 = watdiv1052624_s2_1a169b80661fe711.v6) AND exists (select from umbra.identity(table(watdiv1052649_s2_1a169b80661fe711)) where watdiv1052655_s1_1a169b80661fe711.v4 = watdiv1052649_s2_1a169b80661fe711.v4)) /* stage3 */, watdiv1052649_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052649_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052655_s2_1a169b80661fe711)) where watdiv1052649_s2_1a169b80661fe711.v4 = watdiv1052655_s2_1a169b80661fe711.v4)), watdiv1052650_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052650_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052649_s2_1a169b80661fe711)) where watdiv1052650_s2_1a169b80661fe711.v2 = watdiv1052649_s2_1a169b80661fe711.v2)), watdiv1052638_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052638_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052650_s2_1a169b80661fe711)) where watdiv1052638_s2_1a169b80661fe711.v0 = watdiv1052650_s2_1a169b80661fe711.v0)), watdiv1052624_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052624_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052655_s2_1a169b80661fe711)) where watdiv1052624_s2_1a169b80661fe711.v6 = watdiv1052655_s2_1a169b80661fe711.v6)), watdiv1052652_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052652_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1a169b80661fe711)) where watdiv1052652_s2_1a169b80661fe711.v8 = watdiv1052624_s2_1a169b80661fe711.v8)), watdiv1052586_s3_1a169b80661fe711 as (select * from umbra.identity(table(watdiv1052586_s2_1a169b80661fe711)) where exists (select from umbra.identity(table(watdiv1052624_s2_1a169b80661fe711)) where watdiv1052586_s2_1a169b80661fe711.v8 = watdiv1052624_s2_1a169b80661fe711.v8)) /* stage4 */, s4_group_6C73B64DA10624A0 as  (select * from umbra.identity(table(watdiv1052655_s2_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_1a169b80661fe711)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_1a169b80661fe711)))select count(*) from umbra.identity(table(s4_group_6C73B64DA10624A0));
\set queryname watdiv_acyclic_210_15
-- Result size: 12177467
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052592 [label="watdiv1052592|<s> s|<d> d"]; watdiv1052595 [label="watdiv1052595|<s> s|<d> d"]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052655:d -> watdiv1052574:s;watdiv1052574:d -> watdiv1052592:d;watdiv1052592:s -> watdiv1052595:s;watdiv1052595:d -> watdiv1052638:s;watdiv1052638:d -> watdiv1052644:d;watdiv1052644:d -> watdiv1052629:s;}
--                                              +--------------------------------------+
--                                              |                                      |
--                                              |              +---------------+----+----+
--                                              |              | watdiv1052595 |  s |  d |
--                                              |              +---------------+----+----+
--                                              |                                 |
--                                              |                                 |
--                                              |                                 |
--                                              |              +---------------+----+----+
--                                              |              | watdiv1052592 |  s |  d |
--                                              |              +---------------+----+----+
--                                              |                                      |
--                                              |                                      |
--                                              |                                      |
-- +---------------+---+----+                   |              +---------------+----+----+
-- | watdiv1052655 | s |  d |                   |              | watdiv1052574 |  s |  d |
-- +---------------+---+----+                   |              +---------------+----+----+
--                        |                     |                                 |
--                        |                     |                                 +----+
--                        |                     |                                      |
--                        |  +---------------+----------------+----------------+       |
--                        |  | watdiv1052638 |        s       |        d       |       |
--                        |  +---------------+----------------+----------------+       |
--                        |                                      |                     |
--                        |                                      |                     |
--                        |                                      |                     |
--                        |  +---------------+----------------+----------------+       |
--                        |  | watdiv1052644 |        s       |        d       |       |
--                        |  +---------------+----------------+----------------+       |
--                        |                                      |                     |
--                        |                                      |                     |
--                        |                                      |                     |
--                        |                   +---------------+----------------+----+  |
--                        |                   | watdiv1052629 |        s       |  d |  |
--                        |                   +---------------+----------------+----+  |
--                        |                                                            |
--                        +------------------------------------------------------------+
with dummy as (select) /* stage1 */, watdiv1052595_s1_2b57700661fe712 as (select watdiv1052595.d as v6,watdiv1052595.s as v4 from watdiv1052595), watdiv1052592_s1_2b57700661fe712 as (select watdiv1052592.d as v2,watdiv1052592.s as v4 from watdiv1052592), watdiv1052574_s1_2b57700661fe712 as (select watdiv1052574.d as v2,watdiv1052574.s as v0 from watdiv1052574), watdiv1052655_s2_2b57700661fe712 as (select watdiv1052655.d as v0 from watdiv1052655), watdiv1052638_s1_2b57700661fe712 as (select watdiv1052638.s as v6,watdiv1052638.d as v8 from watdiv1052638), watdiv1052644_s2_2b57700661fe712 as (select watdiv1052644.d as v8 from watdiv1052644), watdiv1052629_s2_2b57700661fe712 as (select watdiv1052629.s as v8 from watdiv1052629) /* stage2 */, watdiv1052638_s2_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052638_s1_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052629_s2_2b57700661fe712)) where watdiv1052638_s1_2b57700661fe712.v8 = watdiv1052629_s2_2b57700661fe712.v8) AND exists (select from umbra.identity(table(watdiv1052644_s2_2b57700661fe712)) where watdiv1052638_s1_2b57700661fe712.v8 = watdiv1052644_s2_2b57700661fe712.v8)), watdiv1052574_s2_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052574_s1_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052655_s2_2b57700661fe712)) where watdiv1052574_s1_2b57700661fe712.v0 = watdiv1052655_s2_2b57700661fe712.v0)), watdiv1052592_s2_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052592_s1_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052574_s2_2b57700661fe712)) where watdiv1052592_s1_2b57700661fe712.v2 = watdiv1052574_s2_2b57700661fe712.v2)), watdiv1052595_s2_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052595_s1_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052638_s2_2b57700661fe712)) where watdiv1052595_s1_2b57700661fe712.v6 = watdiv1052638_s2_2b57700661fe712.v6) AND exists (select from umbra.identity(table(watdiv1052592_s2_2b57700661fe712)) where watdiv1052595_s1_2b57700661fe712.v4 = watdiv1052592_s2_2b57700661fe712.v4)) /* stage3 */, watdiv1052592_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052592_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052595_s2_2b57700661fe712)) where watdiv1052592_s2_2b57700661fe712.v4 = watdiv1052595_s2_2b57700661fe712.v4)), watdiv1052574_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052574_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052592_s2_2b57700661fe712)) where watdiv1052574_s2_2b57700661fe712.v2 = watdiv1052592_s2_2b57700661fe712.v2)), watdiv1052655_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052655_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052574_s2_2b57700661fe712)) where watdiv1052655_s2_2b57700661fe712.v0 = watdiv1052574_s2_2b57700661fe712.v0)), watdiv1052638_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052638_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052595_s2_2b57700661fe712)) where watdiv1052638_s2_2b57700661fe712.v6 = watdiv1052595_s2_2b57700661fe712.v6)), watdiv1052644_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052644_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052638_s2_2b57700661fe712)) where watdiv1052644_s2_2b57700661fe712.v8 = watdiv1052638_s2_2b57700661fe712.v8)), watdiv1052629_s3_2b57700661fe712 as (select * from umbra.identity(table(watdiv1052629_s2_2b57700661fe712)) where exists (select from umbra.identity(table(watdiv1052638_s2_2b57700661fe712)) where watdiv1052629_s2_2b57700661fe712.v8 = watdiv1052638_s2_2b57700661fe712.v8)) /* stage4 */, s4_group_17E747DCE0495565 as  (select * from umbra.identity(table(watdiv1052595_s2_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052592_s3_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_2b57700661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052655_s3_2b57700661fe712)))select count(*) from umbra.identity(table(s4_group_17E747DCE0495565));
--\set queryname watdiv_acyclic_210_16
-- Result size: 1036956266510
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052595 [label="watdiv1052595|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:d -> watdiv1052595:s;}
--                    +-------------------------------------------+
--                    |                                           |
--                    |              +---------------+----+----+  |
--                    |              | watdiv1052595 |  s |  d |  |
--                    |              +---------------+----+----+  |
--                    |                                 |         |
--                    |                                 |         |
--                    |                                 |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052624 |        s       |        d       |  |         |
-- +---------------+----------------+----------------+  |         |
--                                     |                |         |
--                                     |                |         |
--                                     |                |         |
-- +---------------+----------------+----------------+  |         |
-- | watdiv1052652 |        s       |        d       | -+         |
-- +---------------+----------------+----------------+            |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052644 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052651 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052655_s1_b1d6080661fe712 as (select watdiv1052655.d as v6,watdiv1052655.s as v4 from watdiv1052655), watdiv1052651_s1_b1d6080661fe712 as (select watdiv1052651.d as v2,watdiv1052651.s as v4 from watdiv1052651), watdiv1052644_s1_b1d6080661fe712 as (select watdiv1052644.s as v0,watdiv1052644.d as v2 from watdiv1052644), watdiv1052638_s2_b1d6080661fe712 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_b1d6080661fe712 as (select watdiv1052624.d as v8,watdiv1052624.s as v6 from watdiv1052624), watdiv1052652_s2_b1d6080661fe712 as (select watdiv1052652.d as v8 from watdiv1052652), watdiv1052595_s2_b1d6080661fe712 as (select watdiv1052595.s as v8 from watdiv1052595) /* stage2 */, watdiv1052624_s2_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052624_s1_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052595_s2_b1d6080661fe712)) where watdiv1052624_s1_b1d6080661fe712.v8 = watdiv1052595_s2_b1d6080661fe712.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_b1d6080661fe712)) where watdiv1052624_s1_b1d6080661fe712.v8 = watdiv1052652_s2_b1d6080661fe712.v8)), watdiv1052644_s2_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052644_s1_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052638_s2_b1d6080661fe712)) where watdiv1052644_s1_b1d6080661fe712.v0 = watdiv1052638_s2_b1d6080661fe712.v0)), watdiv1052651_s2_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052651_s1_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052644_s2_b1d6080661fe712)) where watdiv1052651_s1_b1d6080661fe712.v2 = watdiv1052644_s2_b1d6080661fe712.v2)), watdiv1052655_s2_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052655_s1_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_b1d6080661fe712)) where watdiv1052655_s1_b1d6080661fe712.v6 = watdiv1052624_s2_b1d6080661fe712.v6) AND exists (select from umbra.identity(table(watdiv1052651_s2_b1d6080661fe712)) where watdiv1052655_s1_b1d6080661fe712.v4 = watdiv1052651_s2_b1d6080661fe712.v4)) /* stage3 */, watdiv1052651_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052651_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052655_s2_b1d6080661fe712)) where watdiv1052651_s2_b1d6080661fe712.v4 = watdiv1052655_s2_b1d6080661fe712.v4)), watdiv1052644_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052644_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052651_s2_b1d6080661fe712)) where watdiv1052644_s2_b1d6080661fe712.v2 = watdiv1052651_s2_b1d6080661fe712.v2)), watdiv1052638_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052638_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052644_s2_b1d6080661fe712)) where watdiv1052638_s2_b1d6080661fe712.v0 = watdiv1052644_s2_b1d6080661fe712.v0)), watdiv1052624_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052624_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052655_s2_b1d6080661fe712)) where watdiv1052624_s2_b1d6080661fe712.v6 = watdiv1052655_s2_b1d6080661fe712.v6)), watdiv1052652_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052652_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_b1d6080661fe712)) where watdiv1052652_s2_b1d6080661fe712.v8 = watdiv1052624_s2_b1d6080661fe712.v8)), watdiv1052595_s3_b1d6080661fe712 as (select * from umbra.identity(table(watdiv1052595_s2_b1d6080661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_b1d6080661fe712)) where watdiv1052595_s2_b1d6080661fe712.v8 = watdiv1052624_s2_b1d6080661fe712.v8)) /* stage4 */, s4_group_1DB399C61981C23D as  (select * from umbra.identity(table(watdiv1052655_s2_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052595_s3_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_b1d6080661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_b1d6080661fe712)))select count(*) from umbra.identity(table(s4_group_1DB399C61981C23D));
--\set queryname watdiv_acyclic_210_17
-- Result size: 1123125657
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052582 [label="watdiv1052582|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052651:s;watdiv1052651:d -> watdiv1052644:d;watdiv1052644:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052573:d;watdiv1052573:d -> watdiv1052582:s;}
--                                                           +--------------------+
--                                                           |                    |
--                                   +---------------+----+----+---------------+----+---+
--                                   | watdiv1052573 |  s |  d | watdiv1052582 |  s | d |
--                                   +---------------+----+----+---------------+----+---+
--                                                           |
--                                                           |
--                                                           |
--                                   +---------------+----+----+
--                                   | watdiv1052624 |  s |  d |
--                                   +---------------+----+----+
--                                                      |
--                                                      +---------+
--                                                                |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052651 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052644 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052655_s1_13ad8980661fe712 as (select watdiv1052655.d as v6,watdiv1052655.s as v4 from watdiv1052655), watdiv1052644_s1_13ad8980661fe712 as (select watdiv1052644.s as v4,watdiv1052644.d as v2 from watdiv1052644), watdiv1052651_s1_13ad8980661fe712 as (select watdiv1052651.d as v2,watdiv1052651.s as v0 from watdiv1052651), watdiv1052638_s2_13ad8980661fe712 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_13ad8980661fe712 as (select watdiv1052624.s as v6,watdiv1052624.d as v8 from watdiv1052624), watdiv1052582_s1_13ad8980661fe712 as (select watdiv1052582.s as v8 from watdiv1052582), watdiv1052573_s2_13ad8980661fe712 as (select watdiv1052573.d as v8 from watdiv1052573) /* stage2 */, watdiv1052582_s2_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052582_s1_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052573_s2_13ad8980661fe712)) where watdiv1052582_s1_13ad8980661fe712.v8 = watdiv1052573_s2_13ad8980661fe712.v8)), watdiv1052624_s2_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052624_s1_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052582_s2_13ad8980661fe712)) where watdiv1052624_s1_13ad8980661fe712.v8 = watdiv1052582_s2_13ad8980661fe712.v8)), watdiv1052651_s2_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052651_s1_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052638_s2_13ad8980661fe712)) where watdiv1052651_s1_13ad8980661fe712.v0 = watdiv1052638_s2_13ad8980661fe712.v0)), watdiv1052644_s2_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052644_s1_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052651_s2_13ad8980661fe712)) where watdiv1052644_s1_13ad8980661fe712.v2 = watdiv1052651_s2_13ad8980661fe712.v2)), watdiv1052655_s2_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052655_s1_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_13ad8980661fe712)) where watdiv1052655_s1_13ad8980661fe712.v6 = watdiv1052624_s2_13ad8980661fe712.v6) AND exists (select from umbra.identity(table(watdiv1052644_s2_13ad8980661fe712)) where watdiv1052655_s1_13ad8980661fe712.v4 = watdiv1052644_s2_13ad8980661fe712.v4)) /* stage3 */, watdiv1052644_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052644_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052655_s2_13ad8980661fe712)) where watdiv1052644_s2_13ad8980661fe712.v4 = watdiv1052655_s2_13ad8980661fe712.v4)), watdiv1052651_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052651_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052644_s2_13ad8980661fe712)) where watdiv1052651_s2_13ad8980661fe712.v2 = watdiv1052644_s2_13ad8980661fe712.v2)), watdiv1052638_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052638_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052651_s2_13ad8980661fe712)) where watdiv1052638_s2_13ad8980661fe712.v0 = watdiv1052651_s2_13ad8980661fe712.v0)), watdiv1052624_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052624_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052655_s2_13ad8980661fe712)) where watdiv1052624_s2_13ad8980661fe712.v6 = watdiv1052655_s2_13ad8980661fe712.v6)), watdiv1052582_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052582_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_13ad8980661fe712)) where watdiv1052582_s2_13ad8980661fe712.v8 = watdiv1052624_s2_13ad8980661fe712.v8)), watdiv1052573_s3_13ad8980661fe712 as (select * from umbra.identity(table(watdiv1052573_s2_13ad8980661fe712)) where exists (select from umbra.identity(table(watdiv1052582_s2_13ad8980661fe712)) where watdiv1052573_s2_13ad8980661fe712.v8 = watdiv1052582_s2_13ad8980661fe712.v8)) /* stage4 */, s4_group_36BCFDE30EC0698B as  (select * from umbra.identity(table(watdiv1052655_s2_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052582_s3_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_13ad8980661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_13ad8980661fe712)))select count(*) from umbra.identity(table(s4_group_36BCFDE30EC0698B));
\set queryname watdiv_acyclic_210_18
-- Result size: 126105
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052596 [label="watdiv1052596|<s> s|<d> d"]; watdiv1052618 [label="watdiv1052618|<s> s|<d> d"]; watdiv1052602 [label="watdiv1052602|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052596:s;watdiv1052596:d -> watdiv1052618:d;watdiv1052618:s -> watdiv1052602:s;watdiv1052602:d -> watdiv1052646:s;watdiv1052646:d -> watdiv1052613:d;watdiv1052613:d -> watdiv1052572:s;}
--                                                                       +---------------+----+---+
--                                                                       | watdiv1052572 |  s | d |
--                                                                       +---------------+----+---+
--                                                                                          |
--                                                                                          |
--                                                                                          |
-- +---------------+----+---+                      +---------------+----+----------------+  |
-- | watdiv1052602 |  s | d | ------+              | watdiv1052646 |  s |        d       |  |
-- +---------------+----+---+       |              +---------------+----+----------------+  |
--                    |             |                                 |    |                |
--                    |             +---------------------------------+    |                |
--                    |                                                    |                |
--                    |                            +---------------+----+----------------+  |
--                    |                            | watdiv1052613 |  s |        d       | -+
--                    |                            +---------------+----+----------------+
--                    |
--                    |                                               +---------------------+
--                    |                                               |                     |
--                    |                            +---------------+----+----------------+  |
--                    |                            | watdiv1052596 |  s |        d       |  |
--                    |                            +---------------+----+----------------+  |
--                    |                                                    |                |
--                    +-----------------------------------------------+    |                |
--                                                                    |    |                |
--                                                 +---------------+----+----------------+  |
--                                                 | watdiv1052618 |  s |        d       |  |
--                                                 +---------------+----+----------------+  |
--                                +---------------+----------------+----+                   |
--                                | watdiv1052624 |        s       |  d | ------------------+
--                                +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052618_s1_1c21da00661fe712 as (select watdiv1052618.d as v2,watdiv1052618.s as v4 from watdiv1052618), watdiv1052602_s1_1c21da00661fe712 as (select watdiv1052602.d as v6,watdiv1052602.s as v4 from watdiv1052602), watdiv1052646_s1_1c21da00661fe712 as (select watdiv1052646.d as v8,watdiv1052646.s as v6 from watdiv1052646), watdiv1052613_s1_1c21da00661fe712 as (select watdiv1052613.d as v8 from watdiv1052613), watdiv1052572_s2_1c21da00661fe712 as (select watdiv1052572.s as v8 from watdiv1052572), watdiv1052596_s1_1c21da00661fe712 as (select watdiv1052596.s as v0,watdiv1052596.d as v2 from watdiv1052596), watdiv1052624_s2_1c21da00661fe712 as (select watdiv1052624.d as v0 from watdiv1052624) /* stage2 */, watdiv1052596_s2_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052596_s1_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052624_s2_1c21da00661fe712)) where watdiv1052596_s1_1c21da00661fe712.v0 = watdiv1052624_s2_1c21da00661fe712.v0)), watdiv1052613_s2_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052613_s1_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052572_s2_1c21da00661fe712)) where watdiv1052613_s1_1c21da00661fe712.v8 = watdiv1052572_s2_1c21da00661fe712.v8)), watdiv1052646_s2_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052646_s1_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052613_s2_1c21da00661fe712)) where watdiv1052646_s1_1c21da00661fe712.v8 = watdiv1052613_s2_1c21da00661fe712.v8)), watdiv1052602_s2_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052602_s1_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052646_s2_1c21da00661fe712)) where watdiv1052602_s1_1c21da00661fe712.v6 = watdiv1052646_s2_1c21da00661fe712.v6)), watdiv1052618_s2_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052618_s1_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052596_s2_1c21da00661fe712)) where watdiv1052618_s1_1c21da00661fe712.v2 = watdiv1052596_s2_1c21da00661fe712.v2) AND exists (select from umbra.identity(table(watdiv1052602_s2_1c21da00661fe712)) where watdiv1052618_s1_1c21da00661fe712.v4 = watdiv1052602_s2_1c21da00661fe712.v4)) /* stage3 */, watdiv1052602_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052602_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052618_s2_1c21da00661fe712)) where watdiv1052602_s2_1c21da00661fe712.v4 = watdiv1052618_s2_1c21da00661fe712.v4)), watdiv1052646_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052646_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052602_s2_1c21da00661fe712)) where watdiv1052646_s2_1c21da00661fe712.v6 = watdiv1052602_s2_1c21da00661fe712.v6)), watdiv1052613_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052613_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052646_s2_1c21da00661fe712)) where watdiv1052613_s2_1c21da00661fe712.v8 = watdiv1052646_s2_1c21da00661fe712.v8)), watdiv1052572_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052572_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052613_s2_1c21da00661fe712)) where watdiv1052572_s2_1c21da00661fe712.v8 = watdiv1052613_s2_1c21da00661fe712.v8)), watdiv1052596_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052596_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052618_s2_1c21da00661fe712)) where watdiv1052596_s2_1c21da00661fe712.v2 = watdiv1052618_s2_1c21da00661fe712.v2)), watdiv1052624_s3_1c21da00661fe712 as (select * from umbra.identity(table(watdiv1052624_s2_1c21da00661fe712)) where exists (select from umbra.identity(table(watdiv1052596_s2_1c21da00661fe712)) where watdiv1052624_s2_1c21da00661fe712.v0 = watdiv1052596_s2_1c21da00661fe712.v0)) /* stage4 */, s4_group_B2E7FF24F9773C8 as  (select * from umbra.identity(table(watdiv1052618_s2_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052596_s3_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052602_s3_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052646_s3_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052613_s3_1c21da00661fe712)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_1c21da00661fe712)))select count(*) from umbra.identity(table(s4_group_B2E7FF24F9773C8));
\set queryname watdiv_acyclic_210_19
-- Result size: 708977295
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052583 [label="watdiv1052583|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052573:d;watdiv1052573:d -> watdiv1052583:s;}
--                                                           +--------------------+
--                                                           |                    |
--                                   +---------------+----+----+---------------+----+---+
--                                   | watdiv1052573 |  s |  d | watdiv1052583 |  s | d |
--                                   +---------------+----+----+---------------+----+---+
--                                                           |
--                                                           |
--                                                           |
--                                   +---------------+----+----+
--                                   | watdiv1052624 |  s |  d |
--                                   +---------------+----+----+
--                                                      |
--                                                      +---------+
--                                                                |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052644 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                                      |         |
--                                                      |         |
--                                                      |         |
--                  +---------------+----------------+----+       |
--                  | watdiv1052651 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052655 |        s       |  d | ------+
--                  +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052655_s1_4a63a00661fe713 as (select watdiv1052655.d as v6,watdiv1052655.s as v4 from watdiv1052655), watdiv1052651_s1_4a63a00661fe713 as (select watdiv1052651.d as v2,watdiv1052651.s as v4 from watdiv1052651), watdiv1052644_s1_4a63a00661fe713 as (select watdiv1052644.s as v0,watdiv1052644.d as v2 from watdiv1052644), watdiv1052638_s2_4a63a00661fe713 as (select watdiv1052638.d as v0 from watdiv1052638), watdiv1052624_s1_4a63a00661fe713 as (select watdiv1052624.s as v6,watdiv1052624.d as v8 from watdiv1052624), watdiv1052583_s1_4a63a00661fe713 as (select watdiv1052583.s as v8 from watdiv1052583), watdiv1052573_s2_4a63a00661fe713 as (select watdiv1052573.d as v8 from watdiv1052573) /* stage2 */, watdiv1052583_s2_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052583_s1_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052573_s2_4a63a00661fe713)) where watdiv1052583_s1_4a63a00661fe713.v8 = watdiv1052573_s2_4a63a00661fe713.v8)), watdiv1052624_s2_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052624_s1_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052583_s2_4a63a00661fe713)) where watdiv1052624_s1_4a63a00661fe713.v8 = watdiv1052583_s2_4a63a00661fe713.v8)), watdiv1052644_s2_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052644_s1_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052638_s2_4a63a00661fe713)) where watdiv1052644_s1_4a63a00661fe713.v0 = watdiv1052638_s2_4a63a00661fe713.v0)), watdiv1052651_s2_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052651_s1_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052644_s2_4a63a00661fe713)) where watdiv1052651_s1_4a63a00661fe713.v2 = watdiv1052644_s2_4a63a00661fe713.v2)), watdiv1052655_s2_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052655_s1_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052624_s2_4a63a00661fe713)) where watdiv1052655_s1_4a63a00661fe713.v6 = watdiv1052624_s2_4a63a00661fe713.v6) AND exists (select from umbra.identity(table(watdiv1052651_s2_4a63a00661fe713)) where watdiv1052655_s1_4a63a00661fe713.v4 = watdiv1052651_s2_4a63a00661fe713.v4)) /* stage3 */, watdiv1052651_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052651_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052655_s2_4a63a00661fe713)) where watdiv1052651_s2_4a63a00661fe713.v4 = watdiv1052655_s2_4a63a00661fe713.v4)), watdiv1052644_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052644_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052651_s2_4a63a00661fe713)) where watdiv1052644_s2_4a63a00661fe713.v2 = watdiv1052651_s2_4a63a00661fe713.v2)), watdiv1052638_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052638_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052644_s2_4a63a00661fe713)) where watdiv1052638_s2_4a63a00661fe713.v0 = watdiv1052644_s2_4a63a00661fe713.v0)), watdiv1052624_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052624_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052655_s2_4a63a00661fe713)) where watdiv1052624_s2_4a63a00661fe713.v6 = watdiv1052655_s2_4a63a00661fe713.v6)), watdiv1052583_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052583_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052624_s2_4a63a00661fe713)) where watdiv1052583_s2_4a63a00661fe713.v8 = watdiv1052624_s2_4a63a00661fe713.v8)), watdiv1052573_s3_4a63a00661fe713 as (select * from umbra.identity(table(watdiv1052573_s2_4a63a00661fe713)) where exists (select from umbra.identity(table(watdiv1052583_s2_4a63a00661fe713)) where watdiv1052573_s2_4a63a00661fe713.v8 = watdiv1052583_s2_4a63a00661fe713.v8)) /* stage4 */, s4_group_2539F852A044A7F6 as  (select * from umbra.identity(table(watdiv1052655_s2_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052583_s3_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_4a63a00661fe713)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_4a63a00661fe713)))select count(*) from umbra.identity(table(s4_group_2539F852A044A7F6));
