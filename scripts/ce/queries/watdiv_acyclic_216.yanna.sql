--\set queryname watdiv_acyclic_216_00
-- Result size: 1690517768670
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052646:s;watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052647:d;watdiv1052647:s -> watdiv1052649:s;watdiv1052649:s -> watdiv1052644:s;watdiv1052644:s -> watdiv1052650:s;}
--                       +---------------+----------------+----+
--                       | watdiv1052646 |        s       |  d |
--                       +---------------+----------------+----+
--                                          |                |
--   +--------------------------------------+                |
--   |                                                       |
--   |                                    +---------------+----+----+
--   |                                    | watdiv1052572 |  s |  d |
--   |                                    +---------------+----+----+
--   |                                                            |
--   |                                                            |
--   |                                                            |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052647 |        s       |  d | -+
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052649 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052644 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052650 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |  +---------------+----------------+----------------+
--   |  | watdiv1052624 |        s       |        d       |
--   |  +---------------+----------------+----------------+
--   |                                      |
--   +---------------------+                |
--                         |                |
--      +---------------+----------------+----------------+
--      | watdiv1052652 |        s       |        d       |
--      +---------------+----------------+----------------+
--with dummy as (select) /* stage1 */, watdiv1052646_s1_1bd3ec80661fe72d as (select watdiv1052646.s as v2,watdiv1052646.d as v4 from watdiv1052646), watdiv1052572_s1_1bd3ec80661fe72d as (select watdiv1052572.s as v4,watdiv1052572.d as v6 from watdiv1052572), watdiv1052647_s1_1bd3ec80661fe72d as (select watdiv1052647.d as v6,watdiv1052647.s as v8 from watdiv1052647), watdiv1052650_s2_1bd3ec80661fe72d as (select watdiv1052650.s as v8 from watdiv1052650), watdiv1052649_s2_1bd3ec80661fe72d as (select watdiv1052649.s as v8 from watdiv1052649), watdiv1052644_s2_1bd3ec80661fe72d as (select watdiv1052644.s as v8 from watdiv1052644), watdiv1052652_s1_1bd3ec80661fe72d as (select watdiv1052652.s as v2,watdiv1052652.d as v0 from watdiv1052652), watdiv1052624_s2_1bd3ec80661fe72d as (select watdiv1052624.d as v0 from watdiv1052624) /* stage2 */, watdiv1052652_s2_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052652_s1_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052624_s2_1bd3ec80661fe72d)) where watdiv1052652_s1_1bd3ec80661fe72d.v0 = watdiv1052624_s2_1bd3ec80661fe72d.v0)), watdiv1052647_s2_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052647_s1_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052644_s2_1bd3ec80661fe72d)) where watdiv1052647_s1_1bd3ec80661fe72d.v8 = watdiv1052644_s2_1bd3ec80661fe72d.v8) AND exists (select from umbra.identity(table(watdiv1052649_s2_1bd3ec80661fe72d)) where watdiv1052647_s1_1bd3ec80661fe72d.v8 = watdiv1052649_s2_1bd3ec80661fe72d.v8) AND exists (select from umbra.identity(table(watdiv1052650_s2_1bd3ec80661fe72d)) where watdiv1052647_s1_1bd3ec80661fe72d.v8 = watdiv1052650_s2_1bd3ec80661fe72d.v8)), watdiv1052572_s2_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052572_s1_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052647_s2_1bd3ec80661fe72d)) where watdiv1052572_s1_1bd3ec80661fe72d.v6 = watdiv1052647_s2_1bd3ec80661fe72d.v6)), watdiv1052646_s2_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052646_s1_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052652_s2_1bd3ec80661fe72d)) where watdiv1052646_s1_1bd3ec80661fe72d.v2 = watdiv1052652_s2_1bd3ec80661fe72d.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_1bd3ec80661fe72d)) where watdiv1052646_s1_1bd3ec80661fe72d.v4 = watdiv1052572_s2_1bd3ec80661fe72d.v4)) /* stage3 */, watdiv1052572_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052572_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052646_s2_1bd3ec80661fe72d)) where watdiv1052572_s2_1bd3ec80661fe72d.v4 = watdiv1052646_s2_1bd3ec80661fe72d.v4)), watdiv1052647_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052647_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052572_s2_1bd3ec80661fe72d)) where watdiv1052647_s2_1bd3ec80661fe72d.v6 = watdiv1052572_s2_1bd3ec80661fe72d.v6)), watdiv1052650_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052650_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052647_s2_1bd3ec80661fe72d)) where watdiv1052650_s2_1bd3ec80661fe72d.v8 = watdiv1052647_s2_1bd3ec80661fe72d.v8)), watdiv1052649_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052649_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052647_s2_1bd3ec80661fe72d)) where watdiv1052649_s2_1bd3ec80661fe72d.v8 = watdiv1052647_s2_1bd3ec80661fe72d.v8)), watdiv1052644_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052644_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052647_s2_1bd3ec80661fe72d)) where watdiv1052644_s2_1bd3ec80661fe72d.v8 = watdiv1052647_s2_1bd3ec80661fe72d.v8)), watdiv1052652_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052652_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052646_s2_1bd3ec80661fe72d)) where watdiv1052652_s2_1bd3ec80661fe72d.v2 = watdiv1052646_s2_1bd3ec80661fe72d.v2)), watdiv1052624_s3_1bd3ec80661fe72d as (select * from umbra.identity(table(watdiv1052624_s2_1bd3ec80661fe72d)) where exists (select from umbra.identity(table(watdiv1052652_s2_1bd3ec80661fe72d)) where watdiv1052624_s2_1bd3ec80661fe72d.v0 = watdiv1052652_s2_1bd3ec80661fe72d.v0)) /* stage4 */, s4_group_ADB01C6984A8B67 as  (select * from umbra.identity(table(watdiv1052646_s2_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_1bd3ec80661fe72d)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_1bd3ec80661fe72d)))select count(*) from umbra.identity(table(s4_group_ADB01C6984A8B67));
--\set queryname watdiv_acyclic_216_01
-- Result size: 67175021788
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052637 [label="watdiv1052637|<s> s|<d> d"]; watdiv1052611 [label="watdiv1052611|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052575 [label="watdiv1052575|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052637:d -> watdiv1052611:d;watdiv1052611:s -> watdiv1052613:s;watdiv1052613:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052575:s;watdiv1052575:s -> watdiv1052574:s;watdiv1052574:s -> watdiv1052573:s;}
--                                     +---------+
--                                     |         |
--                  +---------------+----+----+  |
--                  | watdiv1052572 |  s |  d |  |
--                  +---------------+----+----+  |
--                                          |    |
--                                          |    |
--                                          |    |
-- +---------------+----------------+----+  |    |
-- | watdiv1052578 |        s       |  d | -+    |
-- +---------------+----------------+----+       |
--                    |                          |
--                    |                          |
--                    |                          |
-- +---------------+----------------+----+       |
-- | watdiv1052575 |        s       |  d |       |
-- +---------------+----------------+----+       |
--                    |                          |
--                    |                          |
--                    |                          |
-- +---------------+----------------+----+       |
-- | watdiv1052574 |        s       |  d |       |
-- +---------------+----------------+----+       |
--                    |                          |
--                    |                          |
--                    |                          |
-- +---------------+----------------+----+       |
-- | watdiv1052573 |        s       |  d |       |
-- +---------------+----------------+----+       |
-- +---------------+----------------+----+       |
-- | watdiv1052611 |        s       |  d | ------+----+
-- +---------------+----------------+----+       |    |
--                    |                          |    |
--                    |                          |    |
--                    |                          |    |
-- +---------------+----------------+----+       |    |
-- | watdiv1052613 |        s       |  d | ------+    |
-- +---------------+----------------+----+            |
-- +---------------+----------------+----+            |
-- | watdiv1052637 |        s       |  d | -----------+
-- +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052613_s1_45d4b80661fe72e as (select watdiv1052613.s as v2,watdiv1052613.d as v4 from watdiv1052613), watdiv1052572_s1_45d4b80661fe72e as (select watdiv1052572.d as v6,watdiv1052572.s as v4 from watdiv1052572), watdiv1052578_s1_45d4b80661fe72e as (select watdiv1052578.s as v8,watdiv1052578.d as v6 from watdiv1052578), watdiv1052574_s1_45d4b80661fe72e as (select watdiv1052574.s as v8 from watdiv1052574), watdiv1052575_s2_45d4b80661fe72e as (select watdiv1052575.s as v8 from watdiv1052575), watdiv1052573_s2_45d4b80661fe72e as (select watdiv1052573.s as v8 from watdiv1052573), watdiv1052611_s1_45d4b80661fe72e as (select watdiv1052611.s as v2,watdiv1052611.d as v0 from watdiv1052611), watdiv1052637_s2_45d4b80661fe72e as (select watdiv1052637.d as v0 from watdiv1052637) /* stage2 */, watdiv1052611_s2_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052611_s1_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052637_s2_45d4b80661fe72e)) where watdiv1052611_s1_45d4b80661fe72e.v0 = watdiv1052637_s2_45d4b80661fe72e.v0)), watdiv1052574_s2_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052574_s1_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052573_s2_45d4b80661fe72e)) where watdiv1052574_s1_45d4b80661fe72e.v8 = watdiv1052573_s2_45d4b80661fe72e.v8) AND exists (select from umbra.identity(table(watdiv1052575_s2_45d4b80661fe72e)) where watdiv1052574_s1_45d4b80661fe72e.v8 = watdiv1052575_s2_45d4b80661fe72e.v8)), watdiv1052578_s2_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052578_s1_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052574_s2_45d4b80661fe72e)) where watdiv1052578_s1_45d4b80661fe72e.v8 = watdiv1052574_s2_45d4b80661fe72e.v8)), watdiv1052572_s2_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052572_s1_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_45d4b80661fe72e)) where watdiv1052572_s1_45d4b80661fe72e.v6 = watdiv1052578_s2_45d4b80661fe72e.v6)), watdiv1052613_s2_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052613_s1_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052611_s2_45d4b80661fe72e)) where watdiv1052613_s1_45d4b80661fe72e.v2 = watdiv1052611_s2_45d4b80661fe72e.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_45d4b80661fe72e)) where watdiv1052613_s1_45d4b80661fe72e.v4 = watdiv1052572_s2_45d4b80661fe72e.v4)) /* stage3 */, watdiv1052572_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052572_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052613_s2_45d4b80661fe72e)) where watdiv1052572_s2_45d4b80661fe72e.v4 = watdiv1052613_s2_45d4b80661fe72e.v4)), watdiv1052578_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052578_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052572_s2_45d4b80661fe72e)) where watdiv1052578_s2_45d4b80661fe72e.v6 = watdiv1052572_s2_45d4b80661fe72e.v6)), watdiv1052574_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052574_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_45d4b80661fe72e)) where watdiv1052574_s2_45d4b80661fe72e.v8 = watdiv1052578_s2_45d4b80661fe72e.v8)), watdiv1052575_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052575_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052574_s2_45d4b80661fe72e)) where watdiv1052575_s2_45d4b80661fe72e.v8 = watdiv1052574_s2_45d4b80661fe72e.v8)), watdiv1052573_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052573_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052574_s2_45d4b80661fe72e)) where watdiv1052573_s2_45d4b80661fe72e.v8 = watdiv1052574_s2_45d4b80661fe72e.v8)), watdiv1052611_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052611_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052613_s2_45d4b80661fe72e)) where watdiv1052611_s2_45d4b80661fe72e.v2 = watdiv1052613_s2_45d4b80661fe72e.v2)), watdiv1052637_s3_45d4b80661fe72e as (select * from umbra.identity(table(watdiv1052637_s2_45d4b80661fe72e)) where exists (select from umbra.identity(table(watdiv1052611_s2_45d4b80661fe72e)) where watdiv1052637_s2_45d4b80661fe72e.v0 = watdiv1052611_s2_45d4b80661fe72e.v0)) /* stage4 */, s4_group_14F8637C9BC5436 as  (select * from umbra.identity(table(watdiv1052613_s2_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052611_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052637_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_45d4b80661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052575_s3_45d4b80661fe72e)))select count(*) from umbra.identity(table(s4_group_14F8637C9BC5436));
--\set queryname watdiv_acyclic_216_02
-- Result size: 4441833200152
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052637 [label="watdiv1052637|<s> s|<d> d"]; watdiv1052632 [label="watdiv1052632|<s> s|<d> d"]; watdiv1052627 [label="watdiv1052627|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052584 [label="watdiv1052584|<s> s|<d> d"]; watdiv1052643 [label="watdiv1052643|<s> s|<d> d"]; watdiv1052637:d -> watdiv1052632:d;watdiv1052632:s -> watdiv1052627:s;watdiv1052627:d -> watdiv1052578:s;watdiv1052578:d -> watdiv1052647:d;watdiv1052647:s -> watdiv1052642:s;watdiv1052642:s -> watdiv1052584:s;watdiv1052584:s -> watdiv1052643:s;}
-- +---------------+----------------+----+
-- | watdiv1052637 |        s       |  d |
-- +---------------+----------------+----+
--                                     |
--                                     |
--                                     |
-- +---------------+----------------+----+
-- | watdiv1052632 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052627 |        s       |  d |
-- +---------------+----------------+----+
--                                     |
--                                     |
--                                     |
--                  +---------------+----+----+
--                  | watdiv1052578 |  s |  d |
--                  +---------------+----+----+
--                                          |
--                                          |
--                                          |
-- +---------------+----------------+----+  |
-- | watdiv1052647 |        s       |  d | -+
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052642 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052584 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052643 |        s       |  d |
-- +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052627_s1_cdf5800661fe72e as (select watdiv1052627.d as v4,watdiv1052627.s as v2 from watdiv1052627), watdiv1052578_s1_cdf5800661fe72e as (select watdiv1052578.s as v4,watdiv1052578.d as v6 from watdiv1052578), watdiv1052647_s1_cdf5800661fe72e as (select watdiv1052647.d as v6,watdiv1052647.s as v8 from watdiv1052647), watdiv1052642_s1_cdf5800661fe72e as (select watdiv1052642.s as v8 from watdiv1052642), watdiv1052643_s2_cdf5800661fe72e as (select watdiv1052643.s as v8 from watdiv1052643), watdiv1052584_s2_cdf5800661fe72e as (select watdiv1052584.s as v8 from watdiv1052584), watdiv1052632_s1_cdf5800661fe72e as (select watdiv1052632.s as v2,watdiv1052632.d as v0 from watdiv1052632), watdiv1052637_s2_cdf5800661fe72e as (select watdiv1052637.d as v0 from watdiv1052637) /* stage2 */, watdiv1052632_s2_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052632_s1_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052637_s2_cdf5800661fe72e)) where watdiv1052632_s1_cdf5800661fe72e.v0 = watdiv1052637_s2_cdf5800661fe72e.v0)), watdiv1052642_s2_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052642_s1_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052584_s2_cdf5800661fe72e)) where watdiv1052642_s1_cdf5800661fe72e.v8 = watdiv1052584_s2_cdf5800661fe72e.v8) AND exists (select from umbra.identity(table(watdiv1052643_s2_cdf5800661fe72e)) where watdiv1052642_s1_cdf5800661fe72e.v8 = watdiv1052643_s2_cdf5800661fe72e.v8)), watdiv1052647_s2_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052647_s1_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052642_s2_cdf5800661fe72e)) where watdiv1052647_s1_cdf5800661fe72e.v8 = watdiv1052642_s2_cdf5800661fe72e.v8)), watdiv1052578_s2_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052578_s1_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052647_s2_cdf5800661fe72e)) where watdiv1052578_s1_cdf5800661fe72e.v6 = watdiv1052647_s2_cdf5800661fe72e.v6)), watdiv1052627_s2_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052627_s1_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052632_s2_cdf5800661fe72e)) where watdiv1052627_s1_cdf5800661fe72e.v2 = watdiv1052632_s2_cdf5800661fe72e.v2) AND exists (select from umbra.identity(table(watdiv1052578_s2_cdf5800661fe72e)) where watdiv1052627_s1_cdf5800661fe72e.v4 = watdiv1052578_s2_cdf5800661fe72e.v4)) /* stage3 */, watdiv1052578_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052578_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052627_s2_cdf5800661fe72e)) where watdiv1052578_s2_cdf5800661fe72e.v4 = watdiv1052627_s2_cdf5800661fe72e.v4)), watdiv1052647_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052647_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_cdf5800661fe72e)) where watdiv1052647_s2_cdf5800661fe72e.v6 = watdiv1052578_s2_cdf5800661fe72e.v6)), watdiv1052642_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052642_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052647_s2_cdf5800661fe72e)) where watdiv1052642_s2_cdf5800661fe72e.v8 = watdiv1052647_s2_cdf5800661fe72e.v8)), watdiv1052643_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052643_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052642_s2_cdf5800661fe72e)) where watdiv1052643_s2_cdf5800661fe72e.v8 = watdiv1052642_s2_cdf5800661fe72e.v8)), watdiv1052584_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052584_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052642_s2_cdf5800661fe72e)) where watdiv1052584_s2_cdf5800661fe72e.v8 = watdiv1052642_s2_cdf5800661fe72e.v8)), watdiv1052632_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052632_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052627_s2_cdf5800661fe72e)) where watdiv1052632_s2_cdf5800661fe72e.v2 = watdiv1052627_s2_cdf5800661fe72e.v2)), watdiv1052637_s3_cdf5800661fe72e as (select * from umbra.identity(table(watdiv1052637_s2_cdf5800661fe72e)) where exists (select from umbra.identity(table(watdiv1052632_s2_cdf5800661fe72e)) where watdiv1052637_s2_cdf5800661fe72e.v0 = watdiv1052632_s2_cdf5800661fe72e.v0)) /* stage4 */, s4_group_4E11C777DB76B9C as  (select * from umbra.identity(table(watdiv1052627_s2_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052632_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052637_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052584_s3_cdf5800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052643_s3_cdf5800661fe72e)))select count(*) from umbra.identity(table(s4_group_4E11C777DB76B9C));
--\set queryname watdiv_acyclic_216_03
-- Result size: 232641814407
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052576 [label="watdiv1052576|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052579 [label="watdiv1052579|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052646:s;watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052576:s;watdiv1052576:s -> watdiv1052573:s;watdiv1052573:s -> watdiv1052579:s;}
--                       +---------------+----------------+----+
--                       | watdiv1052646 |        s       |  d |
--                       +---------------+----------------+----+
--                                          |                |
--   +--------------------------------------+                |
--   |                                                       |
--   |                                    +---------------+----+----+
--   |                                    | watdiv1052572 |  s |  d |
--   |                                    +---------------+----+----+
--   |                                                            |
--   |                                                            |
--   |                                                            |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052578 |        s       |  d | -+
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052576 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052573 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052579 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |  +---------------+----------------+----------------+
--   |  | watdiv1052624 |        s       |        d       |
--   |  +---------------+----------------+----------------+
--   |                                      |
--   +---------------------+                |
--                         |                |
--      +---------------+----------------+----------------+
--      | watdiv1052652 |        s       |        d       |
--      +---------------+----------------+----------------+
--with dummy as (select) /* stage1 */, watdiv1052646_s1_154f4b00661fe72e as (select watdiv1052646.d as v4,watdiv1052646.s as v2 from watdiv1052646), watdiv1052572_s1_154f4b00661fe72e as (select watdiv1052572.d as v6,watdiv1052572.s as v4 from watdiv1052572), watdiv1052578_s1_154f4b00661fe72e as (select watdiv1052578.s as v8,watdiv1052578.d as v6 from watdiv1052578), watdiv1052576_s1_154f4b00661fe72e as (select watdiv1052576.s as v8 from watdiv1052576), watdiv1052579_s2_154f4b00661fe72e as (select watdiv1052579.s as v8 from watdiv1052579), watdiv1052573_s2_154f4b00661fe72e as (select watdiv1052573.s as v8 from watdiv1052573), watdiv1052652_s1_154f4b00661fe72e as (select watdiv1052652.d as v0,watdiv1052652.s as v2 from watdiv1052652), watdiv1052624_s2_154f4b00661fe72e as (select watdiv1052624.d as v0 from watdiv1052624) /* stage2 */, watdiv1052652_s2_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052652_s1_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052624_s2_154f4b00661fe72e)) where watdiv1052652_s1_154f4b00661fe72e.v0 = watdiv1052624_s2_154f4b00661fe72e.v0)), watdiv1052576_s2_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052576_s1_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052573_s2_154f4b00661fe72e)) where watdiv1052576_s1_154f4b00661fe72e.v8 = watdiv1052573_s2_154f4b00661fe72e.v8) AND exists (select from umbra.identity(table(watdiv1052579_s2_154f4b00661fe72e)) where watdiv1052576_s1_154f4b00661fe72e.v8 = watdiv1052579_s2_154f4b00661fe72e.v8)), watdiv1052578_s2_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052578_s1_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052576_s2_154f4b00661fe72e)) where watdiv1052578_s1_154f4b00661fe72e.v8 = watdiv1052576_s2_154f4b00661fe72e.v8)), watdiv1052572_s2_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052572_s1_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_154f4b00661fe72e)) where watdiv1052572_s1_154f4b00661fe72e.v6 = watdiv1052578_s2_154f4b00661fe72e.v6)), watdiv1052646_s2_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052646_s1_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052652_s2_154f4b00661fe72e)) where watdiv1052646_s1_154f4b00661fe72e.v2 = watdiv1052652_s2_154f4b00661fe72e.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_154f4b00661fe72e)) where watdiv1052646_s1_154f4b00661fe72e.v4 = watdiv1052572_s2_154f4b00661fe72e.v4)) /* stage3 */, watdiv1052572_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052572_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052646_s2_154f4b00661fe72e)) where watdiv1052572_s2_154f4b00661fe72e.v4 = watdiv1052646_s2_154f4b00661fe72e.v4)), watdiv1052578_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052578_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052572_s2_154f4b00661fe72e)) where watdiv1052578_s2_154f4b00661fe72e.v6 = watdiv1052572_s2_154f4b00661fe72e.v6)), watdiv1052576_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052576_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_154f4b00661fe72e)) where watdiv1052576_s2_154f4b00661fe72e.v8 = watdiv1052578_s2_154f4b00661fe72e.v8)), watdiv1052579_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052579_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052576_s2_154f4b00661fe72e)) where watdiv1052579_s2_154f4b00661fe72e.v8 = watdiv1052576_s2_154f4b00661fe72e.v8)), watdiv1052573_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052573_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052576_s2_154f4b00661fe72e)) where watdiv1052573_s2_154f4b00661fe72e.v8 = watdiv1052576_s2_154f4b00661fe72e.v8)), watdiv1052652_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052652_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052646_s2_154f4b00661fe72e)) where watdiv1052652_s2_154f4b00661fe72e.v2 = watdiv1052646_s2_154f4b00661fe72e.v2)), watdiv1052624_s3_154f4b00661fe72e as (select * from umbra.identity(table(watdiv1052624_s2_154f4b00661fe72e)) where exists (select from umbra.identity(table(watdiv1052652_s2_154f4b00661fe72e)) where watdiv1052624_s2_154f4b00661fe72e.v0 = watdiv1052652_s2_154f4b00661fe72e.v0)) /* stage4 */, s4_group_C1C631A530183EA as  (select * from umbra.identity(table(watdiv1052646_s2_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052576_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_154f4b00661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052579_s3_154f4b00661fe72e)))select count(*) from umbra.identity(table(s4_group_C1C631A530183EA));
\set queryname watdiv_acyclic_216_04
-- Result size: 441046624
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052612 [label="watdiv1052612|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052575 [label="watdiv1052575|<s> s|<d> d"]; watdiv1052577 [label="watdiv1052577|<s> s|<d> d"]; watdiv1052574:d -> watdiv1052612:d;watdiv1052612:s -> watdiv1052613:s;watdiv1052613:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052573:s;watdiv1052573:s -> watdiv1052575:s;watdiv1052575:s -> watdiv1052577:s;}
--                                                      +---------+
--                                                      |         |
--                                   +---------------+----+----+  |
--                                   | watdiv1052572 |  s |  d |  |
--                                   +---------------+----+----+  |
--                                                           |    |
--                                                           |    |
--                                                           |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052578 |        s       |  d | -+    |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052573 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052575 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052577 |        s       |  d |       |
--                  +---------------+----------------+----+       |
-- +---------------+----------------+----------------+            |
-- | watdiv1052574 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
-- +---------------+----------------+----------------+            |
-- | watdiv1052612 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                    |                                           |
--                    |                                           |
--                    |                                           |
-- +---------------+----------------+----------------+            |
-- | watdiv1052613 |        s       |        d       | -----------+
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052613_s1_1dd47800661fe72e as (select watdiv1052613.s as v2,watdiv1052613.d as v4 from watdiv1052613), watdiv1052572_s1_1dd47800661fe72e as (select watdiv1052572.d as v6,watdiv1052572.s as v4 from watdiv1052572), watdiv1052578_s1_1dd47800661fe72e as (select watdiv1052578.d as v6,watdiv1052578.s as v8 from watdiv1052578), watdiv1052575_s1_1dd47800661fe72e as (select watdiv1052575.s as v8 from watdiv1052575), watdiv1052577_s2_1dd47800661fe72e as (select watdiv1052577.s as v8 from watdiv1052577), watdiv1052573_s2_1dd47800661fe72e as (select watdiv1052573.s as v8 from watdiv1052573), watdiv1052612_s1_1dd47800661fe72e as (select watdiv1052612.s as v2,watdiv1052612.d as v0 from watdiv1052612), watdiv1052574_s2_1dd47800661fe72e as (select watdiv1052574.d as v0 from watdiv1052574) /* stage2 */, watdiv1052612_s2_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052612_s1_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052574_s2_1dd47800661fe72e)) where watdiv1052612_s1_1dd47800661fe72e.v0 = watdiv1052574_s2_1dd47800661fe72e.v0)), watdiv1052575_s2_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052575_s1_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052573_s2_1dd47800661fe72e)) where watdiv1052575_s1_1dd47800661fe72e.v8 = watdiv1052573_s2_1dd47800661fe72e.v8) AND exists (select from umbra.identity(table(watdiv1052577_s2_1dd47800661fe72e)) where watdiv1052575_s1_1dd47800661fe72e.v8 = watdiv1052577_s2_1dd47800661fe72e.v8)), watdiv1052578_s2_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052578_s1_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052575_s2_1dd47800661fe72e)) where watdiv1052578_s1_1dd47800661fe72e.v8 = watdiv1052575_s2_1dd47800661fe72e.v8)), watdiv1052572_s2_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052572_s1_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_1dd47800661fe72e)) where watdiv1052572_s1_1dd47800661fe72e.v6 = watdiv1052578_s2_1dd47800661fe72e.v6)), watdiv1052613_s2_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052613_s1_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052612_s2_1dd47800661fe72e)) where watdiv1052613_s1_1dd47800661fe72e.v2 = watdiv1052612_s2_1dd47800661fe72e.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_1dd47800661fe72e)) where watdiv1052613_s1_1dd47800661fe72e.v4 = watdiv1052572_s2_1dd47800661fe72e.v4)) /* stage3 */, watdiv1052572_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052572_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052613_s2_1dd47800661fe72e)) where watdiv1052572_s2_1dd47800661fe72e.v4 = watdiv1052613_s2_1dd47800661fe72e.v4)), watdiv1052578_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052578_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052572_s2_1dd47800661fe72e)) where watdiv1052578_s2_1dd47800661fe72e.v6 = watdiv1052572_s2_1dd47800661fe72e.v6)), watdiv1052575_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052575_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052578_s2_1dd47800661fe72e)) where watdiv1052575_s2_1dd47800661fe72e.v8 = watdiv1052578_s2_1dd47800661fe72e.v8)), watdiv1052577_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052577_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052575_s2_1dd47800661fe72e)) where watdiv1052577_s2_1dd47800661fe72e.v8 = watdiv1052575_s2_1dd47800661fe72e.v8)), watdiv1052573_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052573_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052575_s2_1dd47800661fe72e)) where watdiv1052573_s2_1dd47800661fe72e.v8 = watdiv1052575_s2_1dd47800661fe72e.v8)), watdiv1052612_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052612_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052613_s2_1dd47800661fe72e)) where watdiv1052612_s2_1dd47800661fe72e.v2 = watdiv1052613_s2_1dd47800661fe72e.v2)), watdiv1052574_s3_1dd47800661fe72e as (select * from umbra.identity(table(watdiv1052574_s2_1dd47800661fe72e)) where exists (select from umbra.identity(table(watdiv1052612_s2_1dd47800661fe72e)) where watdiv1052574_s2_1dd47800661fe72e.v0 = watdiv1052612_s2_1dd47800661fe72e.v0)) /* stage4 */, s4_group_4A81CDC321A4FAE0 as  (select * from umbra.identity(table(watdiv1052613_s2_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052612_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052575_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_1dd47800661fe72e)) NATURAL JOIN umbra.identity(table(watdiv1052577_s3_1dd47800661fe72e)))select count(*) from umbra.identity(table(s4_group_4A81CDC321A4FAE0));
\set queryname watdiv_acyclic_216_05
-- Result size: 441046624
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052612 [label="watdiv1052612|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052575 [label="watdiv1052575|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052577 [label="watdiv1052577|<s> s|<d> d"]; watdiv1052574:d -> watdiv1052612:d;watdiv1052612:s -> watdiv1052613:s;watdiv1052613:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052575:s;watdiv1052575:s -> watdiv1052573:s;watdiv1052573:s -> watdiv1052577:s;}
--                                                      +---------+
--                                                      |         |
--                                   +---------------+----+----+  |
--                                   | watdiv1052572 |  s |  d |  |
--                                   +---------------+----+----+  |
--                                                           |    |
--                                                           |    |
--                                                           |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052578 |        s       |  d | -+    |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052575 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052573 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052577 |        s       |  d |       |
--                  +---------------+----------------+----+       |
-- +---------------+----------------+----------------+            |
-- | watdiv1052574 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
-- +---------------+----------------+----------------+            |
-- | watdiv1052612 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                    |                                           |
--                    |                                           |
--                    |                                           |
-- +---------------+----------------+----------------+            |
-- | watdiv1052613 |        s       |        d       | -----------+
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052613_s1_65ea180661fe72f as (select watdiv1052613.d as v4,watdiv1052613.s as v2 from watdiv1052613), watdiv1052572_s1_65ea180661fe72f as (select watdiv1052572.s as v4,watdiv1052572.d as v6 from watdiv1052572), watdiv1052578_s1_65ea180661fe72f as (select watdiv1052578.s as v8,watdiv1052578.d as v6 from watdiv1052578), watdiv1052575_s1_65ea180661fe72f as (select watdiv1052575.s as v8 from watdiv1052575), watdiv1052577_s2_65ea180661fe72f as (select watdiv1052577.s as v8 from watdiv1052577), watdiv1052573_s2_65ea180661fe72f as (select watdiv1052573.s as v8 from watdiv1052573), watdiv1052612_s1_65ea180661fe72f as (select watdiv1052612.s as v2,watdiv1052612.d as v0 from watdiv1052612), watdiv1052574_s2_65ea180661fe72f as (select watdiv1052574.d as v0 from watdiv1052574) /* stage2 */, watdiv1052612_s2_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052612_s1_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052574_s2_65ea180661fe72f)) where watdiv1052612_s1_65ea180661fe72f.v0 = watdiv1052574_s2_65ea180661fe72f.v0)), watdiv1052575_s2_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052575_s1_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052573_s2_65ea180661fe72f)) where watdiv1052575_s1_65ea180661fe72f.v8 = watdiv1052573_s2_65ea180661fe72f.v8) AND exists (select from umbra.identity(table(watdiv1052577_s2_65ea180661fe72f)) where watdiv1052575_s1_65ea180661fe72f.v8 = watdiv1052577_s2_65ea180661fe72f.v8)), watdiv1052578_s2_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052578_s1_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052575_s2_65ea180661fe72f)) where watdiv1052578_s1_65ea180661fe72f.v8 = watdiv1052575_s2_65ea180661fe72f.v8)), watdiv1052572_s2_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052572_s1_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052578_s2_65ea180661fe72f)) where watdiv1052572_s1_65ea180661fe72f.v6 = watdiv1052578_s2_65ea180661fe72f.v6)), watdiv1052613_s2_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052613_s1_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052612_s2_65ea180661fe72f)) where watdiv1052613_s1_65ea180661fe72f.v2 = watdiv1052612_s2_65ea180661fe72f.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_65ea180661fe72f)) where watdiv1052613_s1_65ea180661fe72f.v4 = watdiv1052572_s2_65ea180661fe72f.v4)) /* stage3 */, watdiv1052572_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052572_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052613_s2_65ea180661fe72f)) where watdiv1052572_s2_65ea180661fe72f.v4 = watdiv1052613_s2_65ea180661fe72f.v4)), watdiv1052578_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052578_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052572_s2_65ea180661fe72f)) where watdiv1052578_s2_65ea180661fe72f.v6 = watdiv1052572_s2_65ea180661fe72f.v6)), watdiv1052575_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052575_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052578_s2_65ea180661fe72f)) where watdiv1052575_s2_65ea180661fe72f.v8 = watdiv1052578_s2_65ea180661fe72f.v8)), watdiv1052577_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052577_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052575_s2_65ea180661fe72f)) where watdiv1052577_s2_65ea180661fe72f.v8 = watdiv1052575_s2_65ea180661fe72f.v8)), watdiv1052573_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052573_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052575_s2_65ea180661fe72f)) where watdiv1052573_s2_65ea180661fe72f.v8 = watdiv1052575_s2_65ea180661fe72f.v8)), watdiv1052612_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052612_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052613_s2_65ea180661fe72f)) where watdiv1052612_s2_65ea180661fe72f.v2 = watdiv1052613_s2_65ea180661fe72f.v2)), watdiv1052574_s3_65ea180661fe72f as (select * from umbra.identity(table(watdiv1052574_s2_65ea180661fe72f)) where exists (select from umbra.identity(table(watdiv1052612_s2_65ea180661fe72f)) where watdiv1052574_s2_65ea180661fe72f.v0 = watdiv1052612_s2_65ea180661fe72f.v0)) /* stage4 */, s4_group_71E987757333125C as  (select * from umbra.identity(table(watdiv1052613_s2_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052612_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052575_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_65ea180661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052577_s3_65ea180661fe72f)))select count(*) from umbra.identity(table(s4_group_71E987757333125C));
--\set queryname watdiv_acyclic_216_06
-- Result size: 14596870453
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052643 [label="watdiv1052643|<s> s|<d> d"]; watdiv1052573:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052651:s;watdiv1052651:d -> watdiv1052649:s;watdiv1052649:d -> watdiv1052650:d;watdiv1052650:s -> watdiv1052644:s;watdiv1052644:s -> watdiv1052629:s;watdiv1052629:s -> watdiv1052643:s;}
--                                                                       +---------------+----+----+
--                                                                       | watdiv1052652 |  s |  d |
--                                                                       +---------------+----+----+
--                                                                                          |    |
--   +--------------------------------------------------------------------------------------+    |
--   |                                                                                           |
--   |                                                                   +---------------+----+----+
--   |                                                                   | watdiv1052573 |  s |  d |
--   |                                                                   +---------------+----+----+
--   |
--   |                                               +--------------------------------------+
--   |                                               |                                      |
--   |                   +---------------+----+---+  |  +---------------+----------------+----+
--   |                   | watdiv1052649 |  s | d | -+  | watdiv1052650 |        s       |  d |
--   |                   +---------------+----+---+     +---------------+----------------+----+
--   |                                      |                              |
--   +---------------------+                |                              |
--                         |                |                              |
--      +---------------+----------------+----+         +---------------+----------------+----+
--      | watdiv1052651 |        s       |  d |         | watdiv1052644 |        s       |  d |
--      +---------------+----------------+----+         +---------------+----------------+----+
--                                                                         |
--                                                                         |
--                                                                         |
--                                                      +---------------+----------------+----+
--                                                      | watdiv1052629 |        s       |  d |
--                                                      +---------------+----------------+----+
--                                                                         |
--                                                                         |
--                                                                         |
--                                                      +---------------+----------------+----+
--                                                      | watdiv1052643 |        s       |  d |
--                                                      +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052651_s1_ed6e600661fe72f as (select watdiv1052651.s as v2,watdiv1052651.d as v4 from watdiv1052651), watdiv1052649_s1_ed6e600661fe72f as (select watdiv1052649.d as v6,watdiv1052649.s as v4 from watdiv1052649), watdiv1052650_s1_ed6e600661fe72f as (select watdiv1052650.d as v6,watdiv1052650.s as v8 from watdiv1052650), watdiv1052643_s1_ed6e600661fe72f as (select watdiv1052643.s as v8 from watdiv1052643), watdiv1052644_s2_ed6e600661fe72f as (select watdiv1052644.s as v8 from watdiv1052644), watdiv1052629_s2_ed6e600661fe72f as (select watdiv1052629.s as v8 from watdiv1052629), watdiv1052652_s1_ed6e600661fe72f as (select watdiv1052652.s as v2,watdiv1052652.d as v0 from watdiv1052652), watdiv1052573_s2_ed6e600661fe72f as (select watdiv1052573.d as v0 from watdiv1052573) /* stage2 */, watdiv1052652_s2_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052652_s1_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052573_s2_ed6e600661fe72f)) where watdiv1052652_s1_ed6e600661fe72f.v0 = watdiv1052573_s2_ed6e600661fe72f.v0)), watdiv1052643_s2_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052643_s1_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052629_s2_ed6e600661fe72f)) where watdiv1052643_s1_ed6e600661fe72f.v8 = watdiv1052629_s2_ed6e600661fe72f.v8) AND exists (select from umbra.identity(table(watdiv1052644_s2_ed6e600661fe72f)) where watdiv1052643_s1_ed6e600661fe72f.v8 = watdiv1052644_s2_ed6e600661fe72f.v8)), watdiv1052650_s2_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052650_s1_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052643_s2_ed6e600661fe72f)) where watdiv1052650_s1_ed6e600661fe72f.v8 = watdiv1052643_s2_ed6e600661fe72f.v8)), watdiv1052649_s2_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052649_s1_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052650_s2_ed6e600661fe72f)) where watdiv1052649_s1_ed6e600661fe72f.v6 = watdiv1052650_s2_ed6e600661fe72f.v6)), watdiv1052651_s2_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052651_s1_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052652_s2_ed6e600661fe72f)) where watdiv1052651_s1_ed6e600661fe72f.v2 = watdiv1052652_s2_ed6e600661fe72f.v2) AND exists (select from umbra.identity(table(watdiv1052649_s2_ed6e600661fe72f)) where watdiv1052651_s1_ed6e600661fe72f.v4 = watdiv1052649_s2_ed6e600661fe72f.v4)) /* stage3 */, watdiv1052649_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052649_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052651_s2_ed6e600661fe72f)) where watdiv1052649_s2_ed6e600661fe72f.v4 = watdiv1052651_s2_ed6e600661fe72f.v4)), watdiv1052650_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052650_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052649_s2_ed6e600661fe72f)) where watdiv1052650_s2_ed6e600661fe72f.v6 = watdiv1052649_s2_ed6e600661fe72f.v6)), watdiv1052643_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052643_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052650_s2_ed6e600661fe72f)) where watdiv1052643_s2_ed6e600661fe72f.v8 = watdiv1052650_s2_ed6e600661fe72f.v8)), watdiv1052644_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052644_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052643_s2_ed6e600661fe72f)) where watdiv1052644_s2_ed6e600661fe72f.v8 = watdiv1052643_s2_ed6e600661fe72f.v8)), watdiv1052629_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052629_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052643_s2_ed6e600661fe72f)) where watdiv1052629_s2_ed6e600661fe72f.v8 = watdiv1052643_s2_ed6e600661fe72f.v8)), watdiv1052652_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052652_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052651_s2_ed6e600661fe72f)) where watdiv1052652_s2_ed6e600661fe72f.v2 = watdiv1052651_s2_ed6e600661fe72f.v2)), watdiv1052573_s3_ed6e600661fe72f as (select * from umbra.identity(table(watdiv1052573_s2_ed6e600661fe72f)) where exists (select from umbra.identity(table(watdiv1052652_s2_ed6e600661fe72f)) where watdiv1052573_s2_ed6e600661fe72f.v0 = watdiv1052652_s2_ed6e600661fe72f.v0)) /* stage4 */, s4_group_610ACD660F47DE82 as  (select * from umbra.identity(table(watdiv1052651_s2_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052643_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_ed6e600661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_ed6e600661fe72f)))select count(*) from umbra.identity(table(s4_group_610ACD660F47DE82));
\set queryname watdiv_acyclic_216_07
-- Result size: 430101966
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052642 [label="watdiv1052642|<s> s|<d> d"]; watdiv1052656 [label="watdiv1052656|<s> s|<d> d"]; watdiv1052588 [label="watdiv1052588|<s> s|<d> d"]; watdiv1052583 [label="watdiv1052583|<s> s|<d> d"]; watdiv1052587 [label="watdiv1052587|<s> s|<d> d"]; watdiv1052581 [label="watdiv1052581|<s> s|<d> d"]; watdiv1052651:d -> watdiv1052644:d;watdiv1052644:s -> watdiv1052642:s;watdiv1052642:d -> watdiv1052656:s;watdiv1052656:d -> watdiv1052588:d;watdiv1052588:s -> watdiv1052583:s;watdiv1052583:s -> watdiv1052587:s;watdiv1052587:s -> watdiv1052581:s;}
--                                   +---------------+----+----+
--                                   | watdiv1052581 |  s |  d |
--                                   +---------------+----+----+
--                                                      |
--                                                      +----+
--                                                           |
--                  +---------------+----------------+----+  |
--                  | watdiv1052588 |        s       |  d |  |
--                  +---------------+----------------+----+  |
--                                     |                |    |
--                                     |                +----+----+
--                                     |                     |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052583 |        s       |  d |  |    |
--                  +---------------+----------------+----+  |    |
--                                     |                     |    |
--                                     |                     |    |
--                                     |                     |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052587 |        s       |  d |  |    |
--                  +---------------+----------------+----+  |    |
--                                     |                     |    |
--                                     +---------------------+    |
--                                                                |
--                                                                |
--                                                      +---------+
--                                                      |
-- +---------------+----------------+----------------+  |
-- | watdiv1052642 |        s       |        d       |  |
-- +---------------+----------------+----------------+  |
--                    |                |                |
--   +----------------+                |                |
--   |                                 |                |
--   |              +---------------+----------------+----+
--   |              | watdiv1052656 |        s       |  d |
--   |              +---------------+----------------+----+
--   |
--   +----------------+
--                    |
-- +---------------+----------------+----------------+
-- | watdiv1052644 |        s       |        d       |
-- +---------------+----------------+----------------+
--                                     |
--                                     |
--                                     |
-- +---------------+----------------+----------------+
-- | watdiv1052651 |        s       |        d       |
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052656_s1_1758f280661fe72f as (select watdiv1052656.d as v6,watdiv1052656.s as v4 from watdiv1052656), watdiv1052642_s1_1758f280661fe72f as (select watdiv1052642.s as v2,watdiv1052642.d as v4 from watdiv1052642), watdiv1052644_s1_1758f280661fe72f as (select watdiv1052644.s as v2,watdiv1052644.d as v0 from watdiv1052644), watdiv1052651_s2_1758f280661fe72f as (select watdiv1052651.d as v0 from watdiv1052651), watdiv1052588_s1_1758f280661fe72f as (select watdiv1052588.s as v8,watdiv1052588.d as v6 from watdiv1052588), watdiv1052583_s1_1758f280661fe72f as (select watdiv1052583.s as v8 from watdiv1052583), watdiv1052587_s2_1758f280661fe72f as (select watdiv1052587.s as v8 from watdiv1052587), watdiv1052581_s2_1758f280661fe72f as (select watdiv1052581.s as v8 from watdiv1052581) /* stage2 */, watdiv1052583_s2_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052583_s1_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052581_s2_1758f280661fe72f)) where watdiv1052583_s1_1758f280661fe72f.v8 = watdiv1052581_s2_1758f280661fe72f.v8) AND exists (select from umbra.identity(table(watdiv1052587_s2_1758f280661fe72f)) where watdiv1052583_s1_1758f280661fe72f.v8 = watdiv1052587_s2_1758f280661fe72f.v8)), watdiv1052588_s2_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052588_s1_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052583_s2_1758f280661fe72f)) where watdiv1052588_s1_1758f280661fe72f.v8 = watdiv1052583_s2_1758f280661fe72f.v8)), watdiv1052644_s2_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052644_s1_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052651_s2_1758f280661fe72f)) where watdiv1052644_s1_1758f280661fe72f.v0 = watdiv1052651_s2_1758f280661fe72f.v0)), watdiv1052642_s2_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052642_s1_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052644_s2_1758f280661fe72f)) where watdiv1052642_s1_1758f280661fe72f.v2 = watdiv1052644_s2_1758f280661fe72f.v2)), watdiv1052656_s2_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052656_s1_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052588_s2_1758f280661fe72f)) where watdiv1052656_s1_1758f280661fe72f.v6 = watdiv1052588_s2_1758f280661fe72f.v6) AND exists (select from umbra.identity(table(watdiv1052642_s2_1758f280661fe72f)) where watdiv1052656_s1_1758f280661fe72f.v4 = watdiv1052642_s2_1758f280661fe72f.v4)) /* stage3 */, watdiv1052642_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052642_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052656_s2_1758f280661fe72f)) where watdiv1052642_s2_1758f280661fe72f.v4 = watdiv1052656_s2_1758f280661fe72f.v4)), watdiv1052644_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052644_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052642_s2_1758f280661fe72f)) where watdiv1052644_s2_1758f280661fe72f.v2 = watdiv1052642_s2_1758f280661fe72f.v2)), watdiv1052651_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052651_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052644_s2_1758f280661fe72f)) where watdiv1052651_s2_1758f280661fe72f.v0 = watdiv1052644_s2_1758f280661fe72f.v0)), watdiv1052588_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052588_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052656_s2_1758f280661fe72f)) where watdiv1052588_s2_1758f280661fe72f.v6 = watdiv1052656_s2_1758f280661fe72f.v6)), watdiv1052583_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052583_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052588_s2_1758f280661fe72f)) where watdiv1052583_s2_1758f280661fe72f.v8 = watdiv1052588_s2_1758f280661fe72f.v8)), watdiv1052587_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052587_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052583_s2_1758f280661fe72f)) where watdiv1052587_s2_1758f280661fe72f.v8 = watdiv1052583_s2_1758f280661fe72f.v8)), watdiv1052581_s3_1758f280661fe72f as (select * from umbra.identity(table(watdiv1052581_s2_1758f280661fe72f)) where exists (select from umbra.identity(table(watdiv1052583_s2_1758f280661fe72f)) where watdiv1052581_s2_1758f280661fe72f.v8 = watdiv1052583_s2_1758f280661fe72f.v8)) /* stage4 */, s4_group_2C4DE0B8C35602CF as  (select * from umbra.identity(table(watdiv1052656_s2_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052588_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052583_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052581_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052587_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052642_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_1758f280661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_1758f280661fe72f)))select count(*) from umbra.identity(table(s4_group_2C4DE0B8C35602CF));
\set queryname watdiv_acyclic_216_08
-- Result size: 878434
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052592 [label="watdiv1052592|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052591 [label="watdiv1052591|<s> s|<d> d"]; watdiv1052615 [label="watdiv1052615|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052574:s;watdiv1052574:d -> watdiv1052592:d;watdiv1052592:s -> watdiv1052586:s;watdiv1052586:s -> watdiv1052591:s;watdiv1052591:s -> watdiv1052615:s;}
--                                                      +---------+
--                                                      |         |
--                                   +---------------+----+----+  |
--                                   | watdiv1052574 |  s |  d |  |
--                                   +---------------+----+----+  |
--                                                           |    |
--                                                           |    |
--                                                           |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052592 |        s       |  d | -+    |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052586 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052591 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052615 |        s       |  d |       |
--                  +---------------+----------------+----+       |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
-- +---------------+----------------+----------------+            |
-- | watdiv1052651 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                    |                                           |
--                    |                                           |
--                    |                                           |
-- +---------------+----------------+----------------+            |
-- | watdiv1052655 |        s       |        d       | -----------+
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052655_s1_1feeca00661fe72f as (select watdiv1052655.d as v4,watdiv1052655.s as v2 from watdiv1052655), watdiv1052574_s1_1feeca00661fe72f as (select watdiv1052574.d as v6,watdiv1052574.s as v4 from watdiv1052574), watdiv1052592_s1_1feeca00661fe72f as (select watdiv1052592.d as v6,watdiv1052592.s as v8 from watdiv1052592), watdiv1052591_s1_1feeca00661fe72f as (select watdiv1052591.s as v8 from watdiv1052591), watdiv1052615_s2_1feeca00661fe72f as (select watdiv1052615.s as v8 from watdiv1052615), watdiv1052586_s2_1feeca00661fe72f as (select watdiv1052586.s as v8 from watdiv1052586), watdiv1052651_s1_1feeca00661fe72f as (select watdiv1052651.d as v0,watdiv1052651.s as v2 from watdiv1052651), watdiv1052638_s2_1feeca00661fe72f as (select watdiv1052638.d as v0 from watdiv1052638) /* stage2 */, watdiv1052651_s2_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052651_s1_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052638_s2_1feeca00661fe72f)) where watdiv1052651_s1_1feeca00661fe72f.v0 = watdiv1052638_s2_1feeca00661fe72f.v0)), watdiv1052591_s2_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052591_s1_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052586_s2_1feeca00661fe72f)) where watdiv1052591_s1_1feeca00661fe72f.v8 = watdiv1052586_s2_1feeca00661fe72f.v8) AND exists (select from umbra.identity(table(watdiv1052615_s2_1feeca00661fe72f)) where watdiv1052591_s1_1feeca00661fe72f.v8 = watdiv1052615_s2_1feeca00661fe72f.v8)), watdiv1052592_s2_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052592_s1_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052591_s2_1feeca00661fe72f)) where watdiv1052592_s1_1feeca00661fe72f.v8 = watdiv1052591_s2_1feeca00661fe72f.v8)), watdiv1052574_s2_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052574_s1_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052592_s2_1feeca00661fe72f)) where watdiv1052574_s1_1feeca00661fe72f.v6 = watdiv1052592_s2_1feeca00661fe72f.v6)), watdiv1052655_s2_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052655_s1_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052651_s2_1feeca00661fe72f)) where watdiv1052655_s1_1feeca00661fe72f.v2 = watdiv1052651_s2_1feeca00661fe72f.v2) AND exists (select from umbra.identity(table(watdiv1052574_s2_1feeca00661fe72f)) where watdiv1052655_s1_1feeca00661fe72f.v4 = watdiv1052574_s2_1feeca00661fe72f.v4)) /* stage3 */, watdiv1052574_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052574_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052655_s2_1feeca00661fe72f)) where watdiv1052574_s2_1feeca00661fe72f.v4 = watdiv1052655_s2_1feeca00661fe72f.v4)), watdiv1052592_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052592_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052574_s2_1feeca00661fe72f)) where watdiv1052592_s2_1feeca00661fe72f.v6 = watdiv1052574_s2_1feeca00661fe72f.v6)), watdiv1052591_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052591_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052592_s2_1feeca00661fe72f)) where watdiv1052591_s2_1feeca00661fe72f.v8 = watdiv1052592_s2_1feeca00661fe72f.v8)), watdiv1052615_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052615_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052591_s2_1feeca00661fe72f)) where watdiv1052615_s2_1feeca00661fe72f.v8 = watdiv1052591_s2_1feeca00661fe72f.v8)), watdiv1052586_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052586_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052591_s2_1feeca00661fe72f)) where watdiv1052586_s2_1feeca00661fe72f.v8 = watdiv1052591_s2_1feeca00661fe72f.v8)), watdiv1052651_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052651_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052655_s2_1feeca00661fe72f)) where watdiv1052651_s2_1feeca00661fe72f.v2 = watdiv1052655_s2_1feeca00661fe72f.v2)), watdiv1052638_s3_1feeca00661fe72f as (select * from umbra.identity(table(watdiv1052638_s2_1feeca00661fe72f)) where exists (select from umbra.identity(table(watdiv1052651_s2_1feeca00661fe72f)) where watdiv1052638_s2_1feeca00661fe72f.v0 = watdiv1052651_s2_1feeca00661fe72f.v0)) /* stage4 */, s4_group_1B1A8156779D2347 as  (select * from umbra.identity(table(watdiv1052655_s2_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052592_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052591_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_1feeca00661fe72f)) NATURAL JOIN umbra.identity(table(watdiv1052615_s3_1feeca00661fe72f)))select count(*) from umbra.identity(table(s4_group_1B1A8156779D2347));
\set queryname watdiv_acyclic_216_09
-- Result size: 36819133
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052593 [label="watdiv1052593|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052643 [label="watdiv1052643|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052593:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052624:s;watdiv1052624:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052643:s;watdiv1052643:s -> watdiv1052649:s;watdiv1052649:s -> watdiv1052629:s;}
--                    +----------------------------------------------------+
--                    |                                                    |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052655 |  s |  d |
--                    |                            +---------------+----+----+
--                    |                                               |
--                    |                                               |
--                    |                                               |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052651 |  s |  d |
--                    |                            +---------------+----+----+
--                    |                                                    |
--                    |                                                    |
--                    |                                                    |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052593 |  s |  d |
--                    |                            +---------------+----+----+
--                    |
--                    |        +--------------------------------------+
--                    |        |                                      |
-- +---------------+----+---+  |  +---------------+----------------+----+
-- | watdiv1052624 |  s | d | -+  | watdiv1052652 |        s       |  d |
-- +---------------+----+---+     +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052643 |        s       |  d |
--                                +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052649 |        s       |  d |
--                                +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052629 |        s       |  d |
--                                +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052655_s1_890b480661fe730 as (select watdiv1052655.d as v4,watdiv1052655.s as v2 from watdiv1052655), watdiv1052624_s1_890b480661fe730 as (select watdiv1052624.s as v4,watdiv1052624.d as v6 from watdiv1052624), watdiv1052652_s1_890b480661fe730 as (select watdiv1052652.s as v8,watdiv1052652.d as v6 from watdiv1052652), watdiv1052643_s1_890b480661fe730 as (select watdiv1052643.s as v8 from watdiv1052643), watdiv1052649_s2_890b480661fe730 as (select watdiv1052649.s as v8 from watdiv1052649), watdiv1052629_s2_890b480661fe730 as (select watdiv1052629.s as v8 from watdiv1052629), watdiv1052651_s1_890b480661fe730 as (select watdiv1052651.d as v0,watdiv1052651.s as v2 from watdiv1052651), watdiv1052593_s2_890b480661fe730 as (select watdiv1052593.d as v0 from watdiv1052593) /* stage2 */, watdiv1052651_s2_890b480661fe730 as (select * from umbra.identity(table(watdiv1052651_s1_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052593_s2_890b480661fe730)) where watdiv1052651_s1_890b480661fe730.v0 = watdiv1052593_s2_890b480661fe730.v0)), watdiv1052643_s2_890b480661fe730 as (select * from umbra.identity(table(watdiv1052643_s1_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052629_s2_890b480661fe730)) where watdiv1052643_s1_890b480661fe730.v8 = watdiv1052629_s2_890b480661fe730.v8) AND exists (select from umbra.identity(table(watdiv1052649_s2_890b480661fe730)) where watdiv1052643_s1_890b480661fe730.v8 = watdiv1052649_s2_890b480661fe730.v8)), watdiv1052652_s2_890b480661fe730 as (select * from umbra.identity(table(watdiv1052652_s1_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_890b480661fe730)) where watdiv1052652_s1_890b480661fe730.v8 = watdiv1052643_s2_890b480661fe730.v8)), watdiv1052624_s2_890b480661fe730 as (select * from umbra.identity(table(watdiv1052624_s1_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052652_s2_890b480661fe730)) where watdiv1052624_s1_890b480661fe730.v6 = watdiv1052652_s2_890b480661fe730.v6)), watdiv1052655_s2_890b480661fe730 as (select * from umbra.identity(table(watdiv1052655_s1_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_890b480661fe730)) where watdiv1052655_s1_890b480661fe730.v2 = watdiv1052651_s2_890b480661fe730.v2) AND exists (select from umbra.identity(table(watdiv1052624_s2_890b480661fe730)) where watdiv1052655_s1_890b480661fe730.v4 = watdiv1052624_s2_890b480661fe730.v4)) /* stage3 */, watdiv1052624_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052624_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052655_s2_890b480661fe730)) where watdiv1052624_s2_890b480661fe730.v4 = watdiv1052655_s2_890b480661fe730.v4)), watdiv1052652_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052652_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052624_s2_890b480661fe730)) where watdiv1052652_s2_890b480661fe730.v6 = watdiv1052624_s2_890b480661fe730.v6)), watdiv1052643_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052643_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052652_s2_890b480661fe730)) where watdiv1052643_s2_890b480661fe730.v8 = watdiv1052652_s2_890b480661fe730.v8)), watdiv1052649_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052649_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_890b480661fe730)) where watdiv1052649_s2_890b480661fe730.v8 = watdiv1052643_s2_890b480661fe730.v8)), watdiv1052629_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052629_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_890b480661fe730)) where watdiv1052629_s2_890b480661fe730.v8 = watdiv1052643_s2_890b480661fe730.v8)), watdiv1052651_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052651_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052655_s2_890b480661fe730)) where watdiv1052651_s2_890b480661fe730.v2 = watdiv1052655_s2_890b480661fe730.v2)), watdiv1052593_s3_890b480661fe730 as (select * from umbra.identity(table(watdiv1052593_s2_890b480661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_890b480661fe730)) where watdiv1052593_s2_890b480661fe730.v0 = watdiv1052651_s2_890b480661fe730.v0)) /* stage4 */, s4_group_316B05F7379DAC3F as  (select * from umbra.identity(table(watdiv1052655_s2_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052593_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052643_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_890b480661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052649_s3_890b480661fe730)))select count(*) from umbra.identity(table(s4_group_316B05F7379DAC3F));
\set queryname watdiv_acyclic_216_10
-- Result size: 170447782
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052637 [label="watdiv1052637|<s> s|<d> d"]; watdiv1052592 [label="watdiv1052592|<s> s|<d> d"]; watdiv1052591 [label="watdiv1052591|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052643 [label="watdiv1052643|<s> s|<d> d"]; watdiv1052645 [label="watdiv1052645|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052637:d -> watdiv1052592:d;watdiv1052592:s -> watdiv1052591:s;watdiv1052591:d -> watdiv1052651:s;watdiv1052651:d -> watdiv1052644:d;watdiv1052644:s -> watdiv1052643:s;watdiv1052643:s -> watdiv1052645:s;watdiv1052645:s -> watdiv1052629:s;}
--                  +---------------+----+----+
--                  | watdiv1052637 |  s |  d |
--                  +---------------+----+----+
--                                          |
--                                          |
--                                          |
--                  +---------------+----+----+
--                  | watdiv1052592 |  s |  d |
--                  +---------------+----+----+
--                                     |
--                                     |
--                                     |
--                  +---------------+----+----+---------------+----+----+
--                  | watdiv1052591 |  s |  d | watdiv1052651 |  s |  d |
--                  +---------------+----+----+---------------+----+----+
--                                          |                    |    |
--                                          +--------------------+    |
--                                                                    |
-- +---------------+----------------+----+                            |
-- | watdiv1052644 |        s       |  d | ---------------------------+
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052643 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052645 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052629 |        s       |  d |
-- +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052651_s1_10fb2c80661fe730 as (select watdiv1052651.d as v6,watdiv1052651.s as v4 from watdiv1052651), watdiv1052591_s1_10fb2c80661fe730 as (select watdiv1052591.d as v4,watdiv1052591.s as v2 from watdiv1052591), watdiv1052592_s1_10fb2c80661fe730 as (select watdiv1052592.s as v2,watdiv1052592.d as v0 from watdiv1052592), watdiv1052637_s2_10fb2c80661fe730 as (select watdiv1052637.d as v0 from watdiv1052637), watdiv1052644_s1_10fb2c80661fe730 as (select watdiv1052644.d as v6,watdiv1052644.s as v8 from watdiv1052644), watdiv1052643_s1_10fb2c80661fe730 as (select watdiv1052643.s as v8 from watdiv1052643), watdiv1052645_s2_10fb2c80661fe730 as (select watdiv1052645.s as v8 from watdiv1052645), watdiv1052629_s2_10fb2c80661fe730 as (select watdiv1052629.s as v8 from watdiv1052629) /* stage2 */, watdiv1052643_s2_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052643_s1_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052629_s2_10fb2c80661fe730)) where watdiv1052643_s1_10fb2c80661fe730.v8 = watdiv1052629_s2_10fb2c80661fe730.v8) AND exists (select from umbra.identity(table(watdiv1052645_s2_10fb2c80661fe730)) where watdiv1052643_s1_10fb2c80661fe730.v8 = watdiv1052645_s2_10fb2c80661fe730.v8)), watdiv1052644_s2_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052644_s1_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_10fb2c80661fe730)) where watdiv1052644_s1_10fb2c80661fe730.v8 = watdiv1052643_s2_10fb2c80661fe730.v8)), watdiv1052592_s2_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052592_s1_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052637_s2_10fb2c80661fe730)) where watdiv1052592_s1_10fb2c80661fe730.v0 = watdiv1052637_s2_10fb2c80661fe730.v0)), watdiv1052591_s2_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052591_s1_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052592_s2_10fb2c80661fe730)) where watdiv1052591_s1_10fb2c80661fe730.v2 = watdiv1052592_s2_10fb2c80661fe730.v2)), watdiv1052651_s2_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052651_s1_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052644_s2_10fb2c80661fe730)) where watdiv1052651_s1_10fb2c80661fe730.v6 = watdiv1052644_s2_10fb2c80661fe730.v6) AND exists (select from umbra.identity(table(watdiv1052591_s2_10fb2c80661fe730)) where watdiv1052651_s1_10fb2c80661fe730.v4 = watdiv1052591_s2_10fb2c80661fe730.v4)) /* stage3 */, watdiv1052591_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052591_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_10fb2c80661fe730)) where watdiv1052591_s2_10fb2c80661fe730.v4 = watdiv1052651_s2_10fb2c80661fe730.v4)), watdiv1052592_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052592_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052591_s2_10fb2c80661fe730)) where watdiv1052592_s2_10fb2c80661fe730.v2 = watdiv1052591_s2_10fb2c80661fe730.v2)), watdiv1052637_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052637_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052592_s2_10fb2c80661fe730)) where watdiv1052637_s2_10fb2c80661fe730.v0 = watdiv1052592_s2_10fb2c80661fe730.v0)), watdiv1052644_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052644_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_10fb2c80661fe730)) where watdiv1052644_s2_10fb2c80661fe730.v6 = watdiv1052651_s2_10fb2c80661fe730.v6)), watdiv1052643_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052643_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052644_s2_10fb2c80661fe730)) where watdiv1052643_s2_10fb2c80661fe730.v8 = watdiv1052644_s2_10fb2c80661fe730.v8)), watdiv1052645_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052645_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_10fb2c80661fe730)) where watdiv1052645_s2_10fb2c80661fe730.v8 = watdiv1052643_s2_10fb2c80661fe730.v8)), watdiv1052629_s3_10fb2c80661fe730 as (select * from umbra.identity(table(watdiv1052629_s2_10fb2c80661fe730)) where exists (select from umbra.identity(table(watdiv1052643_s2_10fb2c80661fe730)) where watdiv1052629_s2_10fb2c80661fe730.v8 = watdiv1052643_s2_10fb2c80661fe730.v8)) /* stage4 */, s4_group_310DBDF3E2661E18 as  (select * from umbra.identity(table(watdiv1052651_s2_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052643_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052645_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052591_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052592_s3_10fb2c80661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052637_s3_10fb2c80661fe730)))select count(*) from umbra.identity(table(s4_group_310DBDF3E2661E18));
--\set queryname watdiv_acyclic_216_11
-- Result size: 15351304032
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052575 [label="watdiv1052575|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052579 [label="watdiv1052579|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052646:s;watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052578:d;watdiv1052578:s -> watdiv1052575:s;watdiv1052575:s -> watdiv1052574:s;watdiv1052574:s -> watdiv1052579:s;}
--                       +---------------+----------------+----+
--                       | watdiv1052646 |        s       |  d |
--                       +---------------+----------------+----+
--                                          |                |
--   +--------------------------------------+                |
--   |                                                       |
--   |                                    +---------------+----+----+
--   |                                    | watdiv1052572 |  s |  d |
--   |                                    +---------------+----+----+
--   |                                                            |
--   |                                                            |
--   |                                                            |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052578 |        s       |  d | -+
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052575 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052574 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |                                      |
--   |                                      |
--   |                                      |
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052579 |        s       |  d |
--   |                   +---------------+----------------+----+
--   |  +---------------+----------------+----------------+
--   |  | watdiv1052638 |        s       |        d       |
--   |  +---------------+----------------+----------------+
--   |                                      |
--   +---------------------+                |
--                         |                |
--      +---------------+----------------+----------------+
--      | watdiv1052651 |        s       |        d       |
--      +---------------+----------------+----------------+
--with dummy as (select) /* stage1 */, watdiv1052646_s1_19545080661fe730 as (select watdiv1052646.d as v4,watdiv1052646.s as v2 from watdiv1052646), watdiv1052572_s1_19545080661fe730 as (select watdiv1052572.s as v4,watdiv1052572.d as v6 from watdiv1052572), watdiv1052578_s1_19545080661fe730 as (select watdiv1052578.s as v8,watdiv1052578.d as v6 from watdiv1052578), watdiv1052575_s1_19545080661fe730 as (select watdiv1052575.s as v8 from watdiv1052575), watdiv1052579_s2_19545080661fe730 as (select watdiv1052579.s as v8 from watdiv1052579), watdiv1052574_s2_19545080661fe730 as (select watdiv1052574.s as v8 from watdiv1052574), watdiv1052651_s1_19545080661fe730 as (select watdiv1052651.d as v0,watdiv1052651.s as v2 from watdiv1052651), watdiv1052638_s2_19545080661fe730 as (select watdiv1052638.d as v0 from watdiv1052638) /* stage2 */, watdiv1052651_s2_19545080661fe730 as (select * from umbra.identity(table(watdiv1052651_s1_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052638_s2_19545080661fe730)) where watdiv1052651_s1_19545080661fe730.v0 = watdiv1052638_s2_19545080661fe730.v0)), watdiv1052575_s2_19545080661fe730 as (select * from umbra.identity(table(watdiv1052575_s1_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052574_s2_19545080661fe730)) where watdiv1052575_s1_19545080661fe730.v8 = watdiv1052574_s2_19545080661fe730.v8) AND exists (select from umbra.identity(table(watdiv1052579_s2_19545080661fe730)) where watdiv1052575_s1_19545080661fe730.v8 = watdiv1052579_s2_19545080661fe730.v8)), watdiv1052578_s2_19545080661fe730 as (select * from umbra.identity(table(watdiv1052578_s1_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052575_s2_19545080661fe730)) where watdiv1052578_s1_19545080661fe730.v8 = watdiv1052575_s2_19545080661fe730.v8)), watdiv1052572_s2_19545080661fe730 as (select * from umbra.identity(table(watdiv1052572_s1_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052578_s2_19545080661fe730)) where watdiv1052572_s1_19545080661fe730.v6 = watdiv1052578_s2_19545080661fe730.v6)), watdiv1052646_s2_19545080661fe730 as (select * from umbra.identity(table(watdiv1052646_s1_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_19545080661fe730)) where watdiv1052646_s1_19545080661fe730.v2 = watdiv1052651_s2_19545080661fe730.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_19545080661fe730)) where watdiv1052646_s1_19545080661fe730.v4 = watdiv1052572_s2_19545080661fe730.v4)) /* stage3 */, watdiv1052572_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052572_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052646_s2_19545080661fe730)) where watdiv1052572_s2_19545080661fe730.v4 = watdiv1052646_s2_19545080661fe730.v4)), watdiv1052578_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052578_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052572_s2_19545080661fe730)) where watdiv1052578_s2_19545080661fe730.v6 = watdiv1052572_s2_19545080661fe730.v6)), watdiv1052575_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052575_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052578_s2_19545080661fe730)) where watdiv1052575_s2_19545080661fe730.v8 = watdiv1052578_s2_19545080661fe730.v8)), watdiv1052579_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052579_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052575_s2_19545080661fe730)) where watdiv1052579_s2_19545080661fe730.v8 = watdiv1052575_s2_19545080661fe730.v8)), watdiv1052574_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052574_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052575_s2_19545080661fe730)) where watdiv1052574_s2_19545080661fe730.v8 = watdiv1052575_s2_19545080661fe730.v8)), watdiv1052651_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052651_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052646_s2_19545080661fe730)) where watdiv1052651_s2_19545080661fe730.v2 = watdiv1052646_s2_19545080661fe730.v2)), watdiv1052638_s3_19545080661fe730 as (select * from umbra.identity(table(watdiv1052638_s2_19545080661fe730)) where exists (select from umbra.identity(table(watdiv1052651_s2_19545080661fe730)) where watdiv1052638_s2_19545080661fe730.v0 = watdiv1052651_s2_19545080661fe730.v0)) /* stage4 */, s4_group_47DF899845E1C353 as  (select * from umbra.identity(table(watdiv1052646_s2_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052575_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_19545080661fe730)) NATURAL JOIN umbra.identity(table(watdiv1052579_s3_19545080661fe730)))select count(*) from umbra.identity(table(s4_group_47DF899845E1C353));
--\set queryname watdiv_acyclic_216_12
-- Result size: 1157197798
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052638 [label="watdiv1052638|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052572 [label="watdiv1052572|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052645 [label="watdiv1052645|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052638:d -> watdiv1052644:d;watdiv1052644:s -> watdiv1052646:s;watdiv1052646:d -> watdiv1052572:s;watdiv1052572:d -> watdiv1052647:d;watdiv1052647:s -> watdiv1052629:s;watdiv1052629:s -> watdiv1052645:s;watdiv1052645:s -> watdiv1052652:s;}
--                                                      +---------+
--                                                      |         |
--                                   +---------------+----+----+  |
--                                   | watdiv1052572 |  s |  d |  |
--                                   +---------------+----+----+  |
--                                                           |    |
--                                                           |    |
--                                                           |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052647 |        s       |  d | -+    |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052629 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052645 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052652 |        s       |  d |       |
--                  +---------------+----------------+----+       |
-- +---------------+----------------+----------------+            |
-- | watdiv1052638 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
-- +---------------+----------------+----------------+            |
-- | watdiv1052644 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                    |                                           |
--                    |                                           |
--                    |                                           |
-- +---------------+----------------+----------------+            |
-- | watdiv1052646 |        s       |        d       | -----------+
-- +---------------+----------------+----------------+
--with dummy as (select) /* stage1 */, watdiv1052646_s1_1b8e300661fe731 as (select watdiv1052646.d as v4,watdiv1052646.s as v2 from watdiv1052646), watdiv1052572_s1_1b8e300661fe731 as (select watdiv1052572.d as v6,watdiv1052572.s as v4 from watdiv1052572), watdiv1052647_s1_1b8e300661fe731 as (select watdiv1052647.d as v6,watdiv1052647.s as v8 from watdiv1052647), watdiv1052645_s1_1b8e300661fe731 as (select watdiv1052645.s as v8 from watdiv1052645), watdiv1052652_s2_1b8e300661fe731 as (select watdiv1052652.s as v8 from watdiv1052652), watdiv1052629_s2_1b8e300661fe731 as (select watdiv1052629.s as v8 from watdiv1052629), watdiv1052644_s1_1b8e300661fe731 as (select watdiv1052644.d as v0,watdiv1052644.s as v2 from watdiv1052644), watdiv1052638_s2_1b8e300661fe731 as (select watdiv1052638.d as v0 from watdiv1052638) /* stage2 */, watdiv1052644_s2_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052644_s1_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052638_s2_1b8e300661fe731)) where watdiv1052644_s1_1b8e300661fe731.v0 = watdiv1052638_s2_1b8e300661fe731.v0)), watdiv1052645_s2_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052645_s1_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052629_s2_1b8e300661fe731)) where watdiv1052645_s1_1b8e300661fe731.v8 = watdiv1052629_s2_1b8e300661fe731.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_1b8e300661fe731)) where watdiv1052645_s1_1b8e300661fe731.v8 = watdiv1052652_s2_1b8e300661fe731.v8)), watdiv1052647_s2_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052647_s1_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052645_s2_1b8e300661fe731)) where watdiv1052647_s1_1b8e300661fe731.v8 = watdiv1052645_s2_1b8e300661fe731.v8)), watdiv1052572_s2_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052572_s1_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052647_s2_1b8e300661fe731)) where watdiv1052572_s1_1b8e300661fe731.v6 = watdiv1052647_s2_1b8e300661fe731.v6)), watdiv1052646_s2_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052646_s1_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052644_s2_1b8e300661fe731)) where watdiv1052646_s1_1b8e300661fe731.v2 = watdiv1052644_s2_1b8e300661fe731.v2) AND exists (select from umbra.identity(table(watdiv1052572_s2_1b8e300661fe731)) where watdiv1052646_s1_1b8e300661fe731.v4 = watdiv1052572_s2_1b8e300661fe731.v4)) /* stage3 */, watdiv1052572_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052572_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052646_s2_1b8e300661fe731)) where watdiv1052572_s2_1b8e300661fe731.v4 = watdiv1052646_s2_1b8e300661fe731.v4)), watdiv1052647_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052647_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052572_s2_1b8e300661fe731)) where watdiv1052647_s2_1b8e300661fe731.v6 = watdiv1052572_s2_1b8e300661fe731.v6)), watdiv1052645_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052645_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052647_s2_1b8e300661fe731)) where watdiv1052645_s2_1b8e300661fe731.v8 = watdiv1052647_s2_1b8e300661fe731.v8)), watdiv1052652_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052652_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052645_s2_1b8e300661fe731)) where watdiv1052652_s2_1b8e300661fe731.v8 = watdiv1052645_s2_1b8e300661fe731.v8)), watdiv1052629_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052629_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052645_s2_1b8e300661fe731)) where watdiv1052629_s2_1b8e300661fe731.v8 = watdiv1052645_s2_1b8e300661fe731.v8)), watdiv1052644_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052644_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052646_s2_1b8e300661fe731)) where watdiv1052644_s2_1b8e300661fe731.v2 = watdiv1052646_s2_1b8e300661fe731.v2)), watdiv1052638_s3_1b8e300661fe731 as (select * from umbra.identity(table(watdiv1052638_s2_1b8e300661fe731)) where exists (select from umbra.identity(table(watdiv1052644_s2_1b8e300661fe731)) where watdiv1052638_s2_1b8e300661fe731.v0 = watdiv1052644_s2_1b8e300661fe731.v0)) /* stage4 */, s4_group_210B26F02A0C6FE2 as  (select * from umbra.identity(table(watdiv1052646_s2_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052644_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052638_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052572_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052645_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_1b8e300661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1b8e300661fe731)))select count(*) from umbra.identity(table(s4_group_210B26F02A0C6FE2));
--\set queryname watdiv_acyclic_216_13
-- Result size: 274361640786
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052578 [label="watdiv1052578|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052646 [label="watdiv1052646|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052581 [label="watdiv1052581|<s> s|<d> d"]; watdiv1052584 [label="watdiv1052584|<s> s|<d> d"]; watdiv1052582 [label="watdiv1052582|<s> s|<d> d"]; watdiv1052578:d -> watdiv1052647:d;watdiv1052647:s -> watdiv1052651:s;watdiv1052651:d -> watdiv1052646:s;watdiv1052646:d -> watdiv1052613:d;watdiv1052613:s -> watdiv1052581:s;watdiv1052581:s -> watdiv1052584:s;watdiv1052584:s -> watdiv1052582:s;}
--                    +----------------------------------------------------+
--                    |                                                    |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052651 |  s |  d |
--                    |                            +---------------+----+----+
--                    |                                               |
--                    |                                               |
--                    |                                               |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052647 |  s |  d |
--                    |                            +---------------+----+----+
--                    |                                                    |
--                    |                                                    |
--                    |                                                    |
--                    |                            +---------------+----+----+
--                    |                            | watdiv1052578 |  s |  d |
--                    |                            +---------------+----+----+
--                    |
--                    |        +--------------------------------------+
--                    |        |                                      |
-- +---------------+----+---+  |  +---------------+----------------+----+
-- | watdiv1052646 |  s | d | -+  | watdiv1052613 |        s       |  d |
-- +---------------+----+---+     +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052581 |        s       |  d |
--                                +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052584 |        s       |  d |
--                                +---------------+----------------+----+
--                                                   |
--                                                   |
--                                                   |
--                                +---------------+----------------+----+
--                                | watdiv1052582 |        s       |  d |
--                                +---------------+----------------+----+
--with dummy as (select) /* stage1 */, watdiv1052651_s1_a446580661fe731 as (select watdiv1052651.d as v4,watdiv1052651.s as v2 from watdiv1052651), watdiv1052646_s1_a446580661fe731 as (select watdiv1052646.d as v6,watdiv1052646.s as v4 from watdiv1052646), watdiv1052613_s1_a446580661fe731 as (select watdiv1052613.s as v8,watdiv1052613.d as v6 from watdiv1052613), watdiv1052582_s1_a446580661fe731 as (select watdiv1052582.s as v8 from watdiv1052582), watdiv1052584_s2_a446580661fe731 as (select watdiv1052584.s as v8 from watdiv1052584), watdiv1052581_s2_a446580661fe731 as (select watdiv1052581.s as v8 from watdiv1052581), watdiv1052647_s1_a446580661fe731 as (select watdiv1052647.d as v0,watdiv1052647.s as v2 from watdiv1052647), watdiv1052578_s2_a446580661fe731 as (select watdiv1052578.d as v0 from watdiv1052578) /* stage2 */, watdiv1052647_s2_a446580661fe731 as (select * from umbra.identity(table(watdiv1052647_s1_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052578_s2_a446580661fe731)) where watdiv1052647_s1_a446580661fe731.v0 = watdiv1052578_s2_a446580661fe731.v0)), watdiv1052582_s2_a446580661fe731 as (select * from umbra.identity(table(watdiv1052582_s1_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052581_s2_a446580661fe731)) where watdiv1052582_s1_a446580661fe731.v8 = watdiv1052581_s2_a446580661fe731.v8) AND exists (select from umbra.identity(table(watdiv1052584_s2_a446580661fe731)) where watdiv1052582_s1_a446580661fe731.v8 = watdiv1052584_s2_a446580661fe731.v8)), watdiv1052613_s2_a446580661fe731 as (select * from umbra.identity(table(watdiv1052613_s1_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052582_s2_a446580661fe731)) where watdiv1052613_s1_a446580661fe731.v8 = watdiv1052582_s2_a446580661fe731.v8)), watdiv1052646_s2_a446580661fe731 as (select * from umbra.identity(table(watdiv1052646_s1_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052613_s2_a446580661fe731)) where watdiv1052646_s1_a446580661fe731.v6 = watdiv1052613_s2_a446580661fe731.v6)), watdiv1052651_s2_a446580661fe731 as (select * from umbra.identity(table(watdiv1052651_s1_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052647_s2_a446580661fe731)) where watdiv1052651_s1_a446580661fe731.v2 = watdiv1052647_s2_a446580661fe731.v2) AND exists (select from umbra.identity(table(watdiv1052646_s2_a446580661fe731)) where watdiv1052651_s1_a446580661fe731.v4 = watdiv1052646_s2_a446580661fe731.v4)) /* stage3 */, watdiv1052646_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052646_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052651_s2_a446580661fe731)) where watdiv1052646_s2_a446580661fe731.v4 = watdiv1052651_s2_a446580661fe731.v4)), watdiv1052613_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052613_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052646_s2_a446580661fe731)) where watdiv1052613_s2_a446580661fe731.v6 = watdiv1052646_s2_a446580661fe731.v6)), watdiv1052582_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052582_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052613_s2_a446580661fe731)) where watdiv1052582_s2_a446580661fe731.v8 = watdiv1052613_s2_a446580661fe731.v8)), watdiv1052584_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052584_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052582_s2_a446580661fe731)) where watdiv1052584_s2_a446580661fe731.v8 = watdiv1052582_s2_a446580661fe731.v8)), watdiv1052581_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052581_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052582_s2_a446580661fe731)) where watdiv1052581_s2_a446580661fe731.v8 = watdiv1052582_s2_a446580661fe731.v8)), watdiv1052647_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052647_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052651_s2_a446580661fe731)) where watdiv1052647_s2_a446580661fe731.v2 = watdiv1052651_s2_a446580661fe731.v2)), watdiv1052578_s3_a446580661fe731 as (select * from umbra.identity(table(watdiv1052578_s2_a446580661fe731)) where exists (select from umbra.identity(table(watdiv1052647_s2_a446580661fe731)) where watdiv1052578_s2_a446580661fe731.v0 = watdiv1052647_s2_a446580661fe731.v0)) /* stage4 */, s4_group_7937DB00EFAE125B as  (select * from umbra.identity(table(watdiv1052651_s2_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052578_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052646_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052613_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052582_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052581_s3_a446580661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052584_s3_a446580661fe731)))select count(*) from umbra.identity(table(s4_group_7937DB00EFAE125B));
\set queryname watdiv_acyclic_216_14
-- Result size: 8091
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052594 [label="watdiv1052594|<s> s|<d> d"]; watdiv1052593 [label="watdiv1052593|<s> s|<d> d"]; watdiv1052649 [label="watdiv1052649|<s> s|<d> d"]; watdiv1052621 [label="watdiv1052621|<s> s|<d> d"]; watdiv1052584 [label="watdiv1052584|<s> s|<d> d"]; watdiv1052582 [label="watdiv1052582|<s> s|<d> d"]; watdiv1052589 [label="watdiv1052589|<s> s|<d> d"]; watdiv1052574:d -> watdiv1052594:d;watdiv1052594:s -> watdiv1052593:s;watdiv1052593:d -> watdiv1052649:s;watdiv1052649:d -> watdiv1052621:d;watdiv1052621:s -> watdiv1052584:s;watdiv1052584:s -> watdiv1052582:s;watdiv1052582:s -> watdiv1052589:s;}
--                                        +---------------+----+----+
--                                        | watdiv1052594 |  s |  d |
--                                        +---------------+----+----+
--                                                           |    |
--   +-------------------------------------------------------+    |
--   |                                                            |
--   |                                    +---------------+----+----+
--   |                                    | watdiv1052574 |  s |  d |
--   |                                    +---------------+----+----+
--   |                   +---------------+----------------+----+
--   |                   | watdiv1052621 |        s       |  d | -+
--   |                   +---------------+----------------+----+  |
--   |                                      |                     |
--   |                                      |                     |
--   |                                      |                     |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052584 |        s       |  d |  |
--   |                   +---------------+----------------+----+  |
--   |                                      |                     |
--   |                                      |                     |
--   |                                      |                     |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052582 |        s       |  d |  |
--   |                   +---------------+----------------+----+  |
--   |                                      |                     |
--   |                                      |                     |
--   |                                      |                     |
--   |                   +---------------+----------------+----+  |
--   |                   | watdiv1052589 |        s       |  d |  |
--   |                   +---------------+----------------+----+  |
--   |                                                            |
--   +---------------------+                                 +----+
--                         |                                 |
--      +---------------+----------------+----------------+  |
--      | watdiv1052593 |        s       |        d       |  |
--      +---------------+----------------+----------------+  |
--                                          |                |
--                                          |                |
--                                          |                |
--                       +---------------+----------------+----+
--                       | watdiv1052649 |        s       |  d |
--                       +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052649_s1_12aedb00661fe731 as (select watdiv1052649.s as v4,watdiv1052649.d as v6 from watdiv1052649), watdiv1052593_s1_12aedb00661fe731 as (select watdiv1052593.d as v4,watdiv1052593.s as v2 from watdiv1052593), watdiv1052594_s1_12aedb00661fe731 as (select watdiv1052594.s as v2,watdiv1052594.d as v0 from watdiv1052594), watdiv1052574_s2_12aedb00661fe731 as (select watdiv1052574.d as v0 from watdiv1052574), watdiv1052621_s1_12aedb00661fe731 as (select watdiv1052621.d as v6,watdiv1052621.s as v8 from watdiv1052621), watdiv1052584_s1_12aedb00661fe731 as (select watdiv1052584.s as v8 from watdiv1052584), watdiv1052589_s2_12aedb00661fe731 as (select watdiv1052589.s as v8 from watdiv1052589), watdiv1052582_s2_12aedb00661fe731 as (select watdiv1052582.s as v8 from watdiv1052582) /* stage2 */, watdiv1052584_s2_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052584_s1_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052582_s2_12aedb00661fe731)) where watdiv1052584_s1_12aedb00661fe731.v8 = watdiv1052582_s2_12aedb00661fe731.v8) AND exists (select from umbra.identity(table(watdiv1052589_s2_12aedb00661fe731)) where watdiv1052584_s1_12aedb00661fe731.v8 = watdiv1052589_s2_12aedb00661fe731.v8)), watdiv1052621_s2_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052621_s1_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052584_s2_12aedb00661fe731)) where watdiv1052621_s1_12aedb00661fe731.v8 = watdiv1052584_s2_12aedb00661fe731.v8)), watdiv1052594_s2_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052594_s1_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052574_s2_12aedb00661fe731)) where watdiv1052594_s1_12aedb00661fe731.v0 = watdiv1052574_s2_12aedb00661fe731.v0)), watdiv1052593_s2_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052593_s1_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052594_s2_12aedb00661fe731)) where watdiv1052593_s1_12aedb00661fe731.v2 = watdiv1052594_s2_12aedb00661fe731.v2)), watdiv1052649_s2_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052649_s1_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052621_s2_12aedb00661fe731)) where watdiv1052649_s1_12aedb00661fe731.v6 = watdiv1052621_s2_12aedb00661fe731.v6) AND exists (select from umbra.identity(table(watdiv1052593_s2_12aedb00661fe731)) where watdiv1052649_s1_12aedb00661fe731.v4 = watdiv1052593_s2_12aedb00661fe731.v4)) /* stage3 */, watdiv1052593_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052593_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052649_s2_12aedb00661fe731)) where watdiv1052593_s2_12aedb00661fe731.v4 = watdiv1052649_s2_12aedb00661fe731.v4)), watdiv1052594_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052594_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052593_s2_12aedb00661fe731)) where watdiv1052594_s2_12aedb00661fe731.v2 = watdiv1052593_s2_12aedb00661fe731.v2)), watdiv1052574_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052574_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052594_s2_12aedb00661fe731)) where watdiv1052574_s2_12aedb00661fe731.v0 = watdiv1052594_s2_12aedb00661fe731.v0)), watdiv1052621_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052621_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052649_s2_12aedb00661fe731)) where watdiv1052621_s2_12aedb00661fe731.v6 = watdiv1052649_s2_12aedb00661fe731.v6)), watdiv1052584_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052584_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052621_s2_12aedb00661fe731)) where watdiv1052584_s2_12aedb00661fe731.v8 = watdiv1052621_s2_12aedb00661fe731.v8)), watdiv1052589_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052589_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052584_s2_12aedb00661fe731)) where watdiv1052589_s2_12aedb00661fe731.v8 = watdiv1052584_s2_12aedb00661fe731.v8)), watdiv1052582_s3_12aedb00661fe731 as (select * from umbra.identity(table(watdiv1052582_s2_12aedb00661fe731)) where exists (select from umbra.identity(table(watdiv1052584_s2_12aedb00661fe731)) where watdiv1052582_s2_12aedb00661fe731.v8 = watdiv1052584_s2_12aedb00661fe731.v8)) /* stage4 */, s4_group_6FF6EE5D51BB8252 as  (select * from umbra.identity(table(watdiv1052649_s2_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052621_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052584_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052582_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052589_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052593_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052594_s3_12aedb00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_12aedb00661fe731)))select count(*) from umbra.identity(table(s4_group_6FF6EE5D51BB8252));
\set queryname watdiv_acyclic_216_15
-- Result size: 29084349
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052621 [label="watdiv1052621|<s> s|<d> d"]; watdiv1052586 [label="watdiv1052586|<s> s|<d> d"]; watdiv1052613 [label="watdiv1052613|<s> s|<d> d"]; watdiv1052585 [label="watdiv1052585|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052651:s;watdiv1052651:d -> watdiv1052650:s;watdiv1052650:d -> watdiv1052621:d;watdiv1052621:s -> watdiv1052586:s;watdiv1052586:s -> watdiv1052613:s;watdiv1052613:s -> watdiv1052585:s;}
--                                                                +-------------------------------------------+
--                                                                |                                           |
--                                                                |              +---------------+----+----+  |
--                                          +---------------------+              | watdiv1052585 |  s |  d |  |
--                                          |                                    +---------------+----+----+  |
--                                          |                                                       |         |
--                                          |                                                       +----+    |
--                                          |                                                            |    |
--                  +---------------+----+----+                 +---------------+----------------+----+  |    |
--                  | watdiv1052650 |  s |  d |                 | watdiv1052621 |        s       |  d |  |    |
--                  +---------------+----+----+                 +---------------+----------------+----+  |    |
--                                     |                                           |                |    |    |
--                                     |                                           |                +----+----+
--                                     |                                           |                     |
-- +---------------+----------------+----+                      +---------------+----------------+----+  |
-- | watdiv1052651 |        s       |  d |                      | watdiv1052586 |        s       |  d |  |
-- +---------------+----------------+----+                      +---------------+----------------+----+  |
--                    |                                                            |                     |
--                    |                                                            |                     |
--                    |                                                            |                     |
--                    |                                         +---------------+----------------+----+  |
--                    |                                         | watdiv1052613 |        s       |  d |  |
--                    |                                         +---------------+----------------+----+  |
--                    |                                                            |                     |
--                    |                                                            +---------------------+
--                    |
--                    |                        +---------------+----------------+----------------+
--                    |                        | watdiv1052624 |        s       |        d       |
--                    |                        +---------------+----------------+----------------+
--                    |                                                            |
--                    +-------------------------------------------+                |
--                                                                |                |
--                                             +---------------+----------------+----------------+
--                                             | watdiv1052652 |        s       |        d       |
--                                             +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052651_s1_1b077a00661fe731 as (select watdiv1052651.s as v2,watdiv1052651.d as v4 from watdiv1052651), watdiv1052650_s1_1b077a00661fe731 as (select watdiv1052650.d as v6,watdiv1052650.s as v4 from watdiv1052650), watdiv1052621_s1_1b077a00661fe731 as (select watdiv1052621.s as v8,watdiv1052621.d as v6 from watdiv1052621), watdiv1052586_s1_1b077a00661fe731 as (select watdiv1052586.s as v8 from watdiv1052586), watdiv1052613_s2_1b077a00661fe731 as (select watdiv1052613.s as v8 from watdiv1052613), watdiv1052585_s2_1b077a00661fe731 as (select watdiv1052585.s as v8 from watdiv1052585), watdiv1052652_s1_1b077a00661fe731 as (select watdiv1052652.d as v0,watdiv1052652.s as v2 from watdiv1052652), watdiv1052624_s2_1b077a00661fe731 as (select watdiv1052624.d as v0 from watdiv1052624) /* stage2 */, watdiv1052652_s2_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052652_s1_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052624_s2_1b077a00661fe731)) where watdiv1052652_s1_1b077a00661fe731.v0 = watdiv1052624_s2_1b077a00661fe731.v0)), watdiv1052586_s2_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052586_s1_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052585_s2_1b077a00661fe731)) where watdiv1052586_s1_1b077a00661fe731.v8 = watdiv1052585_s2_1b077a00661fe731.v8) AND exists (select from umbra.identity(table(watdiv1052613_s2_1b077a00661fe731)) where watdiv1052586_s1_1b077a00661fe731.v8 = watdiv1052613_s2_1b077a00661fe731.v8)), watdiv1052621_s2_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052621_s1_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052586_s2_1b077a00661fe731)) where watdiv1052621_s1_1b077a00661fe731.v8 = watdiv1052586_s2_1b077a00661fe731.v8)), watdiv1052650_s2_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052650_s1_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052621_s2_1b077a00661fe731)) where watdiv1052650_s1_1b077a00661fe731.v6 = watdiv1052621_s2_1b077a00661fe731.v6)), watdiv1052651_s2_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052651_s1_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052652_s2_1b077a00661fe731)) where watdiv1052651_s1_1b077a00661fe731.v2 = watdiv1052652_s2_1b077a00661fe731.v2) AND exists (select from umbra.identity(table(watdiv1052650_s2_1b077a00661fe731)) where watdiv1052651_s1_1b077a00661fe731.v4 = watdiv1052650_s2_1b077a00661fe731.v4)) /* stage3 */, watdiv1052650_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052650_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052651_s2_1b077a00661fe731)) where watdiv1052650_s2_1b077a00661fe731.v4 = watdiv1052651_s2_1b077a00661fe731.v4)), watdiv1052621_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052621_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052650_s2_1b077a00661fe731)) where watdiv1052621_s2_1b077a00661fe731.v6 = watdiv1052650_s2_1b077a00661fe731.v6)), watdiv1052586_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052586_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052621_s2_1b077a00661fe731)) where watdiv1052586_s2_1b077a00661fe731.v8 = watdiv1052621_s2_1b077a00661fe731.v8)), watdiv1052613_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052613_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052586_s2_1b077a00661fe731)) where watdiv1052613_s2_1b077a00661fe731.v8 = watdiv1052586_s2_1b077a00661fe731.v8)), watdiv1052585_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052585_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052586_s2_1b077a00661fe731)) where watdiv1052585_s2_1b077a00661fe731.v8 = watdiv1052586_s2_1b077a00661fe731.v8)), watdiv1052652_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052652_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052651_s2_1b077a00661fe731)) where watdiv1052652_s2_1b077a00661fe731.v2 = watdiv1052651_s2_1b077a00661fe731.v2)), watdiv1052624_s3_1b077a00661fe731 as (select * from umbra.identity(table(watdiv1052624_s2_1b077a00661fe731)) where exists (select from umbra.identity(table(watdiv1052652_s2_1b077a00661fe731)) where watdiv1052624_s2_1b077a00661fe731.v0 = watdiv1052652_s2_1b077a00661fe731.v0)) /* stage4 */, s4_group_21671465569C2167 as  (select * from umbra.identity(table(watdiv1052651_s2_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052621_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052586_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052585_s3_1b077a00661fe731)) NATURAL JOIN umbra.identity(table(watdiv1052613_s3_1b077a00661fe731)))select count(*) from umbra.identity(table(s4_group_21671465569C2167));
\set queryname watdiv_acyclic_216_16
-- Result size: 10815755
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052624 [label="watdiv1052624|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052655 [label="watdiv1052655|<s> s|<d> d"]; watdiv1052574 [label="watdiv1052574|<s> s|<d> d"]; watdiv1052592 [label="watdiv1052592|<s> s|<d> d"]; watdiv1052590 [label="watdiv1052590|<s> s|<d> d"]; watdiv1052585 [label="watdiv1052585|<s> s|<d> d"]; watdiv1052582 [label="watdiv1052582|<s> s|<d> d"]; watdiv1052624:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052655:s;watdiv1052655:d -> watdiv1052574:s;watdiv1052574:d -> watdiv1052592:d;watdiv1052592:s -> watdiv1052590:s;watdiv1052590:s -> watdiv1052585:s;watdiv1052585:s -> watdiv1052582:s;}
--                                                      +---------+
--                                                      |         |
--                                   +---------------+----+----+  |
--                                   | watdiv1052574 |  s |  d |  |
--                                   +---------------+----+----+  |
--                                                           |    |
--                                                           |    |
--                                                           |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052592 |        s       |  d | -+    |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052590 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052585 |        s       |  d |       |
--                  +---------------+----------------+----+       |
--                                     |                          |
--                                     |                          |
--                                     |                          |
--                  +---------------+----------------+----+       |
--                  | watdiv1052582 |        s       |  d |       |
--                  +---------------+----------------+----+       |
-- +---------------+----------------+----------------+            |
-- | watdiv1052624 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                                     |                          |
--                                     |                          |
--                                     |                          |
-- +---------------+----------------+----------------+            |
-- | watdiv1052652 |        s       |        d       |            |
-- +---------------+----------------+----------------+            |
--                    |                                           |
--                    |                                           |
--                    |                                           |
-- +---------------+----------------+----------------+            |
-- | watdiv1052655 |        s       |        d       | -----------+
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052655_s1_3977800661fe732 as (select watdiv1052655.s as v2,watdiv1052655.d as v4 from watdiv1052655), watdiv1052574_s1_3977800661fe732 as (select watdiv1052574.s as v4,watdiv1052574.d as v6 from watdiv1052574), watdiv1052592_s1_3977800661fe732 as (select watdiv1052592.d as v6,watdiv1052592.s as v8 from watdiv1052592), watdiv1052585_s1_3977800661fe732 as (select watdiv1052585.s as v8 from watdiv1052585), watdiv1052590_s2_3977800661fe732 as (select watdiv1052590.s as v8 from watdiv1052590), watdiv1052582_s2_3977800661fe732 as (select watdiv1052582.s as v8 from watdiv1052582), watdiv1052652_s1_3977800661fe732 as (select watdiv1052652.d as v0,watdiv1052652.s as v2 from watdiv1052652), watdiv1052624_s2_3977800661fe732 as (select watdiv1052624.d as v0 from watdiv1052624) /* stage2 */, watdiv1052652_s2_3977800661fe732 as (select * from umbra.identity(table(watdiv1052652_s1_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052624_s2_3977800661fe732)) where watdiv1052652_s1_3977800661fe732.v0 = watdiv1052624_s2_3977800661fe732.v0)), watdiv1052585_s2_3977800661fe732 as (select * from umbra.identity(table(watdiv1052585_s1_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052582_s2_3977800661fe732)) where watdiv1052585_s1_3977800661fe732.v8 = watdiv1052582_s2_3977800661fe732.v8) AND exists (select from umbra.identity(table(watdiv1052590_s2_3977800661fe732)) where watdiv1052585_s1_3977800661fe732.v8 = watdiv1052590_s2_3977800661fe732.v8)), watdiv1052592_s2_3977800661fe732 as (select * from umbra.identity(table(watdiv1052592_s1_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052585_s2_3977800661fe732)) where watdiv1052592_s1_3977800661fe732.v8 = watdiv1052585_s2_3977800661fe732.v8)), watdiv1052574_s2_3977800661fe732 as (select * from umbra.identity(table(watdiv1052574_s1_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052592_s2_3977800661fe732)) where watdiv1052574_s1_3977800661fe732.v6 = watdiv1052592_s2_3977800661fe732.v6)), watdiv1052655_s2_3977800661fe732 as (select * from umbra.identity(table(watdiv1052655_s1_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052652_s2_3977800661fe732)) where watdiv1052655_s1_3977800661fe732.v2 = watdiv1052652_s2_3977800661fe732.v2) AND exists (select from umbra.identity(table(watdiv1052574_s2_3977800661fe732)) where watdiv1052655_s1_3977800661fe732.v4 = watdiv1052574_s2_3977800661fe732.v4)) /* stage3 */, watdiv1052574_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052574_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052655_s2_3977800661fe732)) where watdiv1052574_s2_3977800661fe732.v4 = watdiv1052655_s2_3977800661fe732.v4)), watdiv1052592_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052592_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052574_s2_3977800661fe732)) where watdiv1052592_s2_3977800661fe732.v6 = watdiv1052574_s2_3977800661fe732.v6)), watdiv1052585_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052585_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052592_s2_3977800661fe732)) where watdiv1052585_s2_3977800661fe732.v8 = watdiv1052592_s2_3977800661fe732.v8)), watdiv1052590_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052590_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052585_s2_3977800661fe732)) where watdiv1052590_s2_3977800661fe732.v8 = watdiv1052585_s2_3977800661fe732.v8)), watdiv1052582_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052582_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052585_s2_3977800661fe732)) where watdiv1052582_s2_3977800661fe732.v8 = watdiv1052585_s2_3977800661fe732.v8)), watdiv1052652_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052652_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052655_s2_3977800661fe732)) where watdiv1052652_s2_3977800661fe732.v2 = watdiv1052655_s2_3977800661fe732.v2)), watdiv1052624_s3_3977800661fe732 as (select * from umbra.identity(table(watdiv1052624_s2_3977800661fe732)) where exists (select from umbra.identity(table(watdiv1052652_s2_3977800661fe732)) where watdiv1052624_s2_3977800661fe732.v0 = watdiv1052652_s2_3977800661fe732.v0)) /* stage4 */, s4_group_67FC0066148C0674 as  (select * from umbra.identity(table(watdiv1052655_s2_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052624_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052574_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052592_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052585_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052582_s3_3977800661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052590_s3_3977800661fe732)))select count(*) from umbra.identity(table(s4_group_67FC0066148C0674));
\set queryname watdiv_acyclic_216_17
-- Result size: 402878824
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052637 [label="watdiv1052637|<s> s|<d> d"]; watdiv1052632 [label="watdiv1052632|<s> s|<d> d"]; watdiv1052627 [label="watdiv1052627|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052650 [label="watdiv1052650|<s> s|<d> d"]; watdiv1052647 [label="watdiv1052647|<s> s|<d> d"]; watdiv1052637:d -> watdiv1052632:d;watdiv1052632:s -> watdiv1052627:s;watdiv1052627:d -> watdiv1052573:s;watdiv1052573:d -> watdiv1052652:d;watdiv1052652:s -> watdiv1052629:s;watdiv1052629:s -> watdiv1052650:s;watdiv1052650:s -> watdiv1052647:s;}
-- +---------------+----------------+----+
-- | watdiv1052637 |        s       |  d |
-- +---------------+----------------+----+
--                                     |
--                                     |
--                                     |
-- +---------------+----------------+----+
-- | watdiv1052632 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052627 |        s       |  d |
-- +---------------+----------------+----+
--                                     |
--                                     |
--                                     |
--                  +---------------+----+----+
--                  | watdiv1052573 |  s |  d |
--                  +---------------+----+----+
--                                          |
--                                          |
--                                          |
-- +---------------+----------------+----+  |
-- | watdiv1052652 |        s       |  d | -+
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052629 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052650 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052647 |        s       |  d |
-- +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052627_s1_c17c080661fe732 as (select watdiv1052627.d as v4,watdiv1052627.s as v2 from watdiv1052627), watdiv1052573_s1_c17c080661fe732 as (select watdiv1052573.s as v4,watdiv1052573.d as v6 from watdiv1052573), watdiv1052652_s1_c17c080661fe732 as (select watdiv1052652.d as v6,watdiv1052652.s as v8 from watdiv1052652), watdiv1052647_s1_c17c080661fe732 as (select watdiv1052647.s as v8 from watdiv1052647), watdiv1052650_s2_c17c080661fe732 as (select watdiv1052650.s as v8 from watdiv1052650), watdiv1052629_s2_c17c080661fe732 as (select watdiv1052629.s as v8 from watdiv1052629), watdiv1052632_s1_c17c080661fe732 as (select watdiv1052632.s as v2,watdiv1052632.d as v0 from watdiv1052632), watdiv1052637_s2_c17c080661fe732 as (select watdiv1052637.d as v0 from watdiv1052637) /* stage2 */, watdiv1052632_s2_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052632_s1_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052637_s2_c17c080661fe732)) where watdiv1052632_s1_c17c080661fe732.v0 = watdiv1052637_s2_c17c080661fe732.v0)), watdiv1052647_s2_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052647_s1_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052629_s2_c17c080661fe732)) where watdiv1052647_s1_c17c080661fe732.v8 = watdiv1052629_s2_c17c080661fe732.v8) AND exists (select from umbra.identity(table(watdiv1052650_s2_c17c080661fe732)) where watdiv1052647_s1_c17c080661fe732.v8 = watdiv1052650_s2_c17c080661fe732.v8)), watdiv1052652_s2_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052652_s1_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052647_s2_c17c080661fe732)) where watdiv1052652_s1_c17c080661fe732.v8 = watdiv1052647_s2_c17c080661fe732.v8)), watdiv1052573_s2_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052573_s1_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052652_s2_c17c080661fe732)) where watdiv1052573_s1_c17c080661fe732.v6 = watdiv1052652_s2_c17c080661fe732.v6)), watdiv1052627_s2_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052627_s1_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052632_s2_c17c080661fe732)) where watdiv1052627_s1_c17c080661fe732.v2 = watdiv1052632_s2_c17c080661fe732.v2) AND exists (select from umbra.identity(table(watdiv1052573_s2_c17c080661fe732)) where watdiv1052627_s1_c17c080661fe732.v4 = watdiv1052573_s2_c17c080661fe732.v4)) /* stage3 */, watdiv1052573_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052573_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052627_s2_c17c080661fe732)) where watdiv1052573_s2_c17c080661fe732.v4 = watdiv1052627_s2_c17c080661fe732.v4)), watdiv1052652_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052652_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052573_s2_c17c080661fe732)) where watdiv1052652_s2_c17c080661fe732.v6 = watdiv1052573_s2_c17c080661fe732.v6)), watdiv1052647_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052647_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052652_s2_c17c080661fe732)) where watdiv1052647_s2_c17c080661fe732.v8 = watdiv1052652_s2_c17c080661fe732.v8)), watdiv1052650_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052650_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052647_s2_c17c080661fe732)) where watdiv1052650_s2_c17c080661fe732.v8 = watdiv1052647_s2_c17c080661fe732.v8)), watdiv1052629_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052629_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052647_s2_c17c080661fe732)) where watdiv1052629_s2_c17c080661fe732.v8 = watdiv1052647_s2_c17c080661fe732.v8)), watdiv1052632_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052632_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052627_s2_c17c080661fe732)) where watdiv1052632_s2_c17c080661fe732.v2 = watdiv1052627_s2_c17c080661fe732.v2)), watdiv1052637_s3_c17c080661fe732 as (select * from umbra.identity(table(watdiv1052637_s2_c17c080661fe732)) where exists (select from umbra.identity(table(watdiv1052632_s2_c17c080661fe732)) where watdiv1052637_s2_c17c080661fe732.v0 = watdiv1052632_s2_c17c080661fe732.v0)) /* stage4 */, s4_group_7610172C6E6AD761 as  (select * from umbra.identity(table(watdiv1052627_s2_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052632_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052637_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052647_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_c17c080661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052650_s3_c17c080661fe732)))select count(*) from umbra.identity(table(s4_group_7610172C6E6AD761));
\set queryname watdiv_acyclic_216_18
-- Result size: 27908621
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052637 [label="watdiv1052637|<s> s|<d> d"]; watdiv1052576 [label="watdiv1052576|<s> s|<d> d"]; watdiv1052573 [label="watdiv1052573|<s> s|<d> d"]; watdiv1052588 [label="watdiv1052588|<s> s|<d> d"]; watdiv1052620 [label="watdiv1052620|<s> s|<d> d"]; watdiv1052587 [label="watdiv1052587|<s> s|<d> d"]; watdiv1052598 [label="watdiv1052598|<s> s|<d> d"]; watdiv1052582 [label="watdiv1052582|<s> s|<d> d"]; watdiv1052637:d -> watdiv1052576:d;watdiv1052576:s -> watdiv1052573:s;watdiv1052573:d -> watdiv1052588:s;watdiv1052588:d -> watdiv1052620:d;watdiv1052620:s -> watdiv1052587:s;watdiv1052587:s -> watdiv1052598:s;watdiv1052598:s -> watdiv1052582:s;}
--                  +---------------+----+----+
--                  | watdiv1052637 |  s |  d |
--                  +---------------+----+----+
--                                          |
--                                          |
--                                          |
--                  +---------------+----+----+
--                  | watdiv1052576 |  s |  d |
--                  +---------------+----+----+
--                                     |
--                                     |
--                                     |
--                  +---------------+----+----+---------------+----+----+
--                  | watdiv1052573 |  s |  d | watdiv1052588 |  s |  d |
--                  +---------------+----+----+---------------+----+----+
--                                          |                    |    |
--                                          +--------------------+    |
--                                                                    |
-- +---------------+----------------+----+                            |
-- | watdiv1052620 |        s       |  d | ---------------------------+
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052587 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052598 |        s       |  d |
-- +---------------+----------------+----+
--                    |
--                    |
--                    |
-- +---------------+----------------+----+
-- | watdiv1052582 |        s       |  d |
-- +---------------+----------------+----+
with dummy as (select) /* stage1 */, watdiv1052588_s1_14936a80661fe732 as (select watdiv1052588.s as v4,watdiv1052588.d as v6 from watdiv1052588), watdiv1052573_s1_14936a80661fe732 as (select watdiv1052573.d as v4,watdiv1052573.s as v2 from watdiv1052573), watdiv1052576_s1_14936a80661fe732 as (select watdiv1052576.d as v0,watdiv1052576.s as v2 from watdiv1052576), watdiv1052637_s2_14936a80661fe732 as (select watdiv1052637.d as v0 from watdiv1052637), watdiv1052620_s1_14936a80661fe732 as (select watdiv1052620.s as v8,watdiv1052620.d as v6 from watdiv1052620), watdiv1052587_s1_14936a80661fe732 as (select watdiv1052587.s as v8 from watdiv1052587), watdiv1052598_s2_14936a80661fe732 as (select watdiv1052598.s as v8 from watdiv1052598), watdiv1052582_s2_14936a80661fe732 as (select watdiv1052582.s as v8 from watdiv1052582) /* stage2 */, watdiv1052587_s2_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052587_s1_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052582_s2_14936a80661fe732)) where watdiv1052587_s1_14936a80661fe732.v8 = watdiv1052582_s2_14936a80661fe732.v8) AND exists (select from umbra.identity(table(watdiv1052598_s2_14936a80661fe732)) where watdiv1052587_s1_14936a80661fe732.v8 = watdiv1052598_s2_14936a80661fe732.v8)), watdiv1052620_s2_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052620_s1_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052587_s2_14936a80661fe732)) where watdiv1052620_s1_14936a80661fe732.v8 = watdiv1052587_s2_14936a80661fe732.v8)), watdiv1052576_s2_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052576_s1_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052637_s2_14936a80661fe732)) where watdiv1052576_s1_14936a80661fe732.v0 = watdiv1052637_s2_14936a80661fe732.v0)), watdiv1052573_s2_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052573_s1_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052576_s2_14936a80661fe732)) where watdiv1052573_s1_14936a80661fe732.v2 = watdiv1052576_s2_14936a80661fe732.v2)), watdiv1052588_s2_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052588_s1_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052620_s2_14936a80661fe732)) where watdiv1052588_s1_14936a80661fe732.v6 = watdiv1052620_s2_14936a80661fe732.v6) AND exists (select from umbra.identity(table(watdiv1052573_s2_14936a80661fe732)) where watdiv1052588_s1_14936a80661fe732.v4 = watdiv1052573_s2_14936a80661fe732.v4)) /* stage3 */, watdiv1052573_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052573_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052588_s2_14936a80661fe732)) where watdiv1052573_s2_14936a80661fe732.v4 = watdiv1052588_s2_14936a80661fe732.v4)), watdiv1052576_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052576_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052573_s2_14936a80661fe732)) where watdiv1052576_s2_14936a80661fe732.v2 = watdiv1052573_s2_14936a80661fe732.v2)), watdiv1052637_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052637_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052576_s2_14936a80661fe732)) where watdiv1052637_s2_14936a80661fe732.v0 = watdiv1052576_s2_14936a80661fe732.v0)), watdiv1052620_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052620_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052588_s2_14936a80661fe732)) where watdiv1052620_s2_14936a80661fe732.v6 = watdiv1052588_s2_14936a80661fe732.v6)), watdiv1052587_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052587_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052620_s2_14936a80661fe732)) where watdiv1052587_s2_14936a80661fe732.v8 = watdiv1052620_s2_14936a80661fe732.v8)), watdiv1052598_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052598_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052587_s2_14936a80661fe732)) where watdiv1052598_s2_14936a80661fe732.v8 = watdiv1052587_s2_14936a80661fe732.v8)), watdiv1052582_s3_14936a80661fe732 as (select * from umbra.identity(table(watdiv1052582_s2_14936a80661fe732)) where exists (select from umbra.identity(table(watdiv1052587_s2_14936a80661fe732)) where watdiv1052582_s2_14936a80661fe732.v8 = watdiv1052587_s2_14936a80661fe732.v8)) /* stage4 */, s4_group_1CEDD9345E0DC217 as  (select * from umbra.identity(table(watdiv1052588_s2_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052620_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052587_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052582_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052598_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052573_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052576_s3_14936a80661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052637_s3_14936a80661fe732)))select count(*) from umbra.identity(table(s4_group_1CEDD9345E0DC217));
\set queryname watdiv_acyclic_216_19
-- Result size: 19575
-- digraph G { node [shape=record]; edge [arrowhead=none]; watdiv1052640 [label="watdiv1052640|<s> s|<d> d"]; watdiv1052609 [label="watdiv1052609|<s> s|<d> d"]; watdiv1052608 [label="watdiv1052608|<s> s|<d> d"]; watdiv1052644 [label="watdiv1052644|<s> s|<d> d"]; watdiv1052651 [label="watdiv1052651|<s> s|<d> d"]; watdiv1052629 [label="watdiv1052629|<s> s|<d> d"]; watdiv1052652 [label="watdiv1052652|<s> s|<d> d"]; watdiv1052584 [label="watdiv1052584|<s> s|<d> d"]; watdiv1052640:d -> watdiv1052609:d;watdiv1052609:s -> watdiv1052608:s;watdiv1052608:d -> watdiv1052644:s;watdiv1052644:d -> watdiv1052651:d;watdiv1052651:s -> watdiv1052629:s;watdiv1052629:s -> watdiv1052652:s;watdiv1052652:s -> watdiv1052584:s;}
--                                   +---------------+----+----+
--                                   | watdiv1052584 |  s |  d |
--                                   +---------------+----+----+
--                                                      |
--                                                      +----+
--                                                           |
--                  +---------------+----------------+----+  |
--                  | watdiv1052651 |        s       |  d |  |
--                  +---------------+----------------+----+  |
--                                     |                |    |
--                                     |                +----+----+
--                                     |                     |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052629 |        s       |  d |  |    |
--                  +---------------+----------------+----+  |    |
--                                     |                     |    |
--                                     |                     |    |
--                                     |                     |    |
--                  +---------------+----------------+----+  |    |
--                  | watdiv1052652 |        s       |  d |  |    |
--                  +---------------+----------------+----+  |    |
--                                     |                     |    |
--                                     +---------------------+    |
--                                                                |
--                                                                |
--                                                      +---------+
--                                                      |
-- +---------------+----------------+----------------+  |
-- | watdiv1052608 |        s       |        d       |  |
-- +---------------+----------------+----------------+  |
--                    |                |                |
--   +----------------+                |                |
--   |                                 |                |
--   |              +---------------+----------------+----+
--   |              | watdiv1052644 |        s       |  d |
--   |              +---------------+----------------+----+
--   |
--   +----------------+
--                    |
-- +---------------+----------------+----------------+
-- | watdiv1052609 |        s       |        d       |
-- +---------------+----------------+----------------+
--                                     |
--                                     |
--                                     |
-- +---------------+----------------+----------------+
-- | watdiv1052640 |        s       |        d       |
-- +---------------+----------------+----------------+
with dummy as (select) /* stage1 */, watdiv1052644_s1_1d38f000661fe732 as (select watdiv1052644.s as v4,watdiv1052644.d as v6 from watdiv1052644), watdiv1052608_s1_1d38f000661fe732 as (select watdiv1052608.d as v4,watdiv1052608.s as v2 from watdiv1052608), watdiv1052609_s1_1d38f000661fe732 as (select watdiv1052609.d as v0,watdiv1052609.s as v2 from watdiv1052609), watdiv1052640_s2_1d38f000661fe732 as (select watdiv1052640.d as v0 from watdiv1052640), watdiv1052651_s1_1d38f000661fe732 as (select watdiv1052651.s as v8,watdiv1052651.d as v6 from watdiv1052651), watdiv1052629_s1_1d38f000661fe732 as (select watdiv1052629.s as v8 from watdiv1052629), watdiv1052652_s2_1d38f000661fe732 as (select watdiv1052652.s as v8 from watdiv1052652), watdiv1052584_s2_1d38f000661fe732 as (select watdiv1052584.s as v8 from watdiv1052584) /* stage2 */, watdiv1052629_s2_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052629_s1_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052584_s2_1d38f000661fe732)) where watdiv1052629_s1_1d38f000661fe732.v8 = watdiv1052584_s2_1d38f000661fe732.v8) AND exists (select from umbra.identity(table(watdiv1052652_s2_1d38f000661fe732)) where watdiv1052629_s1_1d38f000661fe732.v8 = watdiv1052652_s2_1d38f000661fe732.v8)), watdiv1052651_s2_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052651_s1_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052629_s2_1d38f000661fe732)) where watdiv1052651_s1_1d38f000661fe732.v8 = watdiv1052629_s2_1d38f000661fe732.v8)), watdiv1052609_s2_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052609_s1_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052640_s2_1d38f000661fe732)) where watdiv1052609_s1_1d38f000661fe732.v0 = watdiv1052640_s2_1d38f000661fe732.v0)), watdiv1052608_s2_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052608_s1_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052609_s2_1d38f000661fe732)) where watdiv1052608_s1_1d38f000661fe732.v2 = watdiv1052609_s2_1d38f000661fe732.v2)), watdiv1052644_s2_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052644_s1_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052651_s2_1d38f000661fe732)) where watdiv1052644_s1_1d38f000661fe732.v6 = watdiv1052651_s2_1d38f000661fe732.v6) AND exists (select from umbra.identity(table(watdiv1052608_s2_1d38f000661fe732)) where watdiv1052644_s1_1d38f000661fe732.v4 = watdiv1052608_s2_1d38f000661fe732.v4)) /* stage3 */, watdiv1052608_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052608_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052644_s2_1d38f000661fe732)) where watdiv1052608_s2_1d38f000661fe732.v4 = watdiv1052644_s2_1d38f000661fe732.v4)), watdiv1052609_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052609_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052608_s2_1d38f000661fe732)) where watdiv1052609_s2_1d38f000661fe732.v2 = watdiv1052608_s2_1d38f000661fe732.v2)), watdiv1052640_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052640_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052609_s2_1d38f000661fe732)) where watdiv1052640_s2_1d38f000661fe732.v0 = watdiv1052609_s2_1d38f000661fe732.v0)), watdiv1052651_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052651_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052644_s2_1d38f000661fe732)) where watdiv1052651_s2_1d38f000661fe732.v6 = watdiv1052644_s2_1d38f000661fe732.v6)), watdiv1052629_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052629_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052651_s2_1d38f000661fe732)) where watdiv1052629_s2_1d38f000661fe732.v8 = watdiv1052651_s2_1d38f000661fe732.v8)), watdiv1052652_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052652_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052629_s2_1d38f000661fe732)) where watdiv1052652_s2_1d38f000661fe732.v8 = watdiv1052629_s2_1d38f000661fe732.v8)), watdiv1052584_s3_1d38f000661fe732 as (select * from umbra.identity(table(watdiv1052584_s2_1d38f000661fe732)) where exists (select from umbra.identity(table(watdiv1052629_s2_1d38f000661fe732)) where watdiv1052584_s2_1d38f000661fe732.v8 = watdiv1052629_s2_1d38f000661fe732.v8)) /* stage4 */, s4_group_5327C1593C842CB0 as  (select * from umbra.identity(table(watdiv1052644_s2_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052651_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052629_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052584_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052652_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052608_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052609_s3_1d38f000661fe732)) NATURAL JOIN umbra.identity(table(watdiv1052640_s3_1d38f000661fe732)))select count(*) from umbra.identity(table(s4_group_5327C1593C842CB0));
